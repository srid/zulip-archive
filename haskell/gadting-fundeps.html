<html lang="en"><head><meta content="text/html; charset=utf-8" http-equiv="Content-Type"><meta content="width=device-width, initial-scale=1" name="viewport"><meta content="I would expect this to work, but it doesn&#39;t.
class Model a b | a -&gt; b where
  model :: a -&gt; b

data Temp b where
  Temp :: Model a b =&gt; b -&gt; Temp a

getTemp :: Model a b =&gt; Temp a -&gt; b
getTemp (Temp a) = a



/home/sandy/Vik.hs:11:20: error:
    • Couldn&#39;t match expected type ‘b’ with actual type ‘b" name="description"><link href="https://funprog.srid.ca/haskell/gadting-fundeps.html" rel="canonical"><meta property="og:title" content="GADTing Fundeps? - Haskell"><meta property="og:site_name" content="Functional Programming Zulip Archive"><meta property="og:type" content="article"><meta property="og:article:section" content="Haskell"><meta property="og:article:modified_time" content="2020-03-08T06:35:23Z"><meta property="og:article:published_time" content="2020-03-07T19:36:44Z"><meta property="og:image" content="https://secure.gravatar.com/avatar/3d24a4100b3eab34d8ce3059d789c543?d=identicon&amp;version=1"><title>GADTing Fundeps? - Haskell</title><style type="text/css">
div#thesite
{
  font-family   : "Open Sans", sans-serif;
  font-size     : 1em !important;
  margin-top    : 1em;
  margin-bottom : 1em;
}

div#thesite h1
{
  font-family : "Roboto", sans-serif;
  line-height : 1.19999em;
}

div#thesite h2
{
  font-family : "Roboto", sans-serif;
  line-height : 1.19999em;
}

div#thesite h3
{
  font-family : "Roboto", sans-serif;
  line-height : 1.19999em;
}

div#thesite h4
{
  font-family : "Roboto", sans-serif;
  line-height : 1.19999em;
}

div#thesite h5
{
  font-family : "Roboto", sans-serif;
  line-height : 1.19999em;
}

div#thesite h6
{
  font-family : "Roboto", sans-serif;
  line-height : 1.19999em;
}

div#thesite .ui.breadcrumb.rib .section
{
  font-family : "Roboto", sans-serif;
  line-height : 1.19999em;
}

div#thesite .header
{
  font-family : "Roboto", sans-serif;
  line-height : 1.19999em;
}

div#thesite .as-header
{
  font-family : "Roboto", sans-serif;
  line-height : 1.19999em;
}

div#thesite code, pre, tt
{
  font-family : "SFMono-Regular","Menlo","Monaco","Consolas","Liberation Mono","Courier New", monospace;
}

div#thesite .ui.breadcrumb.rib
{
  margin-bottom : 1em;
}



div#thesite .ui.comments.messages .comment .metadata a
{
  color : #808080;
}

div#thesite .ui.comments.messages .comment a.avatar img
{
  height : auto;
}

div#thesite .subtle
{
  color : #808080;
}


div#thesite .messages pre
{
  font-size : 85%;
  overflow  : auto;
  max-width : 100%;
}

div#thesite .messages .message_embed
{
  border-left  : solid 3px #808080;
  padding-left : 0.69999em;
}

div#thesite .messages .message_inline_image img
{
  max-width     : 100%;
  margin-bottom : 1em;
}


/* Generated with Clay, http://fvisser.nl/clay */</style><link href="https://cdnjs.cloudflare.com/ajax/libs/semantic-ui/2.4.1/semantic.min.css" rel="stylesheet"><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css" rel="stylesheet"><link href="https://fonts.googleapis.com/css?family=Open+Sans|Oswald&amp;display=swap" rel="stylesheet"><link href="https://fonts.googleapis.com/css?family=Roboto|Open+Sans&amp;display=swap" rel="stylesheet"></head><body><div id="thesite" class="ui text container"><div class="ui violet inverted top attached center aligned segment"><h1 class="ui huge header">GADTing Fundeps? - Haskell</h1></div><div class="ui attached segment"><div class="ui message"><p>Welcome to the Functional Programming Zulip Chat Archive. You can join the chat <a href="https://funprog.zulipchat.com">here</a>.</p></div><div class="ui breadcrumb rib"><a href="/" class="section">Home</a><i class="right angle icon divider"></i><a href="/haskell/" class="section">#Haskell</a><i class="right angle icon divider"></i><div class="active section">GADTing Fundeps?</div></div><div class="ui comments messages"><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/3d24a4100b3eab34d8ce3059d789c543?d=identicon&amp;version=1"></a><div class="content"><a class="author">Sandy Maguire</a><div class="metadata"><a href="#189983208" name="189983208"><div>2020-03-07 19:36:44</div></a></div><div class="text"><p>I would expect this to work, but it doesn't.</p>
<div class="codehilite"><pre><span></span><span class="kr">class</span> <span class="kt">Model</span> <span class="n">a</span> <span class="n">b</span> <span class="o">|</span> <span class="n">a</span> <span class="ow">-&gt;</span> <span class="n">b</span> <span class="kr">where</span>
  <span class="n">model</span> <span class="ow">::</span> <span class="n">a</span> <span class="ow">-&gt;</span> <span class="n">b</span>

<span class="kr">data</span> <span class="kt">Temp</span> <span class="n">b</span> <span class="kr">where</span>
  <span class="kt">Temp</span> <span class="ow">::</span> <span class="kt">Model</span> <span class="n">a</span> <span class="n">b</span> <span class="ow">=&gt;</span> <span class="n">b</span> <span class="ow">-&gt;</span> <span class="kt">Temp</span> <span class="n">a</span>

<span class="nf">getTemp</span> <span class="ow">::</span> <span class="kt">Model</span> <span class="n">a</span> <span class="n">b</span> <span class="ow">=&gt;</span> <span class="kt">Temp</span> <span class="n">a</span> <span class="ow">-&gt;</span> <span class="n">b</span>
<span class="nf">getTemp</span> <span class="p">(</span><span class="kt">Temp</span> <span class="n">a</span><span class="p">)</span> <span class="ow">=</span> <span class="n">a</span>
</pre></div>


<div class="codehilite"><pre><span></span>/home/sandy/Vik.hs:11:20: error:
    • Couldn&#39;t match expected type ‘b’ with actual type ‘b1’
      ‘b1’ is a rigid type variable bound by
        a pattern with constructor:
          Temp :: forall a b. Model a b =&gt; b -&gt; Temp a,
        in an equation for ‘getTemp’
        at /home/sandy/Vik.hs:11:10-15
      ‘b’ is a rigid type variable bound by
        the type signature for:
          getTemp :: forall a b. Model a b =&gt; Temp a -&gt; b
        at /home/sandy/Vik.hs:10:1-35
    • In the expression: a
      In an equation for ‘getTemp’: getTemp (Temp a) = a
    • Relevant bindings include
        a :: b1 (bound at /home/sandy/Vik.hs:11:15)
        getTemp :: Temp a -&gt; b (bound at /home/sandy/Vik.hs:11:1)
   |
11 | getTemp (Temp a) = a
   |
</pre></div></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/3d24a4100b3eab34d8ce3059d789c543?d=identicon&amp;version=1"></a><div class="content"><a class="author">Sandy Maguire</a><div class="metadata"><a href="#189983214" name="189983214"><div>2020-03-07 19:37:13</div></a></div><div class="text"><p>shouldn't the fundep here be enough to unify <code>b ~ b1</code>?</p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/3d24a4100b3eab34d8ce3059d789c543?d=identicon&amp;version=1"></a><div class="content"><a class="author">Sandy Maguire</a><div class="metadata"><a href="#189983219" name="189983219"><div>2020-03-07 19:37:40</div></a></div><div class="text"><p>given that <code>model</code> is library code i want to interface with, how can i do this?</p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/3d24a4100b3eab34d8ce3059d789c543?d=identicon&amp;version=1"></a><div class="content"><a class="author">Sandy Maguire</a><div class="metadata"><a href="#189983408" name="189983408"><div>2020-03-07 19:43:59</div></a></div><div class="text"><p>more generally the problem i'm trying to solve is that given some opaque datatype <code>A</code>  that i can define arbitrarily to my liking, and an instance <code>Model A B</code>, i want to write a bunch of code that uses <code>B</code> but refers to  <code>A</code> in the type signature</p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/3d24a4100b3eab34d8ce3059d789c543?d=identicon&amp;version=1"></a><div class="content"><a class="author">Sandy Maguire</a><div class="metadata"><a href="#189983445" name="189983445"><div>2020-03-07 19:44:08</div></a></div><div class="text"><p>but sandy! you must be mad!</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/4d7e5bf37281d41829f7b8a95d15292ff274c327?x=x&amp;version=2"></a><div class="content"><a class="author">Vladimir Ciobanu</a><div class="metadata"><a href="#189983451" name="189983451"><div>2020-03-07 19:44:36</div></a></div><div class="text"><p><code>getTemp (Temp a) = a</code> is pretty confusing, tripped me up for a minute. It's probably easier to read if you replaced the as with bs :D</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/4d7e5bf37281d41829f7b8a95d15292ff274c327?x=x&amp;version=2"></a><div class="content"><a class="author">Vladimir Ciobanu</a><div class="metadata"><a href="#189983455" name="189983455"><div>2020-03-07 19:44:56</div></a></div><div class="text"><p>But I would have also expected that to work</p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/3d24a4100b3eab34d8ce3059d789c543?d=identicon&amp;version=1"></a><div class="content"><a class="author">Sandy Maguire</a><div class="metadata"><a href="#189983461" name="189983461"><div>2020-03-07 19:45:13</div></a></div><div class="text"><p>i want to write code of the form:</p>
<div class="codehilite"><pre><span></span><span class="nf">f</span> <span class="ow">::</span> <span class="kt">A</span> <span class="ow">-&gt;</span> <span class="n">whatever</span>
<span class="nf">f</span> <span class="ow">=</span> <span class="n">something</span> <span class="n">with</span> <span class="p">(</span><span class="n">model</span> <span class="n">a</span><span class="p">)</span>
</pre></div>


<p>and then invoke it with something like <code>f (unmodel $ something of type B)</code></p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/3d24a4100b3eab34d8ce3059d789c543?d=identicon&amp;version=1"></a><div class="content"><a class="author">Sandy Maguire</a><div class="metadata"><a href="#189983519" name="189983519"><div>2020-03-07 19:47:18</div></a></div><div class="text"><p>such that the definition of <code>A</code> and <code>unmodel</code> are entirely mechanical and require no thought from me whatsoever as the user of this library</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/4d7e5bf37281d41829f7b8a95d15292ff274c327?x=x&amp;version=2"></a><div class="content"><a class="author">Vladimir Ciobanu</a><div class="metadata"><a href="#189983526" name="189983526"><div>2020-03-07 19:47:58</div></a></div><div class="text"><p><code>Model</code> is library code is what makes this particularly hard I think</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/4d7e5bf37281d41829f7b8a95d15292ff274c327?x=x&amp;version=2"></a><div class="content"><a class="author">Vladimir Ciobanu</a><div class="metadata"><a href="#189983578" name="189983578"><div>2020-03-07 19:48:42</div></a></div><div class="text"><p>Because trying out stuff like making it an associated type rather than fundep is out of the question (not even sure if it would fix the problem)</p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/3d24a4100b3eab34d8ce3059d789c543?d=identicon&amp;version=1"></a><div class="content"><a class="author">Sandy Maguire</a><div class="metadata"><a href="#189983643" name="189983643"><div>2020-03-07 19:50:36</div></a></div><div class="text"><p>yeah</p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/3d24a4100b3eab34d8ce3059d789c543?d=identicon&amp;version=1"></a><div class="content"><a class="author">Sandy Maguire</a><div class="metadata"><a href="#189983646" name="189983646"><div>2020-03-07 19:50:55</div></a></div><div class="text"><p>i think this is a bug in ghc</p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/3d24a4100b3eab34d8ce3059d789c543?d=identicon&amp;version=1"></a><div class="content"><a class="author">Sandy Maguire</a><div class="metadata"><a href="#189983722" name="189983722"><div>2020-03-07 19:52:36</div></a></div><div class="text"><p>i don't think it can be a tyfam because the injectivity goes the wrong way</p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/3d24a4100b3eab34d8ce3059d789c543?d=identicon&amp;version=1"></a><div class="content"><a class="author">Sandy Maguire</a><div class="metadata"><a href="#189983742" name="189983742"><div>2020-03-07 19:53:31</div></a></div><div class="text"><p>nevermind; the injectivity annotation isn't necessary in the tyfam</p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/3d24a4100b3eab34d8ce3059d789c543?d=identicon&amp;version=1"></a><div class="content"><a class="author">Sandy Maguire</a><div class="metadata"><a href="#189983745" name="189983745"><div>2020-03-07 19:53:33</div></a></div><div class="text"><p>that one would work</p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/3d24a4100b3eab34d8ce3059d789c543?d=identicon&amp;version=1"></a><div class="content"><a class="author">Sandy Maguire</a><div class="metadata"><a href="#189983750" name="189983750"><div>2020-03-07 19:54:01</div></a></div><div class="text"><p>(and does)</p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/3d24a4100b3eab34d8ce3059d789c543?d=identicon&amp;version=1"></a><div class="content"><a class="author">Sandy Maguire</a><div class="metadata"><a href="#189983799" name="189983799"><div>2020-03-07 19:55:35</div></a></div><div class="text"><p>datatype context doesn't work due to NOT WORKING ON GADTs</p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/3d24a4100b3eab34d8ce3059d789c543?d=identicon&amp;version=1"></a><div class="content"><a class="author">Sandy Maguire</a><div class="metadata"><a href="#189983976" name="189983976"><div>2020-03-07 20:00:16</div></a></div><div class="text"><p>oh i wonder if i can do a dumb trick</p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/3d24a4100b3eab34d8ce3059d789c543?d=identicon&amp;version=1"></a><div class="content"><a class="author">Sandy Maguire</a><div class="metadata"><a href="#189984093" name="189984093"><div>2020-03-07 20:04:30</div></a></div><div class="text"><p>this doesnt work :(</p>
<div class="codehilite"><pre><span></span><span class="kr">class</span> <span class="kt">Model</span> <span class="n">a</span> <span class="n">b</span> <span class="ow">=&gt;</span> <span class="kt">Model2</span> <span class="n">a</span> <span class="kr">where</span>
  <span class="kr">type</span> <span class="kt">TheModel</span> <span class="n">a</span>
<span class="kr">instance</span> <span class="kt">Model</span> <span class="n">a</span> <span class="n">b</span> <span class="ow">=&gt;</span> <span class="kt">Model2</span> <span class="n">a</span> <span class="kr">where</span>
  <span class="kr">type</span> <span class="kt">TheModel</span> <span class="n">a</span> <span class="ow">=</span> <span class="n">b</span>
</pre></div></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/c03b8d34978563858020eff0d14cc17b?d=identicon&amp;version=1"></a><div class="content"><a class="author">Alexis King</a><div class="metadata"><a href="#189984987" name="189984987"><div>2020-03-07 20:30:23</div></a></div><div class="text"><p><span class="user-mention" data-user-id="251120">@Sandy Maguire</span> That isn’t a bug in GHC, it’s the way fundeps are designed (for better or for worse). Fundeps don’t provide evidence the way type equalities against type families do, they just affect type inference.</p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/c03b8d34978563858020eff0d14cc17b?d=identicon&amp;version=1"></a><div class="content"><a class="author">Alexis King</a><div class="metadata"><a href="#189985091" name="189985091"><div>2020-03-07 20:32:50</div></a></div><div class="text"><p>What does that mean in practice? It means that if you have</p>
<div class="codehilite"><pre><span></span><span class="kr">class</span> <span class="kt">C</span> <span class="n">a</span> <span class="n">b</span> <span class="o">|</span> <span class="n">a</span> <span class="ow">-&gt;</span> <span class="n">b</span>
<span class="kr">instance</span> <span class="kt">C</span> <span class="kt">Int</span> <span class="kt">Bool</span>
</pre></div>


<p>and you end up with a <code>C Int a</code> given, you <strong>cannot</strong> deduce a <code>a ~ Bool</code> given! Instead, all the fundep does is cause a new <code>a ~ Bool</code> <em>wanted</em> to be emitted. If <code>a</code> is a solver variable, this makes nice things happen: <code>a</code> will be solved to <code>Bool</code>, and you get nice type inference. But if <code>a</code> is rigid, you get nothing: you just end up with an <code>a ~ Bool</code> wanted that you cannot solve.</p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/c03b8d34978563858020eff0d14cc17b?d=identicon&amp;version=1"></a><div class="content"><a class="author">Alexis King</a><div class="metadata"><a href="#189985153" name="189985153"><div>2020-03-07 20:34:03</div></a></div><div class="text"><p>You can see this for yourself by writing the following very simple program:</p>
<div class="codehilite"><pre><span></span><span class="kr">class</span> <span class="kt">C</span> <span class="n">a</span> <span class="n">b</span> <span class="o">|</span> <span class="n">a</span> <span class="ow">-&gt;</span> <span class="n">b</span>
<span class="kr">instance</span> <span class="kt">C</span> <span class="kt">Int</span> <span class="kt">Bool</span>

<span class="nf">foo</span> <span class="ow">::</span> <span class="kt">C</span> <span class="kt">Int</span> <span class="n">a</span> <span class="ow">=&gt;</span> <span class="n">a</span> <span class="kt">:~:</span> <span class="kt">Bool</span>
<span class="nf">foo</span> <span class="ow">=</span> <span class="kt">Refl</span>
</pre></div>


<p>This program will not compile.</p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/c03b8d34978563858020eff0d14cc17b?d=identicon&amp;version=1"></a><div class="content"><a class="author">Alexis King</a><div class="metadata"><a href="#189985238" name="189985238"><div>2020-03-07 20:36:26</div></a></div><div class="text"><p>You have to think of fundeps as “inference guides,” not sources of evidence. (The formal term for this “inference guiding” is “improvement,” introduced by Mark P. Jones in his work on qualified types.) Unless something fundamental changes in GHC’s treatment of functional dependencies, you will never be able to acquire type equality evidence from a functional dependency alone, since it simply doesn’t exist.</p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/c03b8d34978563858020eff0d14cc17b?d=identicon&amp;version=1"></a><div class="content"><a class="author">Alexis King</a><div class="metadata"><a href="#189985319" name="189985319"><div>2020-03-07 20:39:52</div></a></div><div class="text"><p>The type family equivalent works because you explicitly pass around evidence for a type equality. If you write</p>
<div class="codehilite"><pre><span></span><span class="kr">class</span> <span class="kt">C1</span> <span class="n">a</span> <span class="kr">where</span>
  <span class="kr">type</span> <span class="kt">B</span> <span class="n">a</span>
<span class="kr">instance</span> <span class="kt">C1</span> <span class="kt">Int</span> <span class="kr">where</span>
  <span class="kr">type</span> <span class="kt">B</span> <span class="kt">Int</span> <span class="ow">=</span> <span class="kt">Bool</span>

<span class="kr">class</span> <span class="n">b</span> <span class="o">~</span> <span class="kt">B</span> <span class="n">a</span> <span class="ow">=&gt;</span> <span class="kt">C2</span> <span class="n">a</span> <span class="n">b</span> <span class="o">|</span> <span class="n">a</span> <span class="ow">-&gt;</span> <span class="n">b</span>
<span class="kr">instance</span> <span class="p">(</span><span class="kt">C1</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">~</span> <span class="kt">B</span> <span class="n">a</span><span class="p">)</span> <span class="ow">=&gt;</span> <span class="kt">C2</span> <span class="n">a</span> <span class="n">b</span>
</pre></div>


<p>then when you write <code>foo</code>, it typechecks because you can get the <code>a ~ B Int</code> evidence out of the <code>C2</code> dictionary’s superclass dictionaries.</p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/c03b8d34978563858020eff0d14cc17b?d=identicon&amp;version=1"></a><div class="content"><a class="author">Alexis King</a><div class="metadata"><a href="#189985375" name="189985375"><div>2020-03-07 20:41:28</div></a></div><div class="text"><p>(It can be helpful to think of <code>a ~ b</code> constraints as implicitly-passed <code>a :~: b</code> values, since in GHC, that’s exactly what they are.)</p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/3d24a4100b3eab34d8ce3059d789c543?d=identicon&amp;version=1"></a><div class="content"><a class="author">Sandy Maguire</a><div class="metadata"><a href="#189994782" name="189994782"><div>2020-03-08 01:51:46</div></a></div><div class="text"><p>that's helpful, thanks <span class="user-mention" data-user-id="251362">@Alexis King</span> .</p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/3d24a4100b3eab34d8ce3059d789c543?d=identicon&amp;version=1"></a><div class="content"><a class="author">Sandy Maguire</a><div class="metadata"><a href="#189994822" name="189994822"><div>2020-03-08 01:52:21</div></a></div><div class="text"><p>apparently i've been away from Hs too long! I didn't even think about passing around <code>:~:</code>s</p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/3d24a4100b3eab34d8ce3059d789c543?d=identicon&amp;version=1"></a><div class="content"><a class="author">Sandy Maguire</a><div class="metadata"><a href="#189995530" name="189995530"><div>2020-03-08 02:20:57</div></a></div><div class="text"><p>maybe it's just because it's early and i'm still in bed, but i don't see how to make this work with explicit Refls either</p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/3d24a4100b3eab34d8ce3059d789c543?d=identicon&amp;version=1"></a><div class="content"><a class="author">Sandy Maguire</a><div class="metadata"><a href="#190002409" name="190002409"><div>2020-03-08 06:34:56</div></a></div><div class="text"><p>i came up with a boring solution :)</p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/3d24a4100b3eab34d8ce3059d789c543?d=identicon&amp;version=1"></a><div class="content"><a class="author">Sandy Maguire</a><div class="metadata"><a href="#190002414" name="190002414"><div>2020-03-08 06:35:23</div></a></div><div class="text"><div class="codehilite"><pre><span></span><span class="kr">newtype</span> <span class="kt">Opaque</span> <span class="n">a</span> <span class="ow">=</span> <span class="kt">Opaque</span> <span class="p">{</span> <span class="n">getOpaque</span> <span class="ow">::</span> <span class="n">a</span> <span class="p">}</span>
  <span class="kr">deriving</span> <span class="p">(</span><span class="kt">Eq</span><span class="p">,</span> <span class="kt">Ord</span><span class="p">,</span> <span class="kt">Show</span><span class="p">,</span> <span class="kt">Enum</span><span class="p">,</span> <span class="kt">Bounded</span><span class="p">,</span> <span class="kt">Read</span><span class="p">,</span> <span class="kt">Semigroup</span><span class="p">,</span> <span class="kt">Monoid</span><span class="p">)</span>

<span class="kr">instance</span> <span class="kt">Arbitrary</span> <span class="n">a</span> <span class="ow">=&gt;</span> <span class="kt">Arbitrary</span> <span class="p">(</span><span class="kt">Opaque</span> <span class="n">a</span><span class="p">)</span> <span class="kr">where</span>
  <span class="n">arbitrary</span> <span class="ow">=</span> <span class="n">fmap</span> <span class="kt">Opaque</span> <span class="n">arbitrary</span>

<span class="kr">instance</span> <span class="kt">Model</span> <span class="p">(</span><span class="kt">Opaque</span> <span class="n">a</span><span class="p">)</span> <span class="n">a</span> <span class="kr">where</span>
  <span class="n">model</span> <span class="ow">=</span> <span class="n">getOpaque</span>
</pre></div></div></div></div></div></div><div class="ui vertical footer segment"><a href="https://github.com/srid/zulip-archive">Powered by Haskell</a> | Questions? Contact <a href="https://www.srid.ca">srid</a></div></div></body></html>