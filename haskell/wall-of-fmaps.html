<html lang="en"><head><meta content="text/html; charset=utf-8" http-equiv="Content-Type"><meta content="width=device-width, initial-scale=1" name="viewport"><meta content="image.png
" name="description"><link href="https://funprog.srid.ca/haskell/wall-of-fmaps.html" rel="canonical"><meta property="og:title" content="Wall of fmaps - Haskell"><meta property="og:site_name" content="Functional Programming Zulip Archive"><meta property="og:type" content="article"><meta property="og:article:section" content="Haskell"><meta property="og:article:modified_time" content="2020-11-14T23:13:34Z"><meta property="og:article:published_time" content="2020-11-14T22:58:48Z"><meta property="og:image" content="https://zulip-avatars.s3.amazonaws.com/13896/4429aa8b689608f24a4ad712843ce29862e330d2?x=x&amp;version=2"><title>Wall of fmaps - Haskell</title><style type="text/css">
div#thesite
{
  font-family   : "Open Sans", sans-serif;
  font-size     : 1em !important;
  margin-top    : 1em;
  margin-bottom : 1em;
}

div#thesite h1
{
  font-family : "Roboto", sans-serif;
  line-height : 1.19999em;
}

div#thesite h2
{
  font-family : "Roboto", sans-serif;
  line-height : 1.19999em;
}

div#thesite h3
{
  font-family : "Roboto", sans-serif;
  line-height : 1.19999em;
}

div#thesite h4
{
  font-family : "Roboto", sans-serif;
  line-height : 1.19999em;
}

div#thesite h5
{
  font-family : "Roboto", sans-serif;
  line-height : 1.19999em;
}

div#thesite h6
{
  font-family : "Roboto", sans-serif;
  line-height : 1.19999em;
}

div#thesite .ui.breadcrumb.rib .section
{
  font-family : "Roboto", sans-serif;
  line-height : 1.19999em;
}

div#thesite .header
{
  font-family : "Roboto", sans-serif;
  line-height : 1.19999em;
}

div#thesite .as-header
{
  font-family : "Roboto", sans-serif;
  line-height : 1.19999em;
}

div#thesite code, pre, tt
{
  font-family : "SFMono-Regular","Menlo","Monaco","Consolas","Liberation Mono","Courier New", monospace;
}

div#thesite .ui.breadcrumb.rib
{
  margin-bottom : 1em;
}



div#thesite .ui.comments.messages .comment .metadata a
{
  color : #808080;
}

div#thesite .ui.comments.messages .comment a.avatar img
{
  height : auto;
}

div#thesite .subtle
{
  color : #808080;
}


div#thesite .messages pre
{
  font-size : 85%;
  overflow  : auto;
  max-width : 100%;
}

div#thesite .messages .message_embed
{
  border-left  : solid 3px #808080;
  padding-left : 0.69999em;
}

div#thesite .messages .message_inline_image img
{
  max-width     : 100%;
  margin-bottom : 1em;
}


/* Generated with Clay, http://fvisser.nl/clay */</style><link href="https://cdnjs.cloudflare.com/ajax/libs/semantic-ui/2.4.1/semantic.min.css" rel="stylesheet"><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css" rel="stylesheet"><link href="https://fonts.googleapis.com/css?family=Open+Sans|Oswald&amp;display=swap" rel="stylesheet"><link href="https://fonts.googleapis.com/css?family=Roboto|Open+Sans&amp;display=swap" rel="stylesheet"></head><body><div id="thesite" class="ui text container"><div class="ui violet inverted top attached center aligned segment"><h1 class="ui huge header">Wall of fmaps - Haskell</h1></div><div class="ui attached segment"><div class="ui message"><p>Welcome to the Functional Programming Zulip Chat Archive. You can join the chat <a href="https://funprog.zulipchat.com">here</a>.</p></div><div class="ui breadcrumb rib"><a href="/" class="section">Home</a><i class="right angle icon divider"></i><a href="/haskell/" class="section">#Haskell</a><i class="right angle icon divider"></i><div class="active section">Wall of fmaps</div></div><div class="ui comments messages"><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/4429aa8b689608f24a4ad712843ce29862e330d2?x=x&amp;version=2"></a><div class="content"><a class="author">Sridhar Ratnakumar</a><div class="metadata"><a href="#216755182" name="216755182"><div>2020-11-14 22:58:48</div></a></div><div class="text"><p><a href="/user_uploads/13896/VTvwdVIH2hnUYMVyac4tOLIh/image.png">image.png</a></p>
<div class="message_inline_image"><a href="/user_uploads/13896/VTvwdVIH2hnUYMVyac4tOLIh/image.png" title="image.png"><img src="/user_uploads/13896/VTvwdVIH2hnUYMVyac4tOLIh/image.png"></a></div></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/4429aa8b689608f24a4ad712843ce29862e330d2?x=x&amp;version=2"></a><div class="content"><a class="author">Sridhar Ratnakumar</a><div class="metadata"><a href="#216755188" name="216755188"><div>2020-11-14 22:58:59</div></a></div><div class="text"><p>hlint is not happy</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/7334dc60b6aef6a75cd9284126231f13c76926a5?x=x&amp;version=3"></a><div class="content"><a class="author">Torsten Schmits</a><div class="metadata"><a href="#216755194" name="216755194"><div>2020-11-14 22:59:47</div></a></div><div class="text"><p>with good reason!</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/4429aa8b689608f24a4ad712843ce29862e330d2?x=x&amp;version=2"></a><div class="content"><a class="author">Sridhar Ratnakumar</a><div class="metadata"><a href="#216755198" name="216755198"><div>2020-11-14 23:00:02</div></a></div><div class="text"><p>it just wants to replace the last fmap with &lt;$&gt;</p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/1114fd8de67671f83d3a3ef7594b1950?d=identicon&amp;version=1"></a><div class="content"><a class="author">Georgi Lyubenov // googleson78</a><div class="metadata"><a href="#216755311" name="216755311"><div>2020-11-14 23:02:55</div></a></div><div class="text"><p>why not</p>
<div class="codehilite" data-code-language="Haskell"><pre><span></span><code><span class="nf">fmap</span> <span class="n">fmap</span> <span class="n">fmap</span> <span class="n">fmap</span> <span class="n">fmap</span> <span class="n">fmap</span> <span class="n">fmap</span> <span class="n">fmap</span> <span class="n">fmap</span> <span class="n">fmap</span> <span class="n">fmap</span>
</code></pre></div>
<p>instead</p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/1114fd8de67671f83d3a3ef7594b1950?d=identicon&amp;version=1"></a><div class="content"><a class="author">Georgi Lyubenov // googleson78</a><div class="metadata"><a href="#216755338" name="216755338"><div>2020-11-14 23:03:35</div></a></div><div class="text"><p>what is the thing being nested so deeply, is this in an instance declaration?</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/4429aa8b689608f24a4ad712843ce29862e330d2?x=x&amp;version=2"></a><div class="content"><a class="author">Sridhar Ratnakumar</a><div class="metadata"><a href="#216755585" name="216755585"><div>2020-11-14 23:11:50</div></a></div><div class="text"><p>It is from <a href="http://ka.srid.ca">ka.srid.ca</a>, which is not open source yet. Attaching the code with context. Basically it calls all the plugins, and accumulates their results, uniformly. Since the plugin API is not finalized, and is stil in flux, I left the code un-refactored for now ... </p>
<div class="codehilite" data-code-language="Haskell"><pre><span></span><code>  <span class="n">renderE</span> <span class="ow">&lt;-</span>
    <span class="n">mergeWith</span> <span class="p">(</span><span class="n">flip</span> <span class="kt">Map</span><span class="o">.</span><span class="n">union</span><span class="p">)</span>
      <span class="o">&lt;$&gt;</span> <span class="n">sequence</span>
        <span class="c1">-- TODO: Eventually create a proper Plugin type to hold these functions.</span>
        <span class="p">[</span> <span class="p">(</span><span class="n">fmap</span> <span class="o">.</span> <span class="n">fmap</span> <span class="o">.</span> <span class="n">fmap</span> <span class="o">.</span> <span class="n">fmap</span> <span class="o">.</span> <span class="n">fmap</span> <span class="o">.</span> <span class="n">fmap</span><span class="p">)</span> <span class="p">(</span><span class="nf">\</span><span class="n">x</span> <span class="ow">-&gt;</span> <span class="kt">ThingVal_Pandoc</span> <span class="kt">:=&gt;</span> <span class="kt">Identity</span> <span class="n">x</span><span class="p">)</span> <span class="o">$</span> <span class="n">pure</span> <span class="n">pandocWithScopeE</span><span class="p">,</span>
          <span class="p">(</span><span class="n">fmap</span> <span class="o">.</span> <span class="n">fmap</span> <span class="o">.</span> <span class="n">fmap</span> <span class="o">.</span> <span class="n">fmap</span> <span class="o">.</span> <span class="n">fmap</span><span class="p">)</span> <span class="p">(</span><span class="nf">\</span><span class="n">x</span> <span class="ow">-&gt;</span> <span class="p">(</span><span class="n">currTime</span><span class="p">,</span> <span class="kt">ThingVal_Calendar</span> <span class="kt">:=&gt;</span> <span class="kt">Identity</span> <span class="n">x</span><span class="p">))</span> <span class="o">$</span> <span class="kt">Calendar</span><span class="o">.</span><span class="n">runPlugin</span> <span class="n">graphD</span> <span class="n">pandocD</span> <span class="n">pandocWithScopeE</span><span class="p">,</span>
          <span class="p">(</span><span class="n">fmap</span> <span class="o">.</span> <span class="n">fmap</span> <span class="o">.</span> <span class="n">fmap</span> <span class="o">.</span> <span class="n">fmap</span> <span class="o">.</span> <span class="n">fmap</span><span class="p">)</span> <span class="p">(</span><span class="nf">\</span><span class="n">x</span> <span class="ow">-&gt;</span> <span class="p">(</span><span class="n">currTime</span><span class="p">,</span> <span class="kt">ThingVal_Tasks</span> <span class="kt">:=&gt;</span> <span class="kt">Identity</span> <span class="n">x</span><span class="p">))</span> <span class="o">$</span> <span class="kt">Task</span><span class="o">.</span><span class="n">runPlugin</span> <span class="n">graphD</span> <span class="n">pandocD</span> <span class="n">pandocWithScopeE</span>
        <span class="p">]</span>
</code></pre></div>
<p><a href="/user_uploads/13896/o2vQbnoqSq8niF5SQ_H02cvF/image.png">image.png</a></p>
<div class="message_inline_image"><a href="/user_uploads/13896/o2vQbnoqSq8niF5SQ_H02cvF/image.png" title="image.png"><img src="/user_uploads/13896/o2vQbnoqSq8niF5SQ_H02cvF/image.png"></a></div></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/4429aa8b689608f24a4ad712843ce29862e330d2?x=x&amp;version=2"></a><div class="content"><a class="author">Sridhar Ratnakumar</a><div class="metadata"><a href="#216755633" name="216755633"><div>2020-11-14 23:12:47</div></a></div><div class="text"><p>The types are reflex events and dynamics, which look like:</p>
<div class="codehilite" data-code-language="Haskell"><pre><span></span><code><span class="nf">m</span> <span class="p">(</span><span class="kt">Dynamic</span> <span class="n">t</span> <span class="p">(</span><span class="kt">Map</span> <span class="kt">ThingName</span> <span class="p">(</span><span class="kt">ThingScope</span><span class="p">,</span> <span class="p">(</span><span class="kt">UTCTime</span><span class="p">,</span> <span class="kt">Pandoc</span><span class="p">))))</span>
</code></pre></div></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/4429aa8b689608f24a4ad712843ce29862e330d2?x=x&amp;version=2"></a><div class="content"><a class="author">Sridhar Ratnakumar</a><div class="metadata"><a href="#216755648" name="216755648"><div>2020-11-14 23:13:34</div></a></div><div class="text"><p>The calendar plugin (second line) for example is defined like:</p>
<div class="codehilite" data-code-language="Haskell"><pre><span></span><code><span class="nf">runPlugin</span> <span class="ow">::</span>
  <span class="n">forall</span> <span class="n">t</span> <span class="n">m</span><span class="o">.</span>
  <span class="p">(</span> <span class="kt">Reflex</span> <span class="n">t</span><span class="p">,</span>
    <span class="kt">MonadHold</span> <span class="n">t</span> <span class="n">m</span><span class="p">,</span>
    <span class="kt">MonadFix</span> <span class="n">m</span><span class="p">,</span>
    <span class="kt">DomBuilder</span> <span class="n">t</span> <span class="n">m</span>
  <span class="p">)</span> <span class="ow">=&gt;</span>
  <span class="kt">Dynamic</span> <span class="n">t</span> <span class="kt">Graph</span> <span class="ow">-&gt;</span>
  <span class="kt">Dynamic</span> <span class="n">t</span> <span class="p">(</span><span class="kt">Map</span> <span class="kt">ThingName</span> <span class="p">(</span><span class="kt">ThingScope</span><span class="p">,</span> <span class="p">(</span><span class="kt">UTCTime</span><span class="p">,</span> <span class="kt">Pandoc</span><span class="p">)))</span> <span class="ow">-&gt;</span>
  <span class="kt">Event</span> <span class="n">t</span> <span class="p">(</span><span class="kt">Map</span> <span class="kt">ThingName</span> <span class="p">(</span><span class="kt">Maybe</span> <span class="p">(</span><span class="kt">ThingScope</span><span class="p">,</span> <span class="p">(</span><span class="kt">UTCTime</span><span class="p">,</span> <span class="kt">Pandoc</span><span class="p">))))</span> <span class="ow">-&gt;</span>
  <span class="n">m</span> <span class="p">(</span><span class="kt">Event</span> <span class="n">t</span> <span class="p">(</span><span class="kt">Map</span> <span class="kt">ThingName</span> <span class="p">(</span><span class="kt">Maybe</span> <span class="p">(</span><span class="kt">ThingScope</span><span class="p">,</span> <span class="kt">Set</span> <span class="kt">Day</span><span class="p">))))</span>
</code></pre></div></div></div></div></div></div><div class="ui vertical footer segment"><a href="https://github.com/srid/zulip-archive">Powered by Haskell</a></div></div></body></html>