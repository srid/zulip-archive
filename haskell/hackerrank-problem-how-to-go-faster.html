<html lang="en"><head><meta content="text/html; charset=utf-8" http-equiv="Content-Type"><meta content="width=device-width, initial-scale=1" name="viewport"><meta content="So I&#39;m working on the following hackerrank problem:
https://www.hackerrank.com/challenges/super-digit/problem
I have the following solution:
import Text.Read (readMaybe)
import Data.Semigroup (stimes)

digits :: Integer -&gt; [Integer]
digits n = reverse $ revDigits n
  where
    revDigits n
      | n " name="description"><link href="https://funprog.srid.ca/haskell/hackerrank-problem-how-to-go-faster.html" rel="canonical"><meta property="og:title" content="Hackerrank problem - how to go faster? - Haskell"><meta property="og:site_name" content="Functional Programming Zulip Archive"><meta property="og:type" content="article"><meta property="og:article:section" content="Haskell"><meta property="og:article:modified_time" content="2020-09-25T14:24:15Z"><meta property="og:article:published_time" content="2020-09-25T11:50:11Z"><meta property="og:image" content="https://secure.gravatar.com/avatar/b450c754c95e372799d56cb7eef2eba2?d=identicon&amp;version=1"><title>Hackerrank problem - how to go faster? - Haskell</title><style type="text/css">
div#thesite
{
  font-family   : "Open Sans", sans-serif;
  font-size     : 1em !important;
  margin-top    : 1em;
  margin-bottom : 1em;
}

div#thesite h1
{
  font-family : "Roboto", sans-serif;
  line-height : 1.19999em;
}

div#thesite h2
{
  font-family : "Roboto", sans-serif;
  line-height : 1.19999em;
}

div#thesite h3
{
  font-family : "Roboto", sans-serif;
  line-height : 1.19999em;
}

div#thesite h4
{
  font-family : "Roboto", sans-serif;
  line-height : 1.19999em;
}

div#thesite h5
{
  font-family : "Roboto", sans-serif;
  line-height : 1.19999em;
}

div#thesite h6
{
  font-family : "Roboto", sans-serif;
  line-height : 1.19999em;
}

div#thesite .ui.breadcrumb.rib .section
{
  font-family : "Roboto", sans-serif;
  line-height : 1.19999em;
}

div#thesite .header
{
  font-family : "Roboto", sans-serif;
  line-height : 1.19999em;
}

div#thesite .as-header
{
  font-family : "Roboto", sans-serif;
  line-height : 1.19999em;
}

div#thesite code, pre, tt
{
  font-family : "SFMono-Regular","Menlo","Monaco","Consolas","Liberation Mono","Courier New", monospace;
}

div#thesite .ui.breadcrumb.rib
{
  margin-bottom : 1em;
}



div#thesite .ui.comments.messages .comment .metadata a
{
  color : #808080;
}

div#thesite .ui.comments.messages .comment a.avatar img
{
  height : auto;
}

div#thesite .subtle
{
  color : #808080;
}


div#thesite .messages pre
{
  font-size : 85%;
  overflow  : auto;
  max-width : 100%;
}

div#thesite .messages .message_embed
{
  border-left  : solid 3px #808080;
  padding-left : 0.69999em;
}

div#thesite .messages .message_inline_image img
{
  max-width     : 100%;
  margin-bottom : 1em;
}


/* Generated with Clay, http://fvisser.nl/clay */</style><link href="https://cdnjs.cloudflare.com/ajax/libs/semantic-ui/2.4.1/semantic.min.css" rel="stylesheet"><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css" rel="stylesheet"><link href="https://fonts.googleapis.com/css?family=Open+Sans|Oswald&amp;display=swap" rel="stylesheet"><link href="https://fonts.googleapis.com/css?family=Roboto|Open+Sans&amp;display=swap" rel="stylesheet"></head><body><div id="thesite" class="ui text container"><div class="ui violet inverted top attached center aligned segment"><h1 class="ui huge header">Hackerrank problem - how to go faster? - Haskell</h1></div><div class="ui attached segment"><div class="ui message"><p>Welcome to the Functional Programming Zulip Chat Archive. You can join the chat <a href="https://funprog.zulipchat.com">here</a>.</p></div><div class="ui breadcrumb rib"><a href="/" class="section">Home</a><i class="right angle icon divider"></i><a href="/haskell/" class="section">#Haskell</a><i class="right angle icon divider"></i><div class="active section">Hackerrank problem - how to go faster?</div></div><div class="ui comments messages"><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/b450c754c95e372799d56cb7eef2eba2?d=identicon&amp;version=1"></a><div class="content"><a class="author">James Sully</a><div class="metadata"><a href="#211247517" name="211247517"><div>2020-09-25 11:50:11</div></a></div><div class="text"><p>So I'm working on the following hackerrank problem:<br>
<a href="https://www.hackerrank.com/challenges/super-digit/problem">https://www.hackerrank.com/challenges/super-digit/problem</a></p>
<p>I have the following solution:</p>
<div class="codehilite" data-code-language="Haskell"><pre><span></span><code><span class="kr">import</span> <span class="nn">Text.Read</span> <span class="p">(</span><span class="nf">readMaybe</span><span class="p">)</span>
<span class="kr">import</span> <span class="nn">Data.Semigroup</span> <span class="p">(</span><span class="nf">stimes</span><span class="p">)</span>

<span class="nf">digits</span> <span class="ow">::</span> <span class="kt">Integer</span> <span class="ow">-&gt;</span> <span class="p">[</span><span class="kt">Integer</span><span class="p">]</span>
<span class="nf">digits</span> <span class="n">n</span> <span class="ow">=</span> <span class="n">reverse</span> <span class="o">$</span> <span class="n">revDigits</span> <span class="n">n</span>
  <span class="kr">where</span>
    <span class="n">revDigits</span> <span class="n">n</span>
      <span class="o">|</span> <span class="n">n</span> <span class="o">&lt;</span> <span class="mi">10</span> <span class="ow">=</span> <span class="p">[</span><span class="n">n</span><span class="p">]</span>
      <span class="o">|</span> <span class="n">otherwise</span> <span class="ow">=</span> <span class="p">(</span><span class="n">n</span> <span class="p">`</span><span class="n">mod</span><span class="p">`</span> <span class="mi">10</span><span class="p">)</span> <span class="kt">:</span> <span class="n">revDigits</span> <span class="p">(</span><span class="n">n</span> <span class="p">`</span><span class="n">div</span><span class="p">`</span> <span class="mi">10</span><span class="p">)</span>

<span class="nf">fromDigits</span> <span class="ow">::</span> <span class="p">[</span><span class="kt">Integer</span><span class="p">]</span> <span class="ow">-&gt;</span> <span class="kt">Integer</span>
<span class="nf">fromDigits</span> <span class="ow">=</span> <span class="n">foldl1</span> <span class="p">(</span><span class="nf">\</span><span class="n">x</span> <span class="n">y</span> <span class="ow">-&gt;</span> <span class="mi">10</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="n">y</span><span class="p">)</span>

<span class="nf">digitSum</span> <span class="ow">=</span> <span class="n">sum</span> <span class="o">.</span> <span class="n">digits</span>

<span class="nf">makeP</span> <span class="ow">::</span> <span class="kt">Integer</span> <span class="ow">-&gt;</span> <span class="kt">Integer</span> <span class="ow">-&gt;</span> <span class="kt">Integer</span>
<span class="nf">makeP</span> <span class="n">n</span> <span class="n">k</span> <span class="ow">=</span> <span class="n">read</span> <span class="o">$</span> <span class="n">stimes</span> <span class="n">k</span> <span class="p">(</span><span class="n">show</span> <span class="n">n</span><span class="p">)</span>

<span class="nf">readInts</span> <span class="ow">::</span> <span class="kt">String</span> <span class="ow">-&gt;</span> <span class="kt">Maybe</span> <span class="p">[</span><span class="kt">Integer</span><span class="p">]</span>
<span class="nf">readInts</span> <span class="ow">=</span> <span class="n">traverse</span> <span class="n">readMaybe</span> <span class="o">.</span> <span class="n">words</span>

<span class="nf">superDigit</span> <span class="ow">::</span> <span class="kt">Integer</span> <span class="ow">-&gt;</span> <span class="kt">Integer</span>
<span class="nf">superDigit</span> <span class="n">n</span>
  <span class="o">|</span> <span class="n">n</span> <span class="o">&lt;</span> <span class="mi">10</span> <span class="ow">=</span> <span class="n">n</span>
  <span class="o">|</span> <span class="n">otherwise</span> <span class="ow">=</span> <span class="n">superDigit</span> <span class="o">$</span> <span class="n">digitSum</span> <span class="n">n</span>

<span class="nf">doIt</span> <span class="ow">::</span> <span class="kt">String</span> <span class="ow">-&gt;</span> <span class="kt">String</span>
<span class="nf">doIt</span> <span class="n">input</span> <span class="ow">=</span> <span class="kr">case</span> <span class="n">readInts</span> <span class="n">input</span> <span class="kr">of</span>
  <span class="kt">Just</span> <span class="p">[</span><span class="n">n</span><span class="p">,</span> <span class="n">k</span><span class="p">]</span> <span class="ow">-&gt;</span> <span class="n">show</span> <span class="o">.</span> <span class="n">superDigit</span> <span class="o">$</span> <span class="n">makeP</span> <span class="n">n</span> <span class="n">k</span>
  <span class="kr">_</span>           <span class="ow">-&gt;</span> <span class="s">"invalid input"</span>


<span class="nf">interactLn</span> <span class="ow">::</span> <span class="p">(</span><span class="kt">String</span> <span class="ow">-&gt;</span> <span class="kt">String</span><span class="p">)</span> <span class="ow">-&gt;</span> <span class="kt">IO</span> <span class="nb">()</span>
<span class="nf">interactLn</span> <span class="n">f</span> <span class="ow">=</span> <span class="n">putStrLn</span> <span class="o">.</span> <span class="n">f</span> <span class="o">=&lt;&lt;</span> <span class="n">getLine</span>

<span class="nf">main</span> <span class="ow">=</span> <span class="n">interactLn</span> <span class="n">doIt</span>
</code></pre></div>

<p>I'm failing some of the tests, but it's with a runtime error. When I tried it with the input from the test on my laptop, it got the correct answer after a few seconds. I think what's happening is that my code is being killed because it's too slow. I profiled with the following:</p>
<p><code>echo '4757362 10000' | ./superdigit +RTS -p</code></p>
<p>And got the following profile:</p>
<div class="codehilite"><pre><span></span><code>        Fri Sep 25 21:40 2020 Time and Allocation Profiling Report  (Final)

           superdigit +RTS -p -RTS

        total time  =        1.46 secs   (1456 ticks @ 1000 us, 1 processor)
        total alloc = 1,084,500,184 bytes  (excludes profiling overheads)

COST CENTRE      MODULE SRC                         %time %alloc

digits.revDigits Main   superDigit.hs:(7,5)-(9,57)   98.2   96.4
makeP            Main   superDigit.hs:17:1-36         0.9    3.1


                                                                                               individual      inherited
COST CENTRE              MODULE                SRC                          no.     entries  %time %alloc   %time %alloc

MAIN                     MAIN                  &lt;built-in&gt;                    53          0    0.0    0.0   100.0  100.0
 CAF                     Main                  &lt;entire-module&gt;              105          0    0.0    0.0    99.9  100.0
  digitSum               Main                  superDigit.hs:14:1-23        113          1    0.0    0.0     0.0    0.0
  main                   Main                  superDigit.hs:36:1-22        106          1    0.0    0.0    99.9  100.0
   interactLn            Main                  superDigit.hs:34:1-39        107          1    0.1    0.0    99.9  100.0
    doIt                 Main                  superDigit.hs:(28,1)-(30,32) 108          1    0.0    0.0    99.9  100.0
     superDigit          Main                  superDigit.hs:(23,1)-(25,39) 111          3    0.0    0.0    99.0   96.9
      digitSum           Main                  superDigit.hs:14:1-23        114          0    0.8    0.4    99.0   96.9
       digits            Main                  superDigit.hs:(5,1)-(9,57)   115          2    0.0    0.2    98.2   96.5
        digits.revDigits Main                  superDigit.hs:(7,5)-(9,57)   116      70006   98.2   96.4    98.2   96.4
     makeP               Main                  superDigit.hs:17:1-36        112          1    0.9    3.1     0.9    3.1
     readInts            Main                  superDigit.hs:20:1-37        110          0    0.0    0.0     0.0    0.0
  readInts               Main                  superDigit.hs:20:1-37        109          1    0.0    0.0     0.0    0.0
 CAF                     GHC.IO.Handle.FD      &lt;entire-module&gt;              101          0    0.0    0.0     0.0    0.0
 CAF                     GHC.IO.Handle.Text    &lt;entire-module&gt;               99          0    0.1    0.0     0.1    0.0
 CAF                     GHC.IO.Encoding       &lt;entire-module&gt;               91          0    0.0    0.0     0.0    0.0
 CAF                     Text.Read.Lex         &lt;entire-module&gt;               84          0    0.0    0.0     0.0    0.0
 CAF                     GHC.Conc.Signal       &lt;entire-module&gt;               82          0    0.0    0.0     0.0    0.0
 CAF                     GHC.IO.Encoding.Iconv &lt;entire-module&gt;               68          0    0.0    0.0     0.0    0.0
</code></pre></div>


<p>So it seems like the problem is my digits functions is too slow. Any suggestions on speeding it up? Do I need to resort to arrays? I don't even think hackerrank will let me use packages other than base?</p>
<div class="message_embed"><a class="message_embed_image" href="https://www.hackerrank.com/challenges/super-digit/problem" style="background-image: url(https://hrcdn.net/og/default.jpg)"></a><div class="data-container"><div class="message_embed_title"><a href="https://www.hackerrank.com/challenges/super-digit/problem" title="Super Digit | HackerRank">Super Digit | HackerRank</a></div><div class="message_embed_description">Super Digit</div></div></div></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/20a04d823b7c3891d78ca5f6a188ccd0e4fc5e3d?x=x&amp;version=2"></a><div class="content"><a class="author">TheMatten</a><div class="metadata"><a href="#211247968" name="211247968"><div>2020-09-25 11:55:50</div></a></div><div class="text"><p>You can try <code>DList</code> instead of plain list to avoid reversing</p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/b450c754c95e372799d56cb7eef2eba2?d=identicon&amp;version=1"></a><div class="content"><a class="author">James Sully</a><div class="metadata"><a href="#211248111" name="211248111"><div>2020-09-25 11:57:56</div></a></div><div class="text"><p>Wouldn't <code>reverse</code> show up in the profile if that was the problem though? (I'm actually a bit confused about why is doesn't) but it seems like it's spending all the time in the subfunction revDigits, which doesn't do the actual reversing</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/20a04d823b7c3891d78ca5f6a188ccd0e4fc5e3d?x=x&amp;version=2"></a><div class="content"><a class="author">TheMatten</a><div class="metadata"><a href="#211248412" name="211248412"><div>2020-09-25 12:01:02</div></a></div><div class="text"><p>Hmm, yeah - I guess it then may be interesting to look at Core to see whether that arithmetics gets unboxed</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/7334dc60b6aef6a75cd9284126231f13c76926a5?x=x&amp;version=4"></a><div class="content"><a class="author">Torsten Schmits</a><div class="metadata"><a href="#211248567" name="211248567"><div>2020-09-25 12:02:51</div></a></div><div class="text"><p>you're using <code>foldl1</code> on a list, which is unsafe.<br>
and I don't understand your solution given the problem. why are you operating on integers instead of strings?</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/7334dc60b6aef6a75cd9284126231f13c76926a5?x=x&amp;version=4"></a><div class="content"><a class="author">Torsten Schmits</a><div class="metadata"><a href="#211248828" name="211248828"><div>2020-09-25 12:05:19</div></a></div><div class="text"><p>something along the schematic lines of <code>recurse . show . foldMap digitToInt</code> should be a complete solution</p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/b450c754c95e372799d56cb7eef2eba2?d=identicon&amp;version=1"></a><div class="content"><a class="author">James Sully</a><div class="metadata"><a href="#211248880" name="211248880"><div>2020-09-25 12:05:52</div></a></div><div class="text"><p>Oh fromDigits is vestigial I think</p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/b450c754c95e372799d56cb7eef2eba2?d=identicon&amp;version=1"></a><div class="content"><a class="author">James Sully</a><div class="metadata"><a href="#211248891" name="211248891"><div>2020-09-25 12:05:59</div></a></div><div class="text"><p>I'm not using it</p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/b450c754c95e372799d56cb7eef2eba2?d=identicon&amp;version=1"></a><div class="content"><a class="author">James Sully</a><div class="metadata"><a href="#211249043" name="211249043"><div>2020-09-25 12:07:20</div></a></div><div class="text"><p>What's <code>recurse</code>?</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/7334dc60b6aef6a75cd9284126231f13c76926a5?x=x&amp;version=4"></a><div class="content"><a class="author">Torsten Schmits</a><div class="metadata"><a href="#211249087" name="211249087"><div>2020-09-25 12:07:52</div></a></div><div class="text"><p>a placeholder for the name of the function that first checks whether the string length is 1 and contains the expression</p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/b450c754c95e372799d56cb7eef2eba2?d=identicon&amp;version=1"></a><div class="content"><a class="author">James Sully</a><div class="metadata"><a href="#211249207" name="211249207"><div>2020-09-25 12:09:00</div></a></div><div class="text"><p>foldMap (Sum . digitToInt) ?</p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/b450c754c95e372799d56cb7eef2eba2?d=identicon&amp;version=1"></a><div class="content"><a class="author">James Sully</a><div class="metadata"><a href="#211249219" name="211249219"><div>2020-09-25 12:09:11</div></a></div><div class="text"><p>oh wait</p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/b450c754c95e372799d56cb7eef2eba2?d=identicon&amp;version=1"></a><div class="content"><a class="author">James Sully</a><div class="metadata"><a href="#211249223" name="211249223"><div>2020-09-25 12:09:14</div></a></div><div class="text"><p>I'm getting confused</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/7334dc60b6aef6a75cd9284126231f13c76926a5?x=x&amp;version=4"></a><div class="content"><a class="author">Torsten Schmits</a><div class="metadata"><a href="#211249227" name="211249227"><div>2020-09-25 12:09:18</div></a></div><div class="text"><div class="codehilite" data-code-language="Haskell"><pre><span></span><code><span class="nf">run</span> <span class="p">[</span><span class="n">a</span><span class="p">]</span> <span class="ow">=</span> <span class="n">digitToInt</span> <span class="n">a</span>
<span class="nf">run</span> <span class="n">as</span> <span class="ow">=</span> <span class="n">run</span> <span class="p">(</span><span class="n">show</span> <span class="p">(</span><span class="n">foldMap</span> <span class="n">digitToInt</span> <span class="n">as</span><span class="p">))</span>
</code></pre></div></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/7334dc60b6aef6a75cd9284126231f13c76926a5?x=x&amp;version=4"></a><div class="content"><a class="author">Torsten Schmits</a><div class="metadata"><a href="#211249234" name="211249234"><div>2020-09-25 12:09:23</div></a></div><div class="text"><p>right, Sum</p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/b450c754c95e372799d56cb7eef2eba2?d=identicon&amp;version=1"></a><div class="content"><a class="author">James Sully</a><div class="metadata"><a href="#211249407" name="211249407"><div>2020-09-25 12:11:11</div></a></div><div class="text"><p>Oh, so you're saying I don't need to do all the converting</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/7334dc60b6aef6a75cd9284126231f13c76926a5?x=x&amp;version=4"></a><div class="content"><a class="author">Torsten Schmits</a><div class="metadata"><a href="#211249417" name="211249417"><div>2020-09-25 12:11:20</div></a></div><div class="text"><p>exactly!</p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/b450c754c95e372799d56cb7eef2eba2?d=identicon&amp;version=1"></a><div class="content"><a class="author">James Sully</a><div class="metadata"><a href="#211249455" name="211249455"><div>2020-09-25 12:11:54</div></a></div><div class="text"><p>That makes sense. Thanks! I'll try that</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/7334dc60b6aef6a75cd9284126231f13c76926a5?x=x&amp;version=4"></a><div class="content"><a class="author">Torsten Schmits</a><div class="metadata"><a href="#211249509" name="211249509"><div>2020-09-25 12:12:05</div></a></div><div class="text"><p>(also unsafe btw) <span aria-label="embarrassed" class="emoji emoji-1f633" role="img" title="embarrassed">:embarrassed:</span></p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/b450c754c95e372799d56cb7eef2eba2?d=identicon&amp;version=1"></a><div class="content"><a class="author">James Sully</a><div class="metadata"><a href="#211249528" name="211249528"><div>2020-09-25 12:12:19</div></a></div><div class="text"><p>digitToInt is partial?</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/7334dc60b6aef6a75cd9284126231f13c76926a5?x=x&amp;version=4"></a><div class="content"><a class="author">Torsten Schmits</a><div class="metadata"><a href="#211249542" name="211249542"><div>2020-09-25 12:12:30</div></a></div><div class="text"><p>yeah</p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/b450c754c95e372799d56cb7eef2eba2?d=identicon&amp;version=1"></a><div class="content"><a class="author">James Sully</a><div class="metadata"><a href="#211249563" name="211249563"><div>2020-09-25 12:12:45</div></a></div><div class="text"><p>ah well</p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/b450c754c95e372799d56cb7eef2eba2?d=identicon&amp;version=1"></a><div class="content"><a class="author">James Sully</a><div class="metadata"><a href="#211250348" name="211250348"><div>2020-09-25 12:21:18</div></a></div><div class="text"><p>Yeah, I passed a couple more cases. Thanks very much for your help! Now gotta debug the next issue haha</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/7334dc60b6aef6a75cd9284126231f13c76926a5?x=x&amp;version=4"></a><div class="content"><a class="author">Torsten Schmits</a><div class="metadata"><a href="#211250373" name="211250373"><div>2020-09-25 12:21:35</div></a></div><div class="text"><p>keep 'em coming!</p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/b450c754c95e372799d56cb7eef2eba2?d=identicon&amp;version=1"></a><div class="content"><a class="author">James Sully</a><div class="metadata"><a href="#211250397" name="211250397"><div>2020-09-25 12:21:55</div></a></div><div class="text"><p>New version, before I look into the next case</p>
<div class="codehilite" data-code-language="Haskell"><pre><span></span><code><span class="kr">import</span> <span class="nn">Text.Read</span> <span class="p">(</span><span class="nf">readMaybe</span><span class="p">)</span>
<span class="kr">import</span> <span class="nn">Data.Monoid</span> <span class="p">(</span><span class="kt">Sum</span><span class="p">(</span><span class="o">..</span><span class="p">),</span> <span class="nf">getSum</span><span class="p">)</span>
<span class="kr">import</span> <span class="nn">Data.Semigroup</span> <span class="p">(</span><span class="nf">stimes</span><span class="p">)</span>
<span class="kr">import</span> <span class="nn">Data.Char</span> <span class="p">(</span><span class="nf">digitToInt</span><span class="p">)</span>

<span class="nf">makeP</span> <span class="ow">::</span> <span class="kt">Integer</span> <span class="ow">-&gt;</span> <span class="kt">Integer</span> <span class="ow">-&gt;</span> <span class="kt">String</span>
<span class="nf">makeP</span> <span class="n">n</span> <span class="n">k</span> <span class="ow">=</span> <span class="n">stimes</span> <span class="n">k</span> <span class="p">(</span><span class="n">show</span> <span class="n">n</span><span class="p">)</span>

<span class="nf">superDigit</span> <span class="ow">::</span> <span class="kt">String</span> <span class="ow">-&gt;</span> <span class="kt">Int</span>
<span class="nf">superDigit</span> <span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="ow">=</span> <span class="n">digitToInt</span> <span class="n">c</span>
<span class="nf">superDigit</span> <span class="n">n</span>   <span class="ow">=</span> <span class="n">superDigit</span> <span class="o">.</span> <span class="n">show</span> <span class="o">.</span> <span class="n">getSum</span> <span class="o">.</span> <span class="n">foldMap</span> <span class="p">(</span><span class="kt">Sum</span> <span class="o">.</span> <span class="n">digitToInt</span><span class="p">)</span> <span class="o">$</span> <span class="n">n</span>

<span class="nf">readInts</span> <span class="ow">::</span> <span class="kt">String</span> <span class="ow">-&gt;</span> <span class="kt">Maybe</span> <span class="p">[</span><span class="kt">Integer</span><span class="p">]</span>
<span class="nf">readInts</span> <span class="ow">=</span> <span class="n">traverse</span> <span class="n">readMaybe</span> <span class="o">.</span> <span class="n">words</span>

<span class="nf">doIt</span> <span class="ow">::</span> <span class="kt">String</span> <span class="ow">-&gt;</span> <span class="kt">String</span>
<span class="nf">doIt</span> <span class="n">input</span> <span class="ow">=</span> <span class="kr">case</span> <span class="n">readInts</span> <span class="n">input</span> <span class="kr">of</span>
  <span class="kt">Just</span> <span class="p">[</span><span class="n">n</span><span class="p">,</span> <span class="n">k</span><span class="p">]</span> <span class="ow">-&gt;</span> <span class="n">show</span> <span class="o">.</span> <span class="n">superDigit</span> <span class="o">$</span> <span class="n">makeP</span> <span class="n">n</span> <span class="n">k</span>
  <span class="kr">_</span>           <span class="ow">-&gt;</span> <span class="s">"invalid input"</span>

<span class="nf">interactLn</span> <span class="ow">::</span> <span class="p">(</span><span class="kt">String</span> <span class="ow">-&gt;</span> <span class="kt">String</span><span class="p">)</span> <span class="ow">-&gt;</span> <span class="kt">IO</span> <span class="nb">()</span>
<span class="nf">interactLn</span> <span class="n">f</span> <span class="ow">=</span> <span class="n">putStrLn</span> <span class="o">.</span> <span class="n">f</span> <span class="o">=&lt;&lt;</span> <span class="n">getLine</span>

<span class="nf">main</span> <span class="ow">=</span> <span class="n">interactLn</span> <span class="n">doIt</span>
</code></pre></div></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/b450c754c95e372799d56cb7eef2eba2?d=identicon&amp;version=1"></a><div class="content"><a class="author">James Sully</a><div class="metadata"><a href="#211250734" name="211250734"><div>2020-09-25 12:25:29</div></a></div><div class="text"><p>The issue is still speed, the next input is</p>
<div class="codehilite"><pre><span></span><code>7404954009694227446246375747227852213692570890717884174001587537145838723390362624487926131161112710589127423098959327020544003395792482625191721603328307774998124389641069884634086849138515079220750462317357487762780480576640689175346956135668451835480490089962406773267569650663927778867764315211280625033388271518264961090111547480467065229843613873499846390257375933040086863430523668050046930387013897062106309406874425001127890574986610018093859693455518413268914361859000614904461902442822577552997680098389183082654625098817411306985010658756762152160904278169491634807464356130877526392725432086439934006728914411061861235300979536190100734360684054557448454640750198466877185875290011114667186730452681943043971812380628117527172389889545776779555664826488520325234792648448625225364535053605515386730925070072896004645416713682004600636574389040662827182696337187610904694029221880801372864040345567230941110986028568372710970460116491983700312243090679537497139499778923997433720159174153 100000
</code></pre></div></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/b450c754c95e372799d56cb7eef2eba2?d=identicon&amp;version=1"></a><div class="content"><a class="author">James Sully</a><div class="metadata"><a href="#211250754" name="211250754"><div>2020-09-25 12:25:43</div></a></div><div class="text"><p>I actually got a segfault when I tried to profile that</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/20a04d823b7c3891d78ca5f6a188ccd0e4fc5e3d?x=x&amp;version=2"></a><div class="content"><a class="author">TheMatten</a><div class="metadata"><a href="#211250811" name="211250811"><div>2020-09-25 12:26:04</div></a></div><div class="text"><p>I guess it's time to switch to <code>text</code> <span aria-label="sweat smile" class="emoji emoji-1f605" role="img" title="sweat smile">:sweat_smile:</span></p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/b450c754c95e372799d56cb7eef2eba2?d=identicon&amp;version=1"></a><div class="content"><a class="author">James Sully</a><div class="metadata"><a href="#211250965" name="211250965"><div>2020-09-25 12:27:45</div></a></div><div class="text"><p>True!</p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/b450c754c95e372799d56cb7eef2eba2?d=identicon&amp;version=1"></a><div class="content"><a class="author">James Sully</a><div class="metadata"><a href="#211251034" name="211251034"><div>2020-09-25 12:28:15</div></a></div><div class="text"><p>I'm curious why I'd be getting a segfault there. Super strange</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/7334dc60b6aef6a75cd9284126231f13c76926a5?x=x&amp;version=4"></a><div class="content"><a class="author">Torsten Schmits</a><div class="metadata"><a href="#211251075" name="211251075"><div>2020-09-25 12:28:36</div></a></div><div class="text"><p>you're parsing this behemoth into an integer!</p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/b450c754c95e372799d56cb7eef2eba2?d=identicon&amp;version=1"></a><div class="content"><a class="author">James Sully</a><div class="metadata"><a href="#211251115" name="211251115"><div>2020-09-25 12:29:04</div></a></div><div class="text"><p>Ah, of course</p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/b450c754c95e372799d56cb7eef2eba2?d=identicon&amp;version=1"></a><div class="content"><a class="author">James Sully</a><div class="metadata"><a href="#211251259" name="211251259"><div>2020-09-25 12:30:06</div></a></div><div class="text"><p>Ok, off to mess with it again</p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/b450c754c95e372799d56cb7eef2eba2?d=identicon&amp;version=1"></a><div class="content"><a class="author">James Sully</a><div class="metadata"><a href="#211253136" name="211253136"><div>2020-09-25 12:49:44</div></a></div><div class="text"><p>Ok, I now have </p>
<div class="codehilite" data-code-language="Haskell"><pre><span></span><code><span class="kr">import</span> <span class="k">qualified</span> <span class="nn">Data.Text</span> <span class="k">as</span> <span class="n">T</span>
<span class="kr">import</span>           <span class="nn">Data.Text</span> <span class="p">(</span><span class="kt">Text</span><span class="p">)</span>
<span class="kr">import</span> <span class="k">qualified</span> <span class="nn">Data.Text.IO</span> <span class="k">as</span> <span class="n">T</span>
<span class="kr">import</span> <span class="nn">Data.Semigroup</span> <span class="p">(</span><span class="nf">stimes</span><span class="p">)</span>
<span class="kr">import</span> <span class="nn">Data.Char</span> <span class="p">(</span><span class="nf">digitToInt</span><span class="p">)</span>

<span class="nf">makeP</span> <span class="ow">::</span> <span class="kt">Text</span> <span class="ow">-&gt;</span> <span class="kt">Integer</span> <span class="ow">-&gt;</span> <span class="kt">Text</span>
<span class="nf">makeP</span> <span class="n">n</span> <span class="n">k</span> <span class="ow">=</span> <span class="n">stimes</span> <span class="n">k</span> <span class="n">n</span>

<span class="nf">superDigit</span> <span class="ow">::</span> <span class="kt">Text</span> <span class="ow">-&gt;</span> <span class="kt">Int</span>
<span class="nf">superDigit</span> <span class="n">n</span>
  <span class="o">|</span> <span class="kt">T</span><span class="o">.</span><span class="n">length</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">=</span> <span class="n">digitToInt</span> <span class="o">$</span> <span class="kt">T</span><span class="o">.</span><span class="n">head</span> <span class="n">n</span>
  <span class="o">|</span> <span class="n">otherwise</span>       <span class="ow">=</span> <span class="n">superDigit</span>
                    <span class="o">.</span> <span class="n">txtShow</span>
                    <span class="o">.</span> <span class="kt">T</span><span class="o">.</span><span class="n">foldl</span> <span class="p">(</span><span class="nf">\</span><span class="n">n</span> <span class="n">c</span> <span class="ow">-&gt;</span> <span class="n">n</span> <span class="o">+</span> <span class="n">digitToInt</span> <span class="n">c</span><span class="p">)</span> <span class="mi">0</span>
                    <span class="o">$</span> <span class="n">n</span>

<span class="nf">doIt</span> <span class="ow">::</span> <span class="kt">Text</span> <span class="ow">-&gt;</span> <span class="kt">Text</span>
<span class="nf">doIt</span> <span class="n">input</span> <span class="ow">=</span> <span class="kr">case</span> <span class="kt">T</span><span class="o">.</span><span class="n">words</span> <span class="n">input</span> <span class="kr">of</span>
  <span class="p">[</span><span class="n">n</span><span class="p">,</span> <span class="n">k</span><span class="p">]</span> <span class="ow">-&gt;</span> <span class="n">txtShow</span> <span class="o">.</span> <span class="n">superDigit</span> <span class="o">$</span> <span class="n">makeP</span> <span class="n">n</span> <span class="p">(</span><span class="n">txtRead</span> <span class="n">k</span><span class="p">)</span>
  <span class="kr">_</span>      <span class="ow">-&gt;</span> <span class="kt">T</span><span class="o">.</span><span class="n">pack</span> <span class="s">"invalid input"</span>

<span class="nf">txtRead</span> <span class="ow">::</span> <span class="kt">Read</span> <span class="n">a</span> <span class="ow">=&gt;</span> <span class="kt">Text</span> <span class="ow">-&gt;</span> <span class="n">a</span>
<span class="nf">txtRead</span> <span class="ow">=</span> <span class="n">read</span> <span class="o">.</span> <span class="kt">T</span><span class="o">.</span><span class="n">unpack</span>

<span class="nf">txtShow</span> <span class="ow">::</span> <span class="kt">Show</span> <span class="n">a</span> <span class="ow">=&gt;</span> <span class="n">a</span> <span class="ow">-&gt;</span> <span class="kt">Text</span>
<span class="nf">txtShow</span> <span class="ow">=</span> <span class="kt">T</span><span class="o">.</span><span class="n">pack</span> <span class="o">.</span> <span class="n">show</span>

<span class="nf">interactLn</span> <span class="ow">::</span> <span class="p">(</span><span class="kt">Text</span> <span class="ow">-&gt;</span> <span class="kt">Text</span><span class="p">)</span> <span class="ow">-&gt;</span> <span class="kt">IO</span> <span class="nb">()</span>
<span class="nf">interactLn</span> <span class="n">f</span> <span class="ow">=</span> <span class="kt">T</span><span class="o">.</span><span class="n">putStrLn</span> <span class="o">.</span> <span class="n">f</span> <span class="o">=&lt;&lt;</span> <span class="kt">T</span><span class="o">.</span><span class="n">getLine</span>

<span class="nf">main</span> <span class="ow">=</span> <span class="n">interactLn</span> <span class="n">doIt</span>
</code></pre></div>

<p>Still getting a long wait followed by a segfault</p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/b450c754c95e372799d56cb7eef2eba2?d=identicon&amp;version=1"></a><div class="content"><a class="author">James Sully</a><div class="metadata"><a href="#211253211" name="211253211"><div>2020-09-25 12:50:06</div></a></div><div class="text"><p>I have a feeling it has to do with <code>Show</code> and <code>Read</code>, although I'm not sure how to avoid them</p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/b450c754c95e372799d56cb7eef2eba2?d=identicon&amp;version=1"></a><div class="content"><a class="author">James Sully</a><div class="metadata"><a href="#211253219" name="211253219"><div>2020-09-25 12:50:12</div></a></div><div class="text"><p>I guess i'd better profile again</p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/b450c754c95e372799d56cb7eef2eba2?d=identicon&amp;version=1"></a><div class="content"><a class="author">James Sully</a><div class="metadata"><a href="#211253693" name="211253693"><div>2020-09-25 12:55:38</div></a></div><div class="text"><p>Ah, I think I'm going to have to set up a stack project in order to profile <code>text</code>?</p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/b450c754c95e372799d56cb7eef2eba2?d=identicon&amp;version=1"></a><div class="content"><a class="author">James Sully</a><div class="metadata"><a href="#211253713" name="211253713"><div>2020-09-25 12:55:53</div></a></div><div class="text"><p>annoying</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/7334dc60b6aef6a75cd9284126231f13c76926a5?x=x&amp;version=4"></a><div class="content"><a class="author">Torsten Schmits</a><div class="metadata"><a href="#211253795" name="211253795"><div>2020-09-25 12:56:25</div></a></div><div class="text"><p>what about <code>cabal --enable-library-profiling</code>?</p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/b450c754c95e372799d56cb7eef2eba2?d=identicon&amp;version=1"></a><div class="content"><a class="author">James Sully</a><div class="metadata"><a href="#211253842" name="211253842"><div>2020-09-25 12:57:06</div></a></div><div class="text"><p>I'm currently just using a single file, will that work for globally installed packages?</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/7334dc60b6aef6a75cd9284126231f13c76926a5?x=x&amp;version=4"></a><div class="content"><a class="author">Torsten Schmits</a><div class="metadata"><a href="#211253843" name="211253843"><div>2020-09-25 12:57:07</div></a></div><div class="text"><p>also, use <code>Text.foldl'</code> to avoid laziness</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/7334dc60b6aef6a75cd9284126231f13c76926a5?x=x&amp;version=4"></a><div class="content"><a class="author">Torsten Schmits</a><div class="metadata"><a href="#211253879" name="211253879"><div>2020-09-25 12:57:29</div></a></div><div class="text"><p><span class="user-mention silent" data-user-id="251123">James Sully</span> <a href="#narrow/stream/201385-Haskell/topic/Hackerrank.20problem.20-.20how.20to.20go.20faster.3F/near/211253842">said</a>:</p>
<blockquote>
<p>I'm currently just using a single file, will that work for globally installed packages?</p>
</blockquote>
<p>I guess not</p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/b450c754c95e372799d56cb7eef2eba2?d=identicon&amp;version=1"></a><div class="content"><a class="author">James Sully</a><div class="metadata"><a href="#211253910" name="211253910"><div>2020-09-25 12:57:55</div></a></div><div class="text"><p>Is that for if I have an existing cabal project?</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/7334dc60b6aef6a75cd9284126231f13c76926a5?x=x&amp;version=4"></a><div class="content"><a class="author">Torsten Schmits</a><div class="metadata"><a href="#211253967" name="211253967"><div>2020-09-25 12:58:06</div></a></div><div class="text"><p>yeah, wrong assumption</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/7334dc60b6aef6a75cd9284126231f13c76926a5?x=x&amp;version=4"></a><div class="content"><a class="author">Torsten Schmits</a><div class="metadata"><a href="#211254061" name="211254061"><div>2020-09-25 12:59:18</div></a></div><div class="text"><p>btw, are you compiling with <code>-O2</code>?</p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/b450c754c95e372799d56cb7eef2eba2?d=identicon&amp;version=1"></a><div class="content"><a class="author">James Sully</a><div class="metadata"><a href="#211254201" name="211254201"><div>2020-09-25 13:00:43</div></a></div><div class="text"><p>With the strict fold, It gets the correct answer after a few seconds rather than segfaulting, but still not fast enough for hackerrank</p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/b450c754c95e372799d56cb7eef2eba2?d=identicon&amp;version=1"></a><div class="content"><a class="author">James Sully</a><div class="metadata"><a href="#211254228" name="211254228"><div>2020-09-25 13:01:00</div></a></div><div class="text"><p><span class="user-mention silent" data-user-id="260881">Torsten Schmits</span> <a href="#narrow/stream/201385-Haskell/topic/Hackerrank.20problem.20-.20how.20to.20go.20faster.3F/near/211254061">said</a>:</p>
<blockquote>
<p>btw, are you compiling with <code>-O2</code>?</p>
</blockquote>
<p>No, I didn't want to make assumptions about how hackerrank is compiling</p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/b450c754c95e372799d56cb7eef2eba2?d=identicon&amp;version=1"></a><div class="content"><a class="author">James Sully</a><div class="metadata"><a href="#211254261" name="211254261"><div>2020-09-25 13:01:14</div></a></div><div class="text"><p>I guess it's worth it for experimenting</p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/b450c754c95e372799d56cb7eef2eba2?d=identicon&amp;version=1"></a><div class="content"><a class="author">James Sully</a><div class="metadata"><a href="#211254317" name="211254317"><div>2020-09-25 13:01:52</div></a></div><div class="text"><p>-O2 Didn't seem to make a huge difference</p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/b450c754c95e372799d56cb7eef2eba2?d=identicon&amp;version=1"></a><div class="content"><a class="author">James Sully</a><div class="metadata"><a href="#211254386" name="211254386"><div>2020-09-25 13:02:21</div></a></div><div class="text"><p>man this is a heavy duty problem for something labelled "Difficulty: medium"</p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/b450c754c95e372799d56cb7eef2eba2?d=identicon&amp;version=1"></a><div class="content"><a class="author">James Sully</a><div class="metadata"><a href="#211254639" name="211254639"><div>2020-09-25 13:05:15</div></a></div><div class="text"><p>I'm gonna try profiling with stack</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/7334dc60b6aef6a75cd9284126231f13c76926a5?x=x&amp;version=4"></a><div class="content"><a class="author">Torsten Schmits</a><div class="metadata"><a href="#211255200" name="211255200"><div>2020-09-25 13:10:04</div></a></div><div class="text"><p>well if you're going for performance this will only get you so far, since you're operating on boxed <code>Int</code>s. for a bare-metal experience you'll need something like <code>UArray</code></p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/7334dc60b6aef6a75cd9284126231f13c76926a5?x=x&amp;version=4"></a><div class="content"><a class="author">Torsten Schmits</a><div class="metadata"><a href="#211255280" name="211255280"><div>2020-09-25 13:10:56</div></a></div><div class="text"><p>no idea if ghc can optimize that away in your current implementation tho</p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/b450c754c95e372799d56cb7eef2eba2?d=identicon&amp;version=1"></a><div class="content"><a class="author">James Sully</a><div class="metadata"><a href="#211255661" name="211255661"><div>2020-09-25 13:14:29</div></a></div><div class="text"><div class="codehilite"><pre><span></span><code>[I] james@SurfaceLaptop ~/D/h/superDigit&gt; cat superDigit-exe.prof                                                                                                                3s 503ms
        Fri Sep 25 23:13 2020 Time and Allocation Profiling Report  (Final)

           superDigit-exe +RTS -N -p -RTS

        total time  =        0.45 secs   (1785 ticks @ 1000 us, 4 processors)
        total alloc = 536,275,952 bytes  (excludes profiling overheads)

COST CENTRE  MODULE SRC                         %time %alloc

superDigit   Main   app/Main.hs:(11,1)-(16,23)   49.7    0.0
makeP        Main   app/Main.hs:8:1-22           34.9  100.0
superDigit.\ Main   app/Main.hs:15:41-56         15.2    0.0


                                                                                                             individual      inherited
COST CENTRE       MODULE                SRC                                               no.     entries  %time %alloc   %time %alloc

MAIN              MAIN                  &lt;built-in&gt;                                        222          0    0.0    0.0   100.0  100.0
 CAF              Data.Text.Array       &lt;entire-module&gt;                                   410          0    0.0    0.0     0.0    0.0
 CAF              Data.Text.Internal.IO &lt;entire-module&gt;                                   399          0    0.0    0.0     0.0    0.0
 CAF              GHC.Conc.Signal       &lt;entire-module&gt;                                   337          0    0.0    0.0     0.0    0.0
 CAF              GHC.IO.Encoding       &lt;entire-module&gt;                                   319          0    0.0    0.0     0.0    0.0
 CAF              GHC.IO.Encoding.Iconv &lt;entire-module&gt;                                   317          0    0.0    0.0     0.0    0.0
 CAF              GHC.IO.Handle.FD      &lt;entire-module&gt;                                   309          0    0.0    0.0     0.0    0.0
 CAF              Text.Read.Lex         &lt;entire-module&gt;                                   270          0    0.0    0.0     0.0    0.0
 CAF              GHC.Event.Thread      &lt;entire-module&gt;                                   263          0    0.0    0.0     0.0    0.0
 CAF              GHC.Event.Poll        &lt;entire-module&gt;                                   240          0    0.1    0.0     0.1    0.0
 CAF:lvl4_r84l    Main                  &lt;no location info&gt;                                441          0    0.0    0.0     0.0    0.0
  main            Main                  app/Main.hs:32:1-22                               451          0    0.0    0.0     0.0    0.0
   interactLn     Main                  app/Main.hs:30:1-43                               452          0    0.0    0.0     0.0    0.0
    doIt          Main                  app/Main.hs:(19,1)-(21,34)                        453          0    0.0    0.0     0.0    0.0
     makeP        Main                  app/Main.hs:8:1-22                                454          0    0.0    0.0     0.0    0.0
 CAF:lvl_r84e     Main                  &lt;no location info&gt;                                438          0    0.0    0.0     0.0    0.0
 CAF:main1        Main                  &lt;no location info&gt;                                442          0    0.0    0.0     0.0    0.0
  main            Main                  app/Main.hs:32:1-22                               444          1    0.0    0.0     0.0    0.0
   interactLn     Main                  app/Main.hs:30:1-43                               445          1    0.0    0.0     0.0    0.0
 main             Main                  app/Main.hs:32:1-22                               446          0    0.0    0.0    99.9  100.0
  interactLn      Main                  app/Main.hs:30:1-43                               447          0    0.1    0.0    99.9  100.0
   doIt           Main                  app/Main.hs:(19,1)-(21,34)                        449          1    0.1    0.0    99.9  100.0
    superDigit    Main                  app/Main.hs:(11,1)-(16,23)                        456          4   49.7    0.0    64.9    0.0
     superDigit.\ Main                  app/Main.hs:15:41-56                              457  100000011   15.2    0.0    15.2    0.0
     txtShow      Main                  app/Main.hs:27:1-23                               458          3    0.0    0.0     0.0    0.0
    makeP         Main                  app/Main.hs:8:1-22                                450          1   34.9  100.0    34.9  100.0
    txtRead       Main                  app/Main.hs:24:1-25                               455          1    0.0    0.0     0.0    0.0
    txtShow       Main                  app/Main.hs:27:1-23                               459          1    0.0    0.0     0.0    0.0
   readTextDevice Data.Text.Internal.IO libraries/text/Data/Text/Internal/IO.hs:133:39-64 448          1    0.0    0.0     0.0    0.0
</code></pre></div></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/33ed1f4a88793f2221d759610e2e8ddb?d=identicon&amp;version=1"></a><div class="content"><a class="author">codygman</a><div class="metadata"><a href="#211255693" name="211255693"><div>2020-09-25 13:14:59</div></a></div><div class="text"><p>I bet this is just read and show being slow. You can use text-show from hackage, not sure if you can use it on hacker rank</p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/b450c754c95e372799d56cb7eef2eba2?d=identicon&amp;version=1"></a><div class="content"><a class="author">James Sully</a><div class="metadata"><a href="#211255900" name="211255900"><div>2020-09-25 13:16:36</div></a></div><div class="text"><p>Oh, cool, I'll try that.</p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/b450c754c95e372799d56cb7eef2eba2?d=identicon&amp;version=1"></a><div class="content"><a class="author">James Sully</a><div class="metadata"><a href="#211255949" name="211255949"><div>2020-09-25 13:17:06</div></a></div><div class="text"><p>Although it doesn't seem like that's the issue in the profile? I'm not super confident in interpreting it</p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/33ed1f4a88793f2221d759610e2e8ddb?d=identicon&amp;version=1"></a><div class="content"><a class="author">codygman</a><div class="metadata"><a href="#211255959" name="211255959"><div>2020-09-25 13:17:12</div></a></div><div class="text"><p>Don't forget foldl' and not foldl</p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/b450c754c95e372799d56cb7eef2eba2?d=identicon&amp;version=1"></a><div class="content"><a class="author">James Sully</a><div class="metadata"><a href="#211256210" name="211256210"><div>2020-09-25 13:19:15</div></a></div><div class="text"><p>I can't imagine the intended solution is Arrays, given the question is under <code>Practice &gt; Functional Programming &gt; Recursion</code> with medium difficulty haha</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/7334dc60b6aef6a75cd9284126231f13c76926a5?x=x&amp;version=4"></a><div class="content"><a class="author">Torsten Schmits</a><div class="metadata"><a href="#211256239" name="211256239"><div>2020-09-25 13:19:30</div></a></div><div class="text"><p>right <span aria-label="smile" class="emoji emoji-1f642" role="img" title="smile">:smile:</span></p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/33ed1f4a88793f2221d759610e2e8ddb?d=identicon&amp;version=1"></a><div class="content"><a class="author">codygman</a><div class="metadata"><a href="#211256272" name="211256272"><div>2020-09-25 13:19:51</div></a></div><div class="text"><p>Profile says makeP is slow, maybe make it's arguments strict with bangpatterns</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/7334dc60b6aef6a75cd9284126231f13c76926a5?x=x&amp;version=4"></a><div class="content"><a class="author">Torsten Schmits</a><div class="metadata"><a href="#211256459" name="211256459"><div>2020-09-25 13:21:22</div></a></div><div class="text"><p>try <code>{-# LANGUAGE Strict #-}</code></p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/33ed1f4a88793f2221d759610e2e8ddb?d=identicon&amp;version=1"></a><div class="content"><a class="author">codygman</a><div class="metadata"><a href="#211256461" name="211256461"><div>2020-09-25 13:21:23</div></a></div><div class="text"><p>Data.Text.Strict version of getLine? I think that exists</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/7334dc60b6aef6a75cd9284126231f13c76926a5?x=x&amp;version=4"></a><div class="content"><a class="author">Torsten Schmits</a><div class="metadata"><a href="#211256600" name="211256600"><div>2020-09-25 13:22:16</div></a></div><div class="text"><p>also probably helpful to hardcode the input to rule out IO <span aria-label="smile" class="emoji emoji-1f642" role="img" title="smile">:smile:</span></p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/b450c754c95e372799d56cb7eef2eba2?d=identicon&amp;version=1"></a><div class="content"><a class="author">James Sully</a><div class="metadata"><a href="#211256669" name="211256669"><div>2020-09-25 13:23:04</div></a></div><div class="text"><p>Just waiting for <code>text-show</code> to build</p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/b450c754c95e372799d56cb7eef2eba2?d=identicon&amp;version=1"></a><div class="content"><a class="author">James Sully</a><div class="metadata"><a href="#211258857" name="211258857"><div>2020-09-25 13:42:44</div></a></div><div class="text"><div class="codehilite" data-code-language="Haskell"><pre><span></span><code><span class="cm">{-# LANGUAGE Strict #-}</span>

<span class="c1">--{-# LANGUAGE BangPatterns #-}</span>

<span class="kr">import</span> <span class="k">qualified</span> <span class="nn">Data.Text</span> <span class="k">as</span> <span class="n">T</span>
<span class="kr">import</span>           <span class="nn">Data.Text</span> <span class="p">(</span><span class="kt">Text</span><span class="p">)</span>
<span class="kr">import</span> <span class="k">qualified</span> <span class="nn">Data.Text.IO</span> <span class="k">as</span> <span class="n">T</span>
<span class="kr">import</span> <span class="nn">Data.Semigroup</span> <span class="p">(</span><span class="nf">stimes</span><span class="p">)</span>
<span class="kr">import</span> <span class="nn">Data.Char</span> <span class="p">(</span><span class="nf">digitToInt</span><span class="p">)</span>
<span class="kr">import</span> <span class="nn">TextShow</span>

<span class="nf">makeP</span> <span class="ow">::</span> <span class="kt">Text</span> <span class="ow">-&gt;</span> <span class="kt">Integer</span> <span class="ow">-&gt;</span> <span class="kt">Text</span>
<span class="nf">makeP</span> <span class="n">n</span> <span class="n">k</span> <span class="ow">=</span> <span class="n">stimes</span> <span class="n">k</span> <span class="n">n</span>

<span class="nf">superDigit</span> <span class="ow">::</span> <span class="kt">Text</span> <span class="ow">-&gt;</span> <span class="kt">Int</span>
<span class="nf">superDigit</span> <span class="n">n</span>
  <span class="o">|</span> <span class="kt">T</span><span class="o">.</span><span class="n">length</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">=</span> <span class="n">digitToInt</span> <span class="o">$</span> <span class="kt">T</span><span class="o">.</span><span class="n">head</span> <span class="n">n</span>
  <span class="o">|</span> <span class="n">otherwise</span>       <span class="ow">=</span> <span class="n">superDigit</span>
                    <span class="o">.</span> <span class="n">showt</span>
                    <span class="o">.</span> <span class="kt">T</span><span class="o">.</span><span class="n">foldl'</span> <span class="p">(</span><span class="nf">\</span><span class="n">n</span> <span class="n">c</span> <span class="ow">-&gt;</span> <span class="n">n</span> <span class="o">+</span> <span class="n">digitToInt</span> <span class="n">c</span><span class="p">)</span> <span class="mi">0</span>
                    <span class="o">$</span> <span class="n">n</span>

<span class="nf">doIt</span> <span class="ow">::</span> <span class="kt">Text</span> <span class="ow">-&gt;</span> <span class="kt">Text</span>
<span class="nf">doIt</span> <span class="n">input</span> <span class="ow">=</span> <span class="kr">case</span> <span class="kt">T</span><span class="o">.</span><span class="n">words</span> <span class="n">input</span> <span class="kr">of</span>
  <span class="p">[</span><span class="n">n</span><span class="p">,</span> <span class="n">k</span><span class="p">]</span> <span class="ow">-&gt;</span> <span class="n">showt</span> <span class="o">.</span> <span class="n">superDigit</span> <span class="o">$</span> <span class="n">makeP</span> <span class="n">n</span> <span class="p">(</span><span class="n">txtRead</span> <span class="n">k</span><span class="p">)</span>
  <span class="kr">_</span>      <span class="ow">-&gt;</span> <span class="kt">T</span><span class="o">.</span><span class="n">pack</span> <span class="s">"invalid input"</span>

<span class="c1">-- only called once for k</span>
<span class="nf">txtRead</span> <span class="ow">::</span> <span class="kt">Read</span> <span class="n">a</span> <span class="ow">=&gt;</span> <span class="kt">Text</span> <span class="ow">-&gt;</span> <span class="n">a</span>
<span class="nf">txtRead</span> <span class="ow">=</span> <span class="n">read</span> <span class="o">.</span> <span class="kt">T</span><span class="o">.</span><span class="n">unpack</span>

<span class="c1">--txtShow :: Show a =&gt; a -&gt; Text</span>
<span class="c1">--txtShow = T.pack . show</span>

<span class="nf">interactLn</span> <span class="ow">::</span> <span class="p">(</span><span class="kt">Text</span> <span class="ow">-&gt;</span> <span class="kt">Text</span><span class="p">)</span> <span class="ow">-&gt;</span> <span class="kt">IO</span> <span class="nb">()</span>
<span class="nf">interactLn</span> <span class="n">f</span> <span class="ow">=</span> <span class="kt">T</span><span class="o">.</span><span class="n">putStrLn</span> <span class="o">.</span> <span class="n">f</span> <span class="o">=&lt;&lt;</span> <span class="kt">T</span><span class="o">.</span><span class="n">getLine</span>

<span class="c1">-- main = interactLn doIt</span>
<span class="nf">main</span> <span class="ow">=</span> <span class="kt">T</span><span class="o">.</span><span class="n">putStrLn</span> <span class="o">$</span> <span class="n">doIt</span> <span class="n">input</span>

<span class="nf">input</span> <span class="ow">=</span> <span class="kt">T</span><span class="o">.</span><span class="n">pack</span> <span class="s">"7404954009694227446246375747227852213692570890717884174001587537145838723390362624487926131161112710589127423098959327020544003395792482625191721603328307774998124389641069884634086849138515079220750462317357487762780480576640689175346956135668451835480490089962406773267569650663927778867764315211280625033388271518264961090111547480467065229843613873499846390257375933040086863430523668050046930387013897062106309406874425001127890574986610018093859693455518413268914361859000614904461902442822577552997680098389183082654625098817411306985010658756762152160904278169491634807464356130877526392725432086439934006728914411061861235300979536190100734360684054557448454640750198466877185875290011114667186730452681943043971812380628117527172389889545776779555664826488520325234792648448625225364535053605515386730925070072896004645416713682004600636574389040662827182696337187610904694029221880801372864040345567230941110986028568372710970460116491983700312243090679537497139499778923997433720159174153 100000"</span>
</code></pre></div></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/b450c754c95e372799d56cb7eef2eba2?d=identicon&amp;version=1"></a><div class="content"><a class="author">James Sully</a><div class="metadata"><a href="#211258912" name="211258912"><div>2020-09-25 13:43:11</div></a></div><div class="text"><p>profile:</p>
<div class="codehilite"><pre><span></span><code>        Fri Sep 25 23:42 2020 Time and Allocation Profiling Report  (Final)

           superDigit-exe +RTS -N -p -RTS

        total time  =        0.28 secs   (1131 ticks @ 1000 us, 4 processors)
        total alloc = 536,261,176 bytes  (excludes profiling overheads)

COST CENTRE  MODULE SRC                         %time %alloc

superDigit   Main   app/Main.hs:(16,1)-(21,23)   52.0    0.0
makeP        Main   app/Main.hs:13:1-22          34.0  100.0
superDigit.\ Main   app/Main.hs:20:41-56         14.1    0.0


                                                                                                                                   individual      inherited
COST CENTRE                MODULE                                SRC                                            no.     entries  %time %alloc   %time %alloc

MAIN                       MAIN                                  &lt;built-in&gt;                                     353          0    0.0    0.0   100.0  100.0
 CAF                       Data.Text.Internal.Builder.Int.Digits &lt;entire-module&gt;                                530          0    0.0    0.0     0.0    0.0
 CAF                       GHC.Conc.Signal                       &lt;entire-module&gt;                                468          0    0.0    0.0     0.0    0.0
 CAF                       GHC.IO.Encoding                       &lt;entire-module&gt;                                450          0    0.0    0.0     0.0    0.0
 CAF                       GHC.IO.Encoding.Iconv                 &lt;entire-module&gt;                                448          0    0.0    0.0     0.0    0.0
 CAF                       GHC.IO.Handle.FD                      &lt;entire-module&gt;                                440          0    0.0    0.0     0.0    0.0
 CAF                       Text.Read.Lex                         &lt;entire-module&gt;                                401          0    0.0    0.0     0.0    0.0
 CAF                       GHC.Event.Thread                      &lt;entire-module&gt;                                394          0    0.0    0.0     0.0    0.0
 CAF                       GHC.Event.Poll                        &lt;entire-module&gt;                                371          0    0.0    0.0     0.0    0.0
 CAF:$fTextShowInt_$cshowt TextShow.Data.Integral                src/TextShow/Data/Integral.hs:103:10-21        650          0    0.0    0.0     0.0    0.0
  showt                    TextShow.Classes                      src/TextShow/Classes.hs:123:5-23               712          1    0.0    0.0     0.0    0.0
   showtPrec               TextShow.Classes                      src/TextShow/Classes.hs:108:5-41               713          1    0.0    0.0     0.0    0.0
    showtlPrec             TextShow.Classes                      src/TextShow/Classes.hs:149:5-43               716          1    0.0    0.0     0.0    0.0
 CAF:input_r4KV            Main                                  app/Main.hs:41:1-5                             699          0    0.0    0.0     0.0    0.0
  input                    Main                                  app/Main.hs:41:1-1024                          711          1    0.0    0.0     0.0    0.0
 CAF:lvl3_rawP             Main                                  &lt;no location info&gt;                             700          0    0.0    0.0     0.0    0.0
  main                     Main                                  app/Main.hs:39:1-30                            720          0    0.0    0.0     0.0    0.0
   doIt                    Main                                  app/Main.hs:(24,1)-(26,34)                     721          0    0.0    0.0     0.0    0.0
    makeP                  Main                                  app/Main.hs:13:1-22                            722          0    0.0    0.0     0.0    0.0
 CAF:lvl_rawL              Main                                  &lt;no location info&gt;                             698          0    0.0    0.0     0.0    0.0
 CAF:main1                 Main                                  &lt;no location info&gt;                             704          0    0.0    0.0     0.0    0.0
  main                     Main                                  app/Main.hs:39:1-30                            706          1    0.0    0.0     0.0    0.0
 CAF:main2                 Main                                  &lt;no location info&gt;                             703          0    0.0    0.0   100.0  100.0
  main                     Main                                  app/Main.hs:39:1-30                            709          0    0.0    0.0   100.0  100.0
   doIt                    Main                                  app/Main.hs:(24,1)-(26,34)                     710          0    0.0    0.0   100.0  100.0
    superDigit             Main                                  app/Main.hs:(16,1)-(21,23)                     723          4   52.0    0.0    66.0    0.0
     superDigit.\          Main                                  app/Main.hs:20:41-56                           727  100000011   14.1    0.0    14.1    0.0
     showt                 TextShow.Classes                      src/TextShow/Classes.hs:123:5-23               724          0    0.0    0.0     0.0    0.0
      showtPrec            TextShow.Classes                      src/TextShow/Classes.hs:108:5-41               725          0    0.0    0.0     0.0    0.0
       showtlPrec          TextShow.Classes                      src/TextShow/Classes.hs:149:5-43               726          0    0.0    0.0     0.0    0.0
        showbPrec          TextShow.Data.Integral                src/TextShow/Data/Integral.hs:(104,5)-(112,28) 728          3    0.0    0.0     0.0    0.0
         showbPrec.isTrue  TextShow.Data.Integral                src/TextShow/Data/Integral.hs:112:9-28         729          3    0.0    0.0     0.0    0.0
    makeP                  Main                                  app/Main.hs:13:1-22                            719          1   34.0  100.0    34.0  100.0
    txtRead                Main                                  app/Main.hs:30:1-25                            718          1    0.0    0.0     0.0    0.0
    showt                  TextShow.Classes                      src/TextShow/Classes.hs:123:5-23               714          0    0.0    0.0     0.0    0.0
     showtPrec             TextShow.Classes                      src/TextShow/Classes.hs:108:5-41               715          0    0.0    0.0     0.0    0.0
      showtlPrec           TextShow.Classes                      src/TextShow/Classes.hs:149:5-43               717          0    0.0    0.0     0.0    0.0
       showbPrec           TextShow.Data.Integral                src/TextShow/Data/Integral.hs:(104,5)-(112,28) 730          1    0.0    0.0     0.0    0.0
        showbPrec.isTrue   TextShow.Data.Integral                src/TextShow/Data/Integral.hs:112:9-28         731          1    0.0    0.0     0.0    0.0
 main                      Main                                  app/Main.hs:39:1-30                            707          0    0.0    0.0     0.0    0.0
  doIt                     Main                                  app/Main.hs:(24,1)-(26,34)                     708          1    0.0    0.0     0.0    0.0
</code></pre></div></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/b450c754c95e372799d56cb7eef2eba2?d=identicon&amp;version=1"></a><div class="content"><a class="author">James Sully</a><div class="metadata"><a href="#211259055" name="211259055"><div>2020-09-25 13:44:25</div></a></div><div class="text"><p>Unfortunately hackerrank won't let me use <code>text-show</code></p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/b450c754c95e372799d56cb7eef2eba2?d=identicon&amp;version=1"></a><div class="content"><a class="author">James Sully</a><div class="metadata"><a href="#211259169" name="211259169"><div>2020-09-25 13:45:37</div></a></div><div class="text"><p>I think I'm done with this one for now, this problem is wack</p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/b450c754c95e372799d56cb7eef2eba2?d=identicon&amp;version=1"></a><div class="content"><a class="author">James Sully</a><div class="metadata"><a href="#211259574" name="211259574"><div>2020-09-25 13:48:24</div></a></div><div class="text"><p>Oh I spoiled myself and looked at the solution. It's an algorithmic thing, not an optimization thing.</p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/b450c754c95e372799d56cb7eef2eba2?d=identicon&amp;version=1"></a><div class="content"><a class="author">James Sully</a><div class="metadata"><a href="#211259602" name="211259602"><div>2020-09-25 13:48:36</div></a></div><div class="text"><p>Goddamn hahaha</p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/33ed1f4a88793f2221d759610e2e8ddb?d=identicon&amp;version=1"></a><div class="content"><a class="author">codygman</a><div class="metadata"><a href="#211259721" name="211259721"><div>2020-09-25 13:49:25</div></a></div><div class="text"><p>stimes is O(log n) btw, stimesIdempotent is O(1)</p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/33ed1f4a88793f2221d759610e2e8ddb?d=identicon&amp;version=1"></a><div class="content"><a class="author">codygman</a><div class="metadata"><a href="#211259788" name="211259788"><div>2020-09-25 13:49:56</div></a></div><div class="text"><p>I like trying to make all of the problems optimization problems to practice benchmarking lol</p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/33ed1f4a88793f2221d759610e2e8ddb?d=identicon&amp;version=1"></a><div class="content"><a class="author">codygman</a><div class="metadata"><a href="#211259893" name="211259893"><div>2020-09-25 13:50:43</div></a></div><div class="text"><p>Idk if you can use stimesIdempotent actually</p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/b450c754c95e372799d56cb7eef2eba2?d=identicon&amp;version=1"></a><div class="content"><a class="author">James Sully</a><div class="metadata"><a href="#211260109" name="211260109"><div>2020-09-25 13:52:24</div></a></div><div class="text"><p>It's just that <br>
<code>digitSum (k repeats of n) == k * digitSum n</code></p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/b450c754c95e372799d56cb7eef2eba2?d=identicon&amp;version=1"></a><div class="content"><a class="author">James Sully</a><div class="metadata"><a href="#211260142" name="211260142"><div>2020-09-25 13:52:40</div></a></div><div class="text"><p>this allows you to start the recursion with a much smaller number</p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/b450c754c95e372799d56cb7eef2eba2?d=identicon&amp;version=1"></a><div class="content"><a class="author">James Sully</a><div class="metadata"><a href="#211263240" name="211263240"><div>2020-09-25 14:14:30</div></a></div><div class="text"><p>final solution:</p>
<div class="codehilite" data-code-language="Haskell"><pre><span></span><code><span class="kr">import</span> <span class="nn">Data.Char</span> <span class="p">(</span><span class="nf">digitToInt</span><span class="p">)</span>

<span class="nf">superDigit</span> <span class="ow">::</span> <span class="kt">String</span> <span class="ow">-&gt;</span> <span class="kt">Int</span>
<span class="nf">superDigit</span> <span class="p">[</span><span class="n">d</span><span class="p">]</span> <span class="ow">=</span> <span class="n">digitToInt</span> <span class="n">d</span>
<span class="nf">superDigit</span> <span class="n">n</span> <span class="ow">=</span> <span class="n">superDigit</span> <span class="o">.</span> <span class="n">show</span> <span class="o">.</span> <span class="n">digitSum</span> <span class="o">$</span> <span class="n">n</span>

<span class="nf">digitSum</span> <span class="ow">::</span> <span class="kt">String</span> <span class="ow">-&gt;</span> <span class="kt">Int</span>
<span class="nf">digitSum</span> <span class="ow">=</span> <span class="n">sum</span> <span class="o">.</span> <span class="n">map</span> <span class="n">digitToInt</span>

<span class="nf">doIt</span> <span class="ow">::</span> <span class="kt">String</span> <span class="ow">-&gt;</span> <span class="kt">String</span>
<span class="nf">doIt</span> <span class="n">input</span> <span class="ow">=</span> <span class="kr">case</span> <span class="n">words</span> <span class="n">input</span> <span class="kr">of</span>
  <span class="p">[</span><span class="n">n</span><span class="p">,</span> <span class="n">k</span><span class="p">]</span> <span class="ow">-&gt;</span> <span class="kr">let</span> <span class="n">initial</span> <span class="ow">::</span> <span class="kt">String</span>
                <span class="n">initial</span> <span class="ow">=</span> <span class="n">show</span> <span class="o">$</span> <span class="n">read</span> <span class="n">k</span> <span class="o">*</span> <span class="n">digitSum</span> <span class="n">n</span>
            <span class="kr">in</span>  <span class="n">show</span> <span class="o">.</span> <span class="n">superDigit</span> <span class="o">$</span> <span class="n">initial</span>
  <span class="kr">_</span>      <span class="ow">-&gt;</span> <span class="s">"invalid input"</span>

<span class="nf">interactLn</span> <span class="ow">::</span> <span class="p">(</span><span class="kt">String</span> <span class="ow">-&gt;</span> <span class="kt">String</span><span class="p">)</span> <span class="ow">-&gt;</span> <span class="kt">IO</span> <span class="nb">()</span>
<span class="nf">interactLn</span> <span class="n">f</span> <span class="ow">=</span> <span class="n">putStrLn</span> <span class="o">.</span> <span class="n">f</span> <span class="o">=&lt;&lt;</span> <span class="n">getLine</span>

<span class="nf">main</span> <span class="ow">=</span> <span class="n">interactLn</span> <span class="n">doIt</span>
</code></pre></div></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/7334dc60b6aef6a75cd9284126231f13c76926a5?x=x&amp;version=4"></a><div class="content"><a class="author">Torsten Schmits</a><div class="metadata"><a href="#211263328" name="211263328"><div>2020-09-25 14:15:13</div></a></div><div class="text"><p>boooringggg <span aria-label="sweat smile" class="emoji emoji-1f605" role="img" title="sweat smile">:sweat_smile:</span></p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/b450c754c95e372799d56cb7eef2eba2?d=identicon&amp;version=1"></a><div class="content"><a class="author">James Sully</a><div class="metadata"><a href="#211263339" name="211263339"><div>2020-09-25 14:15:18</div></a></div><div class="text"><p>hahaha</p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/b450c754c95e372799d56cb7eef2eba2?d=identicon&amp;version=1"></a><div class="content"><a class="author">James Sully</a><div class="metadata"><a href="#211263445" name="211263445"><div>2020-09-25 14:16:03</div></a></div><div class="text"><p>At least I learned how to profile</p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/b450c754c95e372799d56cb7eef2eba2?d=identicon&amp;version=1"></a><div class="content"><a class="author">James Sully</a><div class="metadata"><a href="#211263519" name="211263519"><div>2020-09-25 14:16:38</div></a></div><div class="text"><p>and also not to</p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/b450c754c95e372799d56cb7eef2eba2?d=identicon&amp;version=1"></a><div class="content"><a class="author">James Sully</a><div class="metadata"><a href="#211263796" name="211263796"><div>2020-09-25 14:18:32</div></a></div><div class="text"><p>They say "don't try to guess what the perf problem is, use profiling". But I had the issue at one higher level up, I guessed that I needed to micro optimize instead of noticing the macro optimization of thinking about the problem differently.</p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/b450c754c95e372799d56cb7eef2eba2?d=identicon&amp;version=1"></a><div class="content"><a class="author">James Sully</a><div class="metadata"><a href="#211264436" name="211264436"><div>2020-09-25 14:23:55</div></a></div><div class="text"><p>Thanks very much for your help <span class="user-mention" data-user-id="260881">@Torsten Schmits</span>  <span class="user-mention" data-user-id="325194">@codygman</span> !</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/7334dc60b6aef6a75cd9284126231f13c76926a5?x=x&amp;version=4"></a><div class="content"><a class="author">Torsten Schmits</a><div class="metadata"><a href="#211264502" name="211264502"><div>2020-09-25 14:24:15</div></a></div><div class="text"><p>it was a pleasure!</p></div></div></div></div></div><div class="ui vertical footer segment"><a href="https://github.com/srid/zulip-archive">Powered by Haskell</a> | Questions? Contact <a href="https://www.srid.ca">srid</a></div></div></body></html>