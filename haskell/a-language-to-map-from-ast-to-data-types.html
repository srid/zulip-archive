<html lang="en"><head><meta content="text/html; charset=utf-8" http-equiv="Content-Type"><meta content="width=device-width, initial-scale=1" name="viewport"><meta content="Is there already a library or something that does this in an abstract manner?
I have a Markdown parsed into Pandoc AST. I want to &quot;map&quot; this AST into some custom structured data type. I want a &quot;language&quot; that can define this &quot;map&quot;, to convert pandoc&#39;s AST to whatever custom type.
Here&#39;s an example,
" name="description"><link href="https://funprog.srid.ca/haskell/a-language-to-map-from-ast-to-data-types.html" rel="canonical"><meta property="og:title" content="A language to &#39;map&#39; from AST to data types - Haskell"><meta property="og:site_name" content="Functional Programming Zulip Archive"><meta property="og:type" content="article"><meta property="og:article:section" content="Haskell"><meta property="og:article:modified_time" content="2021-04-03T02:00:57Z"><meta property="og:article:published_time" content="2021-04-03T02:00:57Z"><meta property="og:image" content="https://zulip-avatars.s3.amazonaws.com/13896/4429aa8b689608f24a4ad712843ce29862e330d2?x=x&amp;version=2"><title>A language to &#39;map&#39; from AST to data types - Haskell</title><style type="text/css">
div#thesite
{
  font-family   : "Open Sans", sans-serif;
  font-size     : 1em !important;
  margin-top    : 1em;
  margin-bottom : 1em;
}

div#thesite h1
{
  font-family : "Roboto", sans-serif;
  line-height : 1.19999em;
}

div#thesite h2
{
  font-family : "Roboto", sans-serif;
  line-height : 1.19999em;
}

div#thesite h3
{
  font-family : "Roboto", sans-serif;
  line-height : 1.19999em;
}

div#thesite h4
{
  font-family : "Roboto", sans-serif;
  line-height : 1.19999em;
}

div#thesite h5
{
  font-family : "Roboto", sans-serif;
  line-height : 1.19999em;
}

div#thesite h6
{
  font-family : "Roboto", sans-serif;
  line-height : 1.19999em;
}

div#thesite .ui.breadcrumb.rib .section
{
  font-family : "Roboto", sans-serif;
  line-height : 1.19999em;
}

div#thesite .header
{
  font-family : "Roboto", sans-serif;
  line-height : 1.19999em;
}

div#thesite .as-header
{
  font-family : "Roboto", sans-serif;
  line-height : 1.19999em;
}

div#thesite code, pre, tt
{
  font-family : "SFMono-Regular","Menlo","Monaco","Consolas","Liberation Mono","Courier New", monospace;
}

div#thesite .ui.breadcrumb.rib
{
  margin-bottom : 1em;
}



div#thesite .ui.comments.messages .comment .metadata a
{
  color : #808080;
}

div#thesite .ui.comments.messages .comment a.avatar img
{
  height : auto;
}

div#thesite .subtle
{
  color : #808080;
}


div#thesite .messages pre
{
  font-size : 85%;
  overflow  : auto;
  max-width : 100%;
}

div#thesite .messages .message_embed
{
  border-left  : solid 3px #808080;
  padding-left : 0.69999em;
}

div#thesite .messages .message_inline_image img
{
  max-width     : 100%;
  margin-bottom : 1em;
}


/* Generated with Clay, http://fvisser.nl/clay */</style><link href="https://cdnjs.cloudflare.com/ajax/libs/semantic-ui/2.4.1/semantic.min.css" rel="stylesheet"><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css" rel="stylesheet"><link href="https://fonts.googleapis.com/css?family=Open+Sans|Oswald&amp;display=swap" rel="stylesheet"><link href="https://fonts.googleapis.com/css?family=Roboto|Open+Sans&amp;display=swap" rel="stylesheet"></head><body><div id="thesite" class="ui text container"><div class="ui violet inverted top attached center aligned segment"><h1 class="ui huge header">A language to &#39;map&#39; from AST to data types - Haskell</h1></div><div class="ui attached segment"><div class="ui message"><p>Welcome to the Functional Programming Zulip Chat Archive. You can join the chat <a href="https://funprog.zulipchat.com">here</a>.</p></div><div class="ui breadcrumb rib"><a href="/" class="section">Home</a><i class="right angle icon divider"></i><a href="/haskell/" class="section">#Haskell</a><i class="right angle icon divider"></i><div class="active section">A language to &#39;map&#39; from AST to data types</div></div><div class="ui comments messages"><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/4429aa8b689608f24a4ad712843ce29862e330d2?x=x&amp;version=2"></a><div class="content"><a class="author">Sridhar Ratnakumar</a><div class="metadata"><a href="#232972178" name="232972178"><div>2021-04-03 02:00:57</div></a></div><div class="text"><p>Is there already a library or something that does this in an abstract manner?</p>
<p>I have a Markdown parsed into Pandoc AST. I want to "map" this AST into some custom structured data type. I want a "language" that can define this "map", to convert pandoc's AST to whatever custom type.</p>
<p>Here's an example,</p>
<div class="codehilite" data-code-language="markdown"><pre><span></span><code><span class="gu">## Feature 1</span>
en
: This is a english description of feature 1
fr
: Ceci est une description française de la fonctionnalité 1

<span class="gu">## Feature 2</span>
en
: ...
fr
: ...
</code></pre></div>
<p>Imagine we have the Pandoc AST for the above Markdown (the translation table of each feature is represented in the AST as <a href="https://www.markdownguide.org/extended-syntax/#definition-lists">definition lists</a>), and I'd like to write a "map" for converting it to the values of the following data type <code>Features</code>:</p>
<div class="codehilite" data-code-language="Haskell"><pre><span></span><code><span class="kr">type</span> <span class="kt">Features</span> <span class="ow">=</span> <span class="kt">NonEmpty</span> <span class="kt">Feature</span>

<span class="kr">data</span> <span class="kt">Feature</span> <span class="ow">=</span> <span class="kt">Feature</span> <span class="p">{</span> <span class="n">unFeature</span> <span class="ow">::</span> <span class="kt">Translated</span> <span class="kt">Text</span> <span class="p">}</span>

<span class="kr">data</span> <span class="kt">Translated</span> <span class="n">a</span> <span class="ow">=</span> <span class="kt">Map</span> <span class="kt">Lang</span> <span class="n">a</span> <span class="c1">-- TODO: use non-empty map with default key</span>

<span class="kr">data</span> <span class="kt">Lang</span> <span class="ow">=</span> <span class="kt">EN</span> <span class="o">|</span> <span class="kt">FR</span>
</code></pre></div>
<p>How would you approach this problem more generally, so as to make it possible to support other output data types with minimal code (for mapping)?</p>
<p>The map should be strict, so as to fail on unexpected markdown uses (eg: don't want third level heading or blockquotes in the example above).</p>
<div class="message_embed"><a class="message_embed_image" href="https://www.markdownguide.org/extended-syntax/#definition-lists" style="background-image: url(https://www.markdownguide.org/assets/images/markdown-guide-og.jpg)"></a><div class="data-container"><div class="message_embed_title"><a href="https://www.markdownguide.org/extended-syntax/#definition-lists" title="Extended Syntax | Markdown Guide">Extended Syntax | Markdown Guide</a></div><div class="message_embed_description">Advanced features that build on the basic Markdown syntax.</div></div></div></div></div></div></div></div><div class="ui vertical footer segment"><a href="https://github.com/srid/zulip-archive">Powered by Haskell</a> | Questions? Contact <a href="https://www.srid.ca">srid</a></div></div></body></html>