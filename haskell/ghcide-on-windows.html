<html lang="en"><head><meta content="text/html; charset=utf-8" http-equiv="Content-Type"><meta content="width=device-width, initial-scale=1" name="viewport"><meta content="Does anyone know what the most painless way to install ghcide on Windows is? I&#39;ve been trying to get it to work with stack but I&#39;ve been running into errors compiling it with 8.8.3 and it won&#39;t even build with the 8.10 resolver." name="description"><link href="https://funprog.srid.ca/haskell/ghcide-on-windows.html" rel="canonical"><meta property="og:title" content="ghcide on windows - Haskell"><meta property="og:site_name" content="Functional Programming Zulip Archive"><meta property="og:type" content="article"><meta property="og:article:section" content="Haskell"><meta property="og:article:modified_time" content="2020-06-15T16:10:16Z"><meta property="og:article:published_time" content="2020-06-13T15:31:03Z"><title>ghcide on windows - Haskell</title><style type="text/css">
div#thesite
{
  font-family   : "Open Sans", sans-serif;
  font-size     : 1em !important;
  margin-top    : 1em;
  margin-bottom : 1em;
}

div#thesite h1
{
  font-family : "Roboto", sans-serif;
  line-height : 1.19999em;
}

div#thesite h2
{
  font-family : "Roboto", sans-serif;
  line-height : 1.19999em;
}

div#thesite h3
{
  font-family : "Roboto", sans-serif;
  line-height : 1.19999em;
}

div#thesite h4
{
  font-family : "Roboto", sans-serif;
  line-height : 1.19999em;
}

div#thesite h5
{
  font-family : "Roboto", sans-serif;
  line-height : 1.19999em;
}

div#thesite h6
{
  font-family : "Roboto", sans-serif;
  line-height : 1.19999em;
}

div#thesite .ui.breadcrumb.rib .section
{
  font-family : "Roboto", sans-serif;
  line-height : 1.19999em;
}

div#thesite .header
{
  font-family : "Roboto", sans-serif;
  line-height : 1.19999em;
}

div#thesite .as-header
{
  font-family : "Roboto", sans-serif;
  line-height : 1.19999em;
}

div#thesite code, pre, tt
{
  font-family : "SFMono-Regular","Menlo","Monaco","Consolas","Liberation Mono","Courier New", monospace;
}

div#thesite .ui.breadcrumb.rib
{
  margin-bottom : 1em;
}



div#thesite .ui.comments.messages .comment .metadata a
{
  color : #808080;
}

div#thesite .ui.comments.messages .comment a.avatar img
{
  height : auto;
}

div#thesite .subtle
{
  color : #808080;
}


div#thesite .messages pre
{
  font-size : 85%;
  overflow  : auto;
  max-width : 100%;
}

div#thesite .messages .message_embed
{
  border-left  : solid 3px #808080;
  padding-left : 0.69999em;
}

div#thesite .messages .message_inline_image img
{
  max-width     : 100%;
  margin-bottom : 1em;
}


/* Generated with Clay, http://fvisser.nl/clay */</style><link href="https://cdnjs.cloudflare.com/ajax/libs/semantic-ui/2.4.1/semantic.min.css" rel="stylesheet"><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css" rel="stylesheet"><link href="https://fonts.googleapis.com/css?family=Open+Sans|Oswald&amp;display=swap" rel="stylesheet"><link href="https://fonts.googleapis.com/css?family=Roboto|Open+Sans&amp;display=swap" rel="stylesheet"></head><body><div id="thesite" class="ui text container"><div class="ui violet inverted top attached center aligned segment"><h1 class="ui huge header">ghcide on windows - Haskell</h1></div><div class="ui attached segment"><div class="ui message"><p>Welcome to the Functional Programming Zulip Chat Archive. You can join the chat <a href="https://funprog.zulipchat.com">here</a>.</p></div><div class="ui breadcrumb rib"><a href="/" class="section">Home</a><i class="right angle icon divider"></i><a href="/haskell/" class="section">#Haskell</a><i class="right angle icon divider"></i><div class="active section">ghcide on windows</div></div><div class="ui comments messages"><div class="comment"><a class="avatar"></a><div class="content"><a class="author">James King</a><div class="metadata"><a href="#200771817" name="200771817"><div>2020-06-13 15:31:03</div></a></div><div class="text"><p>Does anyone know what the most painless way to install <code>ghcide</code> on Windows is? I've been trying to get it to work with <code>stack</code> but I've been running into errors compiling it with 8.8.3 and it won't even build with the 8.10 resolver.</p></div></div></div><div class="comment"><a class="avatar"></a><div class="content"><a class="author">James King</a><div class="metadata"><a href="#200772161" name="200772161"><div>2020-06-13 15:39:37</div></a></div><div class="text"><p>The build plan fails with stack:</p>
<div class="codehilite"><pre><span></span><code><span class="nt">resolver</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">nightly-2020-02-13</span>
<span class="nt">compiler</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ghc-8.10.1</span>
<span class="nt">allow-newer</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="nt">extra-deps</span><span class="p">:</span>
<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">haskell-lsp-0.22.0.0</span>
<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">haskell-lsp-types-0.22.0.0</span>
<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">lsp-test-0.11.0.1</span>
<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">ghc-check-0.3.0.1</span>
<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">hie-bios-0.5.0</span>

<span class="c1"># for ghc-8.10</span>
<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">Cabal-3.2.0.0</span>
<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">lens-4.19.1</span>

<span class="nt">nix</span><span class="p">:</span>
  <span class="nt">packages</span><span class="p">:</span> <span class="p p-Indicator">[</span><span class="nv">zlib</span><span class="p p-Indicator">]</span>
</code></pre></div>


<p>which says</p>
<div class="codehilite"><pre><span></span><code>Unrecognized fields in Snapshot: allow-newer, extra-deps, nix
</code></pre></div>


<p>and fails with</p>
<div class="codehilite"><pre><span></span><code>Error: While constructing the build plan, the following exceptions were encountered:

In the dependencies for haddock-library-1.8.0:
    base-4.14.0.0 from stack configuration does not match &gt;=4.7 &amp;&amp; &lt;4.14  (latest matching version is 4.13.0.0)
needed due to ghcide-0.2.0 -&gt; haddock-library-1.8.0
</code></pre></div>


<p>I've had it able to build with 8.8.3 but then the test runs into the <code>readCreateProcess</code> error they mention in the troubleshooting guide and nothing I've been able to do resolves that.</p>
<p>Are there pre-built binaries somewhere?</p></div></div></div><div class="comment"><a class="avatar"></a><div class="content"><a class="author">Magnus Therning</a><div class="metadata"><a href="#200772212" name="200772212"><div>2020-06-13 15:40:04</div></a></div><div class="text"><p>Is it Windows proper or WSL?</p></div></div></div><div class="comment"><a class="avatar"></a><div class="content"><a class="author">James King</a><div class="metadata"><a href="#200772708" name="200772708"><div>2020-06-13 15:52:26</div></a></div><div class="text"><p>Windows proper.</p></div></div></div><div class="comment"><a class="avatar"></a><div class="content"><a class="author">Georgi Lyubenov // googleson78</a><div class="metadata"><a href="#200783937" name="200783937"><div>2020-06-13 20:23:06</div></a></div><div class="text"><p>what is your stack version?</p></div></div></div><div class="comment"><a class="avatar"></a><div class="content"><a class="author">Georgi Lyubenov // googleson78</a><div class="metadata"><a href="#200783959" name="200783959"><div>2020-06-13 20:23:59</div></a></div><div class="text"><p>and also the "unrecognized fields" bit is very weird, what's your stack invocation?</p></div></div></div><div class="comment"><a class="avatar"></a><div class="content"><a class="author">James King</a><div class="metadata"><a href="#200784255" name="200784255"><div>2020-06-13 20:30:10</div></a></div><div class="text"><p><code>Version 2.3.1, Git revision de2a7b694f07de7e6cf17f8c92338c16286b2878 (8103 commits) x86_64 hpack-0.33.0</code><br>
<code>stack install --resolver stack810.yaml</code></p></div></div></div><div class="comment"><a class="avatar"></a><div class="content"><a class="author">James King</a><div class="metadata"><a href="#200784269" name="200784269"><div>2020-06-13 20:30:35</div></a></div><div class="text"><p>from a clean checkout of the ghcide repo</p></div></div></div><div class="comment"><a class="avatar"></a><div class="content"><a class="author">Georgi Lyubenov // googleson78</a><div class="metadata"><a href="#200784527" name="200784527"><div>2020-06-13 20:37:10</div></a></div><div class="text"><p>the flag to pass a specific <code>stack.yaml</code> is <code>--stack-yaml</code>, not <code>--resolver</code></p></div></div></div><div class="comment"><a class="avatar"></a><div class="content"><a class="author">James King</a><div class="metadata"><a href="#200785230" name="200785230"><div>2020-06-13 20:53:50</div></a></div><div class="text"><p>Oh geez</p></div></div></div><div class="comment"><a class="avatar"></a><div class="content"><a class="author">Georgi Lyubenov // googleson78</a><div class="metadata"><a href="#200785587" name="200785587"><div>2020-06-13 21:03:25</div></a></div><div class="text"><p>but the <code>readCreateProcess</code> problem sounds like it might not go away after this</p></div></div></div><div class="comment"><a class="avatar"></a><div class="content"><a class="author">James King</a><div class="metadata"><a href="#200786738" name="200786738"><div>2020-06-13 21:36:53</div></a></div><div class="text"><p>It does appear but the test says it completed successfully... </p>
<div class="codehilite"><pre><span></span><code>[INFO] Making new HscEnv[main,main,main]
Error while checking GHC version: &quot;C:\\\\Users\\\\james\\\\AppData\\\\Local\\\\Programs\\\\stack\\\\x86_64-windows\\\\ghc-8.10.1\\\\lib\\bin\\ghc: readCreateProcess: does not exist (No such file or directory)&quot;
Error while checking GHC version: &quot;C:\\\\Users\\\\james\\\\AppData\\\\Local\\\\Programs\\\\stack\\\\x86_64-windows\\\\ghc-8.10.1\\\\lib\\bin\\ghc: readCreateProcess: does not exist (No such file or directory)&quot;
Error while checking GHC version: &quot;C:\\\\Users\\\\james\\\\AppData\\\\Local\\\\Programs\\\\stack\\\\x86_64-windows\\\\ghc-8.10.1\\\\lib\\bin\\ghc: readCreateProcess: does not exist (No such file or directory)&quot;

Completed (4 files worked, 0 files failed)
</code></pre></div></div></div></div><div class="comment"><a class="avatar"></a><div class="content"><a class="author">Georgi Lyubenov // googleson78</a><div class="metadata"><a href="#200786873" name="200786873"><div>2020-06-13 21:40:30</div></a></div><div class="text"><p>and I'm guessing ghc actually exists there?</p></div></div></div><div class="comment"><a class="avatar"></a><div class="content"><a class="author">Georgi Lyubenov // googleson78</a><div class="metadata"><a href="#200786888" name="200786888"><div>2020-06-13 21:41:13</div></a></div><div class="text"><p>I guess you tried the "run ghcide from stack environment via <code>stack exec</code>" thing that they suggested?</p></div></div></div><div class="comment"><a class="avatar"></a><div class="content"><a class="author">James King</a><div class="metadata"><a href="#200787695" name="200787695"><div>2020-06-13 22:02:33</div></a></div><div class="text"><p>Yes, ran from the stack environment</p></div></div></div><div class="comment"><a class="avatar"></a><div class="content"><a class="author">James King</a><div class="metadata"><a href="#200789321" name="200789321"><div>2020-06-13 22:52:10</div></a></div><div class="text"><p>Damn, it works!</p></div></div></div><div class="comment"><a class="avatar"></a><div class="content"><a class="author">James King</a><div class="metadata"><a href="#200789326" name="200789326"><div>2020-06-13 22:52:58</div></a></div><div class="text"><p>I might look into a way to do pre-packaged builds for Windows at some point with a nice installer. <span aria-label="thinking" class="emoji emoji-1f914" role="img" title="thinking">:thinking:</span></p></div></div></div><div class="comment"><a class="avatar"></a><div class="content"><a class="author">Georgi Lyubenov // googleson78</a><div class="metadata"><a href="#200804814" name="200804814"><div>2020-06-14 07:39:29</div></a></div><div class="text"><p>what was wrong?</p></div></div></div><div class="comment"><a class="avatar"></a><div class="content"><a class="author">Georgi Lyubenov // googleson78</a><div class="metadata"><a href="#200804874" name="200804874"><div>2020-06-14 07:40:33</div></a></div><div class="text"><p>also, there's currently this issue, it would be great if it works out - <a href="https://github.com/haskell/haskell-language-server/issues/158">https://github.com/haskell/haskell-language-server/issues/158</a></p>
<div class="message_embed"><a class="message_embed_image" href="https://github.com/haskell/haskell-language-server/issues/158" style="background-image: url(https://avatars2.githubusercontent.com/u/450574?s=400&amp;v=4)"></a><div class="data-container"><div class="message_embed_title"><a href="https://github.com/haskell/haskell-language-server/issues/158" title="Static binaries and install-less VS Code extension · Issue #158 · haskell/haskell-language-server">Static binaries and install-less VS Code extension · Issue #158 · haskell/haskell-language-server</a></div><div class="message_embed_description">It&#39;s becoming increasingly obvious that one of the major turnoffs for newcomers is the manual installation. Since we&#39;re pulling in so many dependencies, and for a complete install of all th...</div></div></div></div></div></div><div class="comment"><a class="avatar"></a><div class="content"><a class="author">James King</a><div class="metadata"><a href="#200910916" name="200910916"><div>2020-06-15 16:10:16</div></a></div><div class="text"><p><span class="user-mention silent" data-user-id="254032">Georgi Lyubenov // googleson78</span> <a href="#narrow/stream/201385-Haskell/topic/ghcide.20on.20windows/near/200804814">said</a>:</p>
<blockquote>
<p>what was wrong?</p>
</blockquote>
<p>I don't know what exactly was wrong with GHC 8.8.x but when I ran into the <code>readCreateProcess</code> issue and couldn't resolve it. I talked to someone on Slack iirc who mentioned successfully building ghcide and using it with stack as long as they used GHC 8.10.x -- once I used the right command to load the <code>stack810.yaml</code> file bundled with ghcide and tweaked a few things it worked.</p>
<p>It turns out that</p>
<div class="codehilite"><pre><span></span><code>package:
- .
</code></pre></div>


<p>no longer parses and I had to add a recent version of <code>Cabal</code>, the same one used in the ghcide stack config to my own project.</p>
<p>After that it build and runs perfectly. <span aria-label="+1" class="emoji emoji-1f44d" role="img" title="+1">:+1:</span></p></div></div></div></div></div><div class="ui vertical footer segment"><a href="https://github.com/srid/zulip-archive">Powered by Haskell</a> | Questions? Contact <a href="https://www.srid.ca">srid</a></div></div></body></html>