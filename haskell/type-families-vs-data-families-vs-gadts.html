<html lang="en"><head><meta content="text/html; charset=utf-8" http-equiv="Content-Type"><meta content="width=device-width, initial-scale=1" name="viewport"><meta content="How can I define a type safe inductive data type like
data D 1 1 e = E e
data D (n :: Nat) (m :: Nat) e = ...



I hope you get the idea, I&#39;m not familiar with the type level machinery is this possible?" name="description"><link href="https://funprog.srid.ca/haskell/type-families-vs-data-families-vs-gadts.html" rel="canonical"><meta property="og:title" content="Type families vs data families vs GADTs - Haskell"><meta property="og:site_name" content="Functional Programming Zulip Archive"><meta property="og:type" content="article"><meta property="og:article:section" content="Haskell"><meta property="og:article:modified_time" content="2019-11-26T11:26:24Z"><meta property="og:article:published_time" content="2019-11-24T14:15:03Z"><meta property="og:image" content="https://zulip-avatars.s3.amazonaws.com/13896/068f19d948936a41dcd13e340bacb9344e28944c?x=x&amp;version=2"><title>Type families vs data families vs GADTs - Haskell</title><style type="text/css">
div#thesite
{
  font-family   : "Open Sans", sans-serif;
  font-size     : 1em !important;
  margin-top    : 1em;
  margin-bottom : 1em;
}

div#thesite h1
{
  font-family : "Roboto", sans-serif;
  line-height : 1.19999em;
}

div#thesite h2
{
  font-family : "Roboto", sans-serif;
  line-height : 1.19999em;
}

div#thesite h3
{
  font-family : "Roboto", sans-serif;
  line-height : 1.19999em;
}

div#thesite h4
{
  font-family : "Roboto", sans-serif;
  line-height : 1.19999em;
}

div#thesite h5
{
  font-family : "Roboto", sans-serif;
  line-height : 1.19999em;
}

div#thesite h6
{
  font-family : "Roboto", sans-serif;
  line-height : 1.19999em;
}

div#thesite .ui.breadcrumb.rib .section
{
  font-family : "Roboto", sans-serif;
  line-height : 1.19999em;
}

div#thesite .header
{
  font-family : "Roboto", sans-serif;
  line-height : 1.19999em;
}

div#thesite .as-header
{
  font-family : "Roboto", sans-serif;
  line-height : 1.19999em;
}

div#thesite code, pre, tt
{
  font-family : "SFMono-Regular","Menlo","Monaco","Consolas","Liberation Mono","Courier New", monospace;
}

div#thesite .ui.breadcrumb.rib
{
  margin-bottom : 1em;
}



div#thesite .ui.comments.messages .comment .metadata a
{
  color : #808080;
}

div#thesite .ui.comments.messages .comment a.avatar img
{
  height : auto;
}

div#thesite .subtle
{
  color : #808080;
}


div#thesite .messages pre
{
  font-size : 85%;
  overflow  : auto;
  max-width : 100%;
}

div#thesite .messages .message_embed
{
  border-left  : solid 3px #808080;
  padding-left : 0.69999em;
}

div#thesite .messages .message_inline_image img
{
  max-width     : 100%;
  margin-bottom : 1em;
}


/* Generated with Clay, http://fvisser.nl/clay */</style><link href="https://cdnjs.cloudflare.com/ajax/libs/semantic-ui/2.4.1/semantic.min.css" rel="stylesheet"><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css" rel="stylesheet"><link href="https://fonts.googleapis.com/css?family=Open+Sans|Oswald&amp;display=swap" rel="stylesheet"><link href="https://fonts.googleapis.com/css?family=Roboto|Open+Sans&amp;display=swap" rel="stylesheet"></head><body><div id="thesite" class="ui text container"><div class="ui violet inverted top attached center aligned segment"><h1 class="ui huge header">Type families vs data families vs GADTs - Haskell</h1></div><div class="ui attached segment"><div class="ui message"><p>Welcome to the Functional Programming Zulip Chat Archive. You can join the chat <a href="https://funprog.zulipchat.com">here</a>.</p></div><div class="ui breadcrumb rib"><a href="/" class="section">Home</a><i class="right angle icon divider"></i><a href="/haskell/" class="section">#Haskell</a><i class="right angle icon divider"></i><div class="active section">Type families vs data families vs GADTs</div></div><div class="ui comments messages"><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/068f19d948936a41dcd13e340bacb9344e28944c?x=x&amp;version=2"></a><div class="content"><a class="author">Bolt</a><div class="metadata"><a href="#181762621" name="181762621"><div>2019-11-24 14:15:03</div></a></div><div class="text"><p>How can I define a type safe inductive data type like</p>
<div class="codehilite"><pre><span></span><span class="kr">data</span> <span class="kt">D</span> <span class="mi">1</span> <span class="mi">1</span> <span class="n">e</span> <span class="ow">=</span> <span class="kt">E</span> <span class="n">e</span>
<span class="kr">data</span> <span class="kt">D</span> <span class="p">(</span><span class="n">n</span> <span class="ow">::</span> <span class="kt">Nat</span><span class="p">)</span> <span class="p">(</span><span class="n">m</span> <span class="ow">::</span> <span class="kt">Nat</span><span class="p">)</span> <span class="n">e</span> <span class="ow">=</span> <span class="o">...</span>
</pre></div>


<p>I hope you get the idea, I'm not familiar with the type level machinery is this possible?</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/20a04d823b7c3891d78ca5f6a188ccd0e4fc5e3d?x=x&amp;version=2"></a><div class="content"><a class="author">TheMatten</a><div class="metadata"><a href="#181762913" name="181762913"><div>2019-11-24 14:25:59</div></a></div><div class="text"><p><span class="user-mention" data-user-id="250742">@Bolt</span> If you want to be able to pattern match on type with any arguments and want type to be at least partially inferable from data constructors, you can use <code>GADTs</code>:</p>
<div class="codehilite"><pre><span></span><span class="kr">data</span> <span class="kt">D</span> <span class="ow">::</span> <span class="kt">Nat</span> <span class="ow">-&gt;</span> <span class="kt">Nat</span> <span class="ow">-&gt;</span> <span class="kt">Type</span> <span class="kr">where</span>
  <span class="kt">E</span> <span class="ow">::</span> <span class="n">e</span> <span class="ow">-&gt;</span> <span class="kt">D</span> <span class="mi">1</span> <span class="mi">1</span> <span class="n">e</span>
  <span class="o">...</span>
</pre></div>


<p>for extensible type you can use data families:</p>
<div class="codehilite"><pre><span></span><span class="kr">data</span> <span class="kr">family</span> <span class="kt">D</span> <span class="ow">::</span> <span class="kt">Nat</span> <span class="ow">-&gt;</span> <span class="kt">Nat</span> <span class="ow">-&gt;</span> <span class="kt">Type</span>
<span class="kr">data</span> <span class="kr">instance</span> <span class="kt">D</span> <span class="mi">1</span> <span class="mi">1</span> <span class="n">e</span> <span class="ow">=</span> <span class="kt">E</span> <span class="n">e</span>
<span class="kr">data</span> <span class="kr">instance</span> <span class="kt">D</span> <span class="n">n</span> <span class="n">m</span> <span class="n">e</span> <span class="ow">=</span> <span class="o">...</span>
</pre></div></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/068f19d948936a41dcd13e340bacb9344e28944c?x=x&amp;version=2"></a><div class="content"><a class="author">Bolt</a><div class="metadata"><a href="#181763020" name="181763020"><div>2019-11-24 14:28:44</div></a></div><div class="text"><p>I think type families are what I want! Because in the inductive case I don't want something different than <code>E e</code></p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/20a04d823b7c3891d78ca5f6a188ccd0e4fc5e3d?x=x&amp;version=2"></a><div class="content"><a class="author">TheMatten</a><div class="metadata"><a href="#181763068" name="181763068"><div>2019-11-24 14:30:02</div></a></div><div class="text"><p><span class="user-mention" data-user-id="250742">@Bolt</span> maybe describing what's your final goal could be helpful <span aria-label="slight smile" class="emoji emoji-1f642" role="img" title="slight smile">:slight_smile:</span></p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/068f19d948936a41dcd13e340bacb9344e28944c?x=x&amp;version=2"></a><div class="content"><a class="author">Bolt</a><div class="metadata"><a href="#181763218" name="181763218"><div>2019-11-24 14:34:43</div></a></div><div class="text"><p>Something like this:</p>
<div class="codehilite"><pre><span></span><span class="kr">data</span> <span class="kt">D</span> <span class="mi">1</span> <span class="mi">1</span> <span class="n">e</span> <span class="ow">=</span> <span class="kt">E</span> <span class="n">e</span>
<span class="kr">data</span> <span class="kt">D</span> <span class="p">(</span><span class="n">n</span> <span class="ow">::</span> <span class="kt">Nat</span><span class="p">)</span> <span class="p">(</span><span class="n">m</span> <span class="ow">::</span> <span class="kt">Nat</span><span class="p">)</span> <span class="n">e</span> <span class="ow">=</span> <span class="kt">D</span> <span class="p">(</span><span class="kt">B</span> <span class="n">n</span> <span class="n">m</span> <span class="n">e</span><span class="p">)</span>

<span class="kr">data</span> <span class="kt">B</span> <span class="p">(</span><span class="n">n</span> <span class="ow">::</span> <span class="kt">Nat</span><span class="p">)</span> <span class="p">(</span><span class="n">m</span> <span class="ow">::</span> <span class="kt">Nat</span><span class="p">)</span> <span class="n">e</span> <span class="ow">=</span> <span class="kt">S</span> <span class="p">(</span><span class="kt">D</span> <span class="p">(</span><span class="n">n</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span> <span class="n">m</span> <span class="n">e</span><span class="p">)</span> <span class="o">|</span> <span class="kt">J</span> <span class="p">(</span><span class="kt">D</span> <span class="n">n</span> <span class="p">(</span><span class="n">m</span><span class="o">/</span><span class="mi">2</span><span class="p">))</span>
</pre></div>


<p>Where <code>n/2</code> would be some kind of operation on the kind Nat that divides the number by two!</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/20a04d823b7c3891d78ca5f6a188ccd0e4fc5e3d?x=x&amp;version=2"></a><div class="content"><a class="author">TheMatten</a><div class="metadata"><a href="#181763286" name="181763286"><div>2019-11-24 14:36:49</div></a></div><div class="text"><p>Problem is that division on <code>Nat</code>s would be partial</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/068f19d948936a41dcd13e340bacb9344e28944c?x=x&amp;version=2"></a><div class="content"><a class="author">Bolt</a><div class="metadata"><a href="#181763285" name="181763285"><div>2019-11-24 14:36:49</div></a></div><div class="text"><p>Type families allow me to do this ?</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/068f19d948936a41dcd13e340bacb9344e28944c?x=x&amp;version=2"></a><div class="content"><a class="author">Bolt</a><div class="metadata"><a href="#181763297" name="181763297"><div>2019-11-24 14:37:32</div></a></div><div class="text"><p>It's fine to define something that truncates at 0</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/068f19d948936a41dcd13e340bacb9344e28944c?x=x&amp;version=2"></a><div class="content"><a class="author">Bolt</a><div class="metadata"><a href="#181763343" name="181763343"><div>2019-11-24 14:38:56</div></a></div><div class="text"><p>and it's also fine to it to floor/ceil the result</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/20a04d823b7c3891d78ca5f6a188ccd0e4fc5e3d?x=x&amp;version=2"></a><div class="content"><a class="author">TheMatten</a><div class="metadata"><a href="#181763472" name="181763472"><div>2019-11-24 14:43:47</div></a></div><div class="text"><p>Okay, let's assume we have integer division - because you surely don't want to ever map <code>D 1 1</code> to <code>D</code> data constructor, you want to use closed type family:</p>
<div class="codehilite"><pre><span></span><span class="kr">newtype</span> <span class="kt">E</span> <span class="n">e</span> <span class="ow">=</span> <span class="kt">E</span> <span class="n">e</span>
<span class="kr">data</span>    <span class="kt">B</span> <span class="p">(</span><span class="n">n</span> <span class="ow">::</span> <span class="kt">Nat</span><span class="p">)</span> <span class="p">(</span><span class="n">m</span> <span class="ow">::</span> <span class="kt">Nat</span><span class="p">)</span> <span class="n">e</span> <span class="ow">=</span> <span class="kt">S</span> <span class="p">(</span><span class="kt">D</span> <span class="p">(</span><span class="n">n</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="n">m</span> <span class="n">e</span><span class="p">)</span> <span class="o">|</span> <span class="kt">J</span> <span class="p">(</span><span class="kt">D</span> <span class="n">n</span> <span class="p">(</span><span class="n">m</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="n">e</span><span class="p">)</span>

<span class="c1">-- This seems to be injective, let&#39;s try putting annotation here</span>
<span class="kr">type</span> <span class="kr">family</span> <span class="kt">D</span> <span class="p">(</span><span class="n">n</span> <span class="ow">::</span> <span class="kt">Nat</span><span class="p">)</span> <span class="p">(</span><span class="n">m</span> <span class="ow">::</span> <span class="kt">Nat</span><span class="p">)</span> <span class="n">e</span> <span class="ow">=</span> <span class="n">r</span> <span class="o">|</span> <span class="n">r</span> <span class="ow">-&gt;</span> <span class="n">n</span> <span class="n">m</span> <span class="kr">where</span>
  <span class="kt">D</span> <span class="mi">1</span> <span class="mi">1</span> <span class="n">e</span> <span class="ow">=</span> <span class="kt">E</span> <span class="n">e</span>
  <span class="kt">D</span> <span class="n">n</span> <span class="n">m</span> <span class="n">e</span> <span class="ow">=</span> <span class="kt">B</span> <span class="n">n</span> <span class="n">m</span> <span class="n">e</span>
</pre></div></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/068f19d948936a41dcd13e340bacb9344e28944c?x=x&amp;version=2"></a><div class="content"><a class="author">Bolt</a><div class="metadata"><a href="#181763673" name="181763673"><div>2019-11-24 14:49:44</div></a></div><div class="text"><p>Can you please explain me what is a closed type family and the reason of the comment and the <code>r -&gt; n m </code> bit?</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/068f19d948936a41dcd13e340bacb9344e28944c?x=x&amp;version=2"></a><div class="content"><a class="author">Bolt</a><div class="metadata"><a href="#181763677" name="181763677"><div>2019-11-24 14:49:59</div></a></div><div class="text"><p>what annotation are you referring to?</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/20a04d823b7c3891d78ca5f6a188ccd0e4fc5e3d?x=x&amp;version=2"></a><div class="content"><a class="author">TheMatten</a><div class="metadata"><a href="#181763780" name="181763780"><div>2019-11-24 14:52:09</div></a></div><div class="text"><p>Ah, sorry <span aria-label="sweat smile" class="emoji emoji-1f605" role="img" title="sweat smile">:sweat_smile:</span>:<br>
- closed type family cannot be extended, but it's cases are matched in order - on the other hand, open type families:</p>
<div class="codehilite"><pre><span></span><span class="kr">type</span> <span class="kr">family</span> <span class="kt">D</span> <span class="n">n</span> <span class="n">m</span> <span class="n">e</span>

<span class="kr">type</span> <span class="kr">instance</span> <span class="kt">D</span> <span class="mi">1</span> <span class="mi">1</span> <span class="n">e</span> <span class="ow">=</span> <span class="kt">E</span> <span class="n">e</span>
<span class="kr">type</span> <span class="kr">instance</span> <span class="kt">D</span> <span class="n">n</span> <span class="n">m</span> <span class="n">e</span> <span class="ow">=</span> <span class="kt">B</span> <span class="n">n</span> <span class="n">m</span> <span class="n">e</span>
</pre></div>


<p>can be extended, but their cases can't overlap</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/20a04d823b7c3891d78ca5f6a188ccd0e4fc5e3d?x=x&amp;version=2"></a><div class="content"><a class="author">TheMatten</a><div class="metadata"><a href="#181763798" name="181763798"><div>2019-11-24 14:53:22</div></a></div><div class="text"><p><code>r -&gt; n m</code> is that annotation - it's "type family dependency" and it basically says "if I know <code>r</code>" (as in result), "I know <code>n</code> and <code>m</code> too"</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/20a04d823b7c3891d78ca5f6a188ccd0e4fc5e3d?x=x&amp;version=2"></a><div class="content"><a class="author">TheMatten</a><div class="metadata"><a href="#181763845" name="181763845"><div>2019-11-24 14:54:15</div></a></div><div class="text"><p>I put it here because it seems like I can - and because now by writing value <code>E something</code>, compiler can infer that it's type corresponds to <code>D 1 1 e</code></p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/068f19d948936a41dcd13e340bacb9344e28944c?x=x&amp;version=2"></a><div class="content"><a class="author">Bolt</a><div class="metadata"><a href="#181763863" name="181763863"><div>2019-11-24 14:55:21</div></a></div><div class="text"><p>ohh okay! thank you very much!</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/068f19d948936a41dcd13e340bacb9344e28944c?x=x&amp;version=2"></a><div class="content"><a class="author">Bolt</a><div class="metadata"><a href="#181763922" name="181763922"><div>2019-11-24 14:56:13</div></a></div><div class="text"><p>When you say that in the case of open type families the cases can't overlap what do you mean exactly?</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/068f19d948936a41dcd13e340bacb9344e28944c?x=x&amp;version=2"></a><div class="content"><a class="author">Bolt</a><div class="metadata"><a href="#181763926" name="181763926"><div>2019-11-24 14:56:30</div></a></div><div class="text"><p>can you give a concrete example? I'm having a hard time figuring out</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/068f19d948936a41dcd13e340bacb9344e28944c?x=x&amp;version=2"></a><div class="content"><a class="author">Bolt</a><div class="metadata"><a href="#181763943" name="181763943"><div>2019-11-24 14:57:51</div></a></div><div class="text"><p>Also the <code>D</code> type familie isn't a <em>type</em> is it? Can I use it to derive instances? (sorry for my newbness <span aria-label="sweat smile" class="emoji emoji-1f605" role="img" title="sweat smile">:sweat_smile:</span> )</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/20a04d823b7c3891d78ca5f6a188ccd0e4fc5e3d?x=x&amp;version=2"></a><div class="content"><a class="author">TheMatten</a><div class="metadata"><a href="#181763993" name="181763993"><div>2019-11-24 14:58:29</div></a></div><div class="text"><div class="codehilite"><pre><span></span><span class="kr">type</span> <span class="kr">family</span> <span class="kt">Example</span> <span class="n">a</span> <span class="n">b</span>

<span class="kr">type</span> <span class="kr">instance</span> <span class="kt">Example</span> <span class="kt">Int</span> <span class="n">b</span>    <span class="ow">=</span> <span class="kt">Int</span>
<span class="kr">type</span> <span class="kr">instance</span> <span class="kt">Example</span> <span class="n">a</span>   <span class="kt">Bool</span> <span class="ow">=</span> <span class="kt">Bool</span>
</pre></div>


<div class="codehilite"><pre><span></span>error:
    Conflicting family instance declarations:
      Example Int b = Int -- Defined at experiments.hs:513:15
      Example a Bool = Bool -- Defined at experiments.hs:514:15
    |
513 | type instance Example Int b    = Int
    |               ^^^^^^^
</pre></div></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/20a04d823b7c3891d78ca5f6a188ccd0e4fc5e3d?x=x&amp;version=2"></a><div class="content"><a class="author">TheMatten</a><div class="metadata"><a href="#181764000" name="181764000"><div>2019-11-24 14:58:55</div></a></div><div class="text"><p>If you say <code>Foo Int Bool</code>, which one should it choose?</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/068f19d948936a41dcd13e340bacb9344e28944c?x=x&amp;version=2"></a><div class="content"><a class="author">Bolt</a><div class="metadata"><a href="#181764019" name="181764019"><div>2019-11-24 14:59:43</div></a></div><div class="text"><p>ohh got it! thanks :D</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/20a04d823b7c3891d78ca5f6a188ccd0e4fc5e3d?x=x&amp;version=2"></a><div class="content"><a class="author">TheMatten</a><div class="metadata"><a href="#181764149" name="181764149"><div>2019-11-24 15:02:21</div></a></div><div class="text"><p><code>D n m e</code> is a type in a same way <code>head [1]</code> is a value - they're applied functions</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/20a04d823b7c3891d78ca5f6a188ccd0e4fc5e3d?x=x&amp;version=2"></a><div class="content"><a class="author">TheMatten</a><div class="metadata"><a href="#181764231" name="181764231"><div>2019-11-24 15:04:57</div></a></div><div class="text"><p>You can't derive instances on it directly - one simple reason is that we can't have type families in instance heads yet</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/20a04d823b7c3891d78ca5f6a188ccd0e4fc5e3d?x=x&amp;version=2"></a><div class="content"><a class="author">TheMatten</a><div class="metadata"><a href="#181764296" name="181764296"><div>2019-11-24 15:06:46</div></a></div><div class="text"><p>(NP, I was learning to use them at some point too <span aria-label="smiley" class="emoji emoji-1f603" role="img" title="smiley">:smiley:</span>)</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/068f19d948936a41dcd13e340bacb9344e28944c?x=x&amp;version=2"></a><div class="content"><a class="author">Bolt</a><div class="metadata"><a href="#181764298" name="181764298"><div>2019-11-24 15:06:56</div></a></div><div class="text"><p>okay so I have to play with <code>E</code> and <code>B</code> types only</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/068f19d948936a41dcd13e340bacb9344e28944c?x=x&amp;version=2"></a><div class="content"><a class="author">Bolt</a><div class="metadata"><a href="#181764319" name="181764319"><div>2019-11-24 15:07:42</div></a></div><div class="text"><p>so, now to define the division I need to use a type family as well right?</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/20a04d823b7c3891d78ca5f6a188ccd0e4fc5e3d?x=x&amp;version=2"></a><div class="content"><a class="author">TheMatten</a><div class="metadata"><a href="#181764376" name="181764376"><div>2019-11-24 15:08:58</div></a></div><div class="text"><p>Yeah - you can try writing it first at value level, without using <code>case</code>, <code>if</code> or guards</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/068f19d948936a41dcd13e340bacb9344e28944c?x=x&amp;version=2"></a><div class="content"><a class="author">Bolt</a><div class="metadata"><a href="#181764396" name="181764396"><div>2019-11-24 15:09:52</div></a></div><div class="text"><p>Okay! Thanks for the tip! :D</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/068f19d948936a41dcd13e340bacb9344e28944c?x=x&amp;version=2"></a><div class="content"><a class="author">Bolt</a><div class="metadata"><a href="#181766852" name="181766852"><div>2019-11-24 16:17:18</div></a></div><div class="text"><p>How can I see the type family definition of <code>Nat</code> provided by GHC.TypeLit ? (<a href="https://hackage.haskell.org/package/base-4.12.0.0/docs/src/GHC.TypeNats.html#Div" target="_blank" title="https://hackage.haskell.org/package/base-4.12.0.0/docs/src/GHC.TypeNats.html#Div">https://hackage.haskell.org/package/base-4.12.0.0/docs/src/GHC.TypeNats.html#Div</a>)</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/068f19d948936a41dcd13e340bacb9344e28944c?x=x&amp;version=2"></a><div class="content"><a class="author">Bolt</a><div class="metadata"><a href="#181766859" name="181766859"><div>2019-11-24 16:17:38</div></a></div><div class="text"><p>Here is only declared the family</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/89529ef093c72e16a5ce3ac00d88f354ccc08cf9?x=x&amp;version=2"></a><div class="content"><a class="author">Lysxia</a><div class="metadata"><a href="#181766867" name="181766867"><div>2019-11-24 16:17:56</div></a></div><div class="text"><p>It's part of the compiler</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/89529ef093c72e16a5ce3ac00d88f354ccc08cf9?x=x&amp;version=2"></a><div class="content"><a class="author">Lysxia</a><div class="metadata"><a href="#181766911" name="181766911"><div>2019-11-24 16:18:07</div></a></div><div class="text"><p>There is no in-library definition</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/068f19d948936a41dcd13e340bacb9344e28944c?x=x&amp;version=2"></a><div class="content"><a class="author">Bolt</a><div class="metadata"><a href="#181766917" name="181766917"><div>2019-11-24 16:18:23</div></a></div><div class="text"><p>oh okay! Thanks!</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/068f19d948936a41dcd13e340bacb9344e28944c?x=x&amp;version=2"></a><div class="content"><a class="author">Bolt</a><div class="metadata"><a href="#181775456" name="181775456"><div>2019-11-24 20:07:14</div></a></div><div class="text"><p>If I have something like</p>
<div class="codehilite"><pre><span></span><span class="kr">data</span> <span class="kt">Test</span> <span class="p">(</span><span class="n">n</span> <span class="ow">::</span> <span class="kt">Nat</span><span class="p">)</span> <span class="p">(</span><span class="n">m</span> <span class="ow">::</span> <span class="kt">Nat</span><span class="p">)</span> <span class="kr">where</span>
    <span class="kt">C</span> <span class="ow">::</span> <span class="kt">Test</span> <span class="p">(</span><span class="kt">Div</span> <span class="n">n</span> <span class="mi">2</span><span class="p">)</span> <span class="n">m</span> <span class="ow">-&gt;</span> <span class="kt">Test</span> <span class="p">(</span><span class="kt">Div</span> <span class="n">n</span> <span class="mi">2</span><span class="p">)</span> <span class="n">m</span> <span class="ow">-&gt;</span> <span class="kt">Test</span> <span class="n">n</span> <span class="n">m</span>
    <span class="kt">O</span> <span class="ow">::</span> <span class="kt">Test</span> <span class="mi">1</span> <span class="mi">1</span>
</pre></div>


<p>I cannot construct something of type <code>Test 3 3</code> how can I solve this?</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/068f19d948936a41dcd13e340bacb9344e28944c?x=x&amp;version=2"></a><div class="content"><a class="author">Bolt</a><div class="metadata"><a href="#181775522" name="181775522"><div>2019-11-24 20:08:31</div></a></div><div class="text"><p>I get the following error when trying</p>
<div class="codehilite"><pre><span></span><span class="kt">Couldn&#39;t</span> <span class="n">match</span> <span class="kr">type</span> <span class="err">‘</span><span class="mi">0</span><span class="err">’</span> <span class="n">with</span> <span class="err">‘</span><span class="mi">1</span><span class="err">’</span>
      <span class="kt">Expected</span> <span class="kr">type</span><span class="kt">:</span> <span class="kt">Test</span> <span class="p">(</span><span class="kt">Div</span> <span class="mi">1</span> <span class="mi">2</span><span class="p">)</span> <span class="mi">1</span>
        <span class="kt">Actual</span> <span class="kr">type</span><span class="kt">:</span> <span class="kt">Test</span> <span class="mi">1</span> <span class="mi">1</span>
</pre></div></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/c03b8d34978563858020eff0d14cc17b?d=identicon&amp;version=1"></a><div class="content"><a class="author">Alexis King</a><div class="metadata"><a href="#181775715" name="181775715"><div>2019-11-24 20:13:19</div></a></div><div class="text"><p>What is <code>Test</code> intended to capture? Given the definition provided, <code>Test 3 3</code> doesn’t seem like it ought to be inhabited to me. It isn’t <code>O</code>, trivially, and you can’t get it from <code>C</code>, because that would require a value <code>Test (Div 3 2) 3</code>, and <code>Div 3 2</code> is bottom (since 3/2 is not a natural number). Is there a particular reason you think it ought to be inhabited (or perhaps would like it to be inhabited)?</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/068f19d948936a41dcd13e340bacb9344e28944c?x=x&amp;version=2"></a><div class="content"><a class="author">Bolt</a><div class="metadata"><a href="#181775795" name="181775795"><div>2019-11-24 20:15:47</div></a></div><div class="text"><p>I want it to be habited. I understand the reason for it not to be habited</p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/c03b8d34978563858020eff0d14cc17b?d=identicon&amp;version=1"></a><div class="content"><a class="author">Alexis King</a><div class="metadata"><a href="#181775845" name="181775845"><div>2019-11-24 20:16:39</div></a></div><div class="text"><p>Oh, I see—<code>Div 3 2</code> <em>is</em> defined, my bad. It just rounds down to <code>1</code>. But then you would need a value of type <code>Test 1 3</code>, at which point you would need a value of type <code>Test (Div 1 2) 3</code> to get it, and <code>Div 1 2</code> is <code>0</code>, so then you need a value of type <code>Div 0 3</code>… and so on. It will never be inhabited because <code>m</code> is always <code>3</code>, and the only base case for <code>Test</code> pins <code>m</code> to be <code>1</code>.</p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/c03b8d34978563858020eff0d14cc17b?d=identicon&amp;version=1"></a><div class="content"><a class="author">Alexis King</a><div class="metadata"><a href="#181775856" name="181775856"><div>2019-11-24 20:17:05</div></a></div><div class="text"><p>What does a value of type <code>Test n m</code> mean/why would you like <code>Test 3 3</code> to be inhabited?</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/068f19d948936a41dcd13e340bacb9344e28944c?x=x&amp;version=2"></a><div class="content"><a class="author">Bolt</a><div class="metadata"><a href="#181775870" name="181775870"><div>2019-11-24 20:17:54</div></a></div><div class="text"><p>Just a brain teaser</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/068f19d948936a41dcd13e340bacb9344e28944c?x=x&amp;version=2"></a><div class="content"><a class="author">Bolt</a><div class="metadata"><a href="#181775912" name="181775912"><div>2019-11-24 20:18:07</div></a></div><div class="text"><p>I feel like it is possible but I dont know how to do it!</p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/c03b8d34978563858020eff0d14cc17b?d=identicon&amp;version=1"></a><div class="content"><a class="author">Alexis King</a><div class="metadata"><a href="#181775923" name="181775923"><div>2019-11-24 20:18:31</div></a></div><div class="text"><p>Well, I ask because it is trivial to make <code>Test 3 3</code> be inhabited by adding a case to <code>Test</code> that is <code>A :: Test 3 3</code>, but presumably you do not want that solution. :)</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/068f19d948936a41dcd13e340bacb9344e28944c?x=x&amp;version=2"></a><div class="content"><a class="author">Bolt</a><div class="metadata"><a href="#181775947" name="181775947"><div>2019-11-24 20:19:45</div></a></div><div class="text"><p>I want to be able to have a value that is of type <code>T 3 m</code> for example</p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/c03b8d34978563858020eff0d14cc17b?d=identicon&amp;version=1"></a><div class="content"><a class="author">Alexis King</a><div class="metadata"><a href="#181776015" name="181776015"><div>2019-11-24 20:20:54</div></a></div><div class="text"><p>Do you follow my above reasoning as to why, given that definition of <code>Test</code>, <code>Test n m</code> can only be inhabited when <code>m</code> is <code>1</code>?</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/068f19d948936a41dcd13e340bacb9344e28944c?x=x&amp;version=2"></a><div class="content"><a class="author">Bolt</a><div class="metadata"><a href="#181776075" name="181776075"><div>2019-11-24 20:22:07</div></a></div><div class="text"><p>yes, but how can I change the definition of <code>Test</code> to be able to have what I want?</p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/c03b8d34978563858020eff0d14cc17b?d=identicon&amp;version=1"></a><div class="content"><a class="author">Alexis King</a><div class="metadata"><a href="#181776148" name="181776148"><div>2019-11-24 20:24:03</div></a></div><div class="text"><p>Well, I’m still not quite sure I understand what you want, I guess. If you want <code>Test 3 m</code> to be inhabited, for all <code>m</code>, you could just add another case to <code>Test</code> with type <code>Test 3 m</code>, like this:</p>
<div class="codehilite"><pre><span></span><span class="kr">data</span> <span class="kt">Test</span> <span class="p">(</span><span class="n">n</span> <span class="ow">::</span> <span class="kt">Nat</span><span class="p">)</span> <span class="p">(</span><span class="n">m</span> <span class="ow">::</span> <span class="kt">Nat</span><span class="p">)</span> <span class="kr">where</span>
    <span class="kt">C</span> <span class="ow">::</span> <span class="kt">Test</span> <span class="p">(</span><span class="kt">Div</span> <span class="n">n</span> <span class="mi">2</span><span class="p">)</span> <span class="n">m</span> <span class="ow">-&gt;</span> <span class="kt">Test</span> <span class="p">(</span><span class="kt">Div</span> <span class="n">n</span> <span class="mi">2</span><span class="p">)</span> <span class="n">m</span> <span class="ow">-&gt;</span> <span class="kt">Test</span> <span class="n">n</span> <span class="n">m</span>
    <span class="kt">O</span> <span class="ow">::</span> <span class="kt">Test</span> <span class="mi">1</span> <span class="mi">1</span>
    <span class="kt">A</span> <span class="ow">::</span> <span class="kt">Test</span> <span class="mi">3</span> <span class="n">m</span>
</pre></div></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/068f19d948936a41dcd13e340bacb9344e28944c?x=x&amp;version=2"></a><div class="content"><a class="author">Bolt</a><div class="metadata"><a href="#181777102" name="181777102"><div>2019-11-24 20:46:21</div></a></div><div class="text"><p>I want to be able to construct any T for which 'n' is Odd</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/20a04d823b7c3891d78ca5f6a188ccd0e4fc5e3d?x=x&amp;version=2"></a><div class="content"><a class="author">TheMatten</a><div class="metadata"><a href="#181777212" name="181777212"><div>2019-11-24 20:49:33</div></a></div><div class="text"><p><span class="user-mention" data-user-id="250742">@Bolt</span></p>
<div class="codehilite"><pre><span></span><span class="kr">data</span> <span class="kt">T</span> <span class="n">n</span> <span class="n">m</span> <span class="kr">where</span>
  <span class="kt">C</span> <span class="ow">::</span> <span class="kt">Odd</span> <span class="n">n</span> <span class="ow">=&gt;</span> <span class="kt">T</span> <span class="n">n</span> <span class="n">m</span>
</pre></div>


<p>Where <code>Odd</code> is a typeclass or a synonym for some type family equality</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/068f19d948936a41dcd13e340bacb9344e28944c?x=x&amp;version=2"></a><div class="content"><a class="author">Bolt</a><div class="metadata"><a href="#181777278" name="181777278"><div>2019-11-24 20:50:59</div></a></div><div class="text"><p>So obvious!</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/068f19d948936a41dcd13e340bacb9344e28944c?x=x&amp;version=2"></a><div class="content"><a class="author">Bolt</a><div class="metadata"><a href="#181777288" name="181777288"><div>2019-11-24 20:51:15</div></a></div><div class="text"><p>Can I have some kind of overlapping?</p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/c03b8d34978563858020eff0d14cc17b?d=identicon&amp;version=1"></a><div class="content"><a class="author">Alexis King</a><div class="metadata"><a href="#181777308" name="181777308"><div>2019-11-24 20:51:53</div></a></div><div class="text"><p>I’d do it this way:</p>
<div class="codehilite"><pre><span></span><span class="kr">data</span> <span class="kt">T</span> <span class="n">n</span> <span class="kr">where</span>
  <span class="kt">One</span> <span class="ow">::</span> <span class="kt">T</span> <span class="mi">1</span>
  <span class="kt">Next</span> <span class="ow">::</span> <span class="kt">T</span> <span class="n">n</span> <span class="ow">-&gt;</span> <span class="kt">T</span> <span class="p">(</span><span class="n">n</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span>
</pre></div></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/068f19d948936a41dcd13e340bacb9344e28944c?x=x&amp;version=2"></a><div class="content"><a class="author">Bolt</a><div class="metadata"><a href="#181777352" name="181777352"><div>2019-11-24 20:52:04</div></a></div><div class="text"><p>Like</p>
<div class="codehilite"><pre><span></span><span class="kr">data</span> <span class="kt">T</span> <span class="n">n</span> <span class="n">m</span> <span class="kr">where</span>
  <span class="kt">C</span> <span class="ow">::</span> <span class="kt">Odd</span> <span class="n">n</span> <span class="ow">=&gt;</span> <span class="kt">T</span> <span class="n">n</span> <span class="n">m</span>
  <span class="kt">C</span> <span class="ow">::</span> <span class="kt">Even</span> <span class="n">n</span> <span class="ow">=&gt;</span> <span class="o">...</span>
</pre></div></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/20a04d823b7c3891d78ca5f6a188ccd0e4fc5e3d?x=x&amp;version=2"></a><div class="content"><a class="author">TheMatten</a><div class="metadata"><a href="#181777359" name="181777359"><div>2019-11-24 20:52:18</div></a></div><div class="text"><p><span class="user-mention" data-user-id="251362">@Alexis King</span> Probably depends on usecase</p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/c03b8d34978563858020eff0d14cc17b?d=identicon&amp;version=1"></a><div class="content"><a class="author">Alexis King</a><div class="metadata"><a href="#181777364" name="181777364"><div>2019-11-24 20:52:45</div></a></div><div class="text"><p>Yes, agreed. In a dependently typed language the tradeoffs would be different.</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/068f19d948936a41dcd13e340bacb9344e28944c?x=x&amp;version=2"></a><div class="content"><a class="author">Bolt</a><div class="metadata"><a href="#181777365" name="181777365"><div>2019-11-24 20:52:46</div></a></div><div class="text"><p>I'll try all of your suggestions!</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/068f19d948936a41dcd13e340bacb9344e28944c?x=x&amp;version=2"></a><div class="content"><a class="author">Bolt</a><div class="metadata"><a href="#181777425" name="181777425"><div>2019-11-24 20:54:20</div></a></div><div class="text"><p>Thanks for the help, I feel like I'm learning to program for the first time ahaha</p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/3d24a4100b3eab34d8ce3059d789c543?d=identicon&amp;version=1"></a><div class="content"><a class="author">Sandy Maguire</a><div class="metadata"><a href="#181798027" name="181798027"><div>2019-11-25 07:25:03</div></a></div><div class="text"><p>For things like this, GADTs are more often what you want than data families</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/068f19d948936a41dcd13e340bacb9344e28944c?x=x&amp;version=2"></a><div class="content"><a class="author">Bolt</a><div class="metadata"><a href="#181807704" name="181807704"><div>2019-11-25 10:14:51</div></a></div><div class="text"><p>I went with GADTs and am having this error</p>
<div class="codehilite"><pre><span></span><span class="kt">Couldn&#39;t</span> <span class="n">match</span> <span class="kr">type</span> <span class="err">‘</span><span class="n">n</span><span class="err">’</span> <span class="n">with</span> <span class="err">‘</span><span class="mi">1</span><span class="err">’</span>
      <span class="err">‘</span><span class="n">n</span><span class="err">’</span> <span class="n">is</span> <span class="n">a</span> <span class="n">rigid</span> <span class="kr">type</span> <span class="n">variable</span> <span class="n">bound</span> <span class="n">by</span>
        <span class="n">the</span> <span class="kr">type</span> <span class="n">signature</span> <span class="n">for</span><span class="kt">:</span>
          <span class="n">g</span> <span class="ow">::</span> <span class="n">forall</span> <span class="p">(</span><span class="n">n</span> <span class="ow">::</span> <span class="kt">Nat</span><span class="p">)</span> <span class="p">(</span><span class="n">m</span> <span class="ow">::</span> <span class="kt">Nat</span><span class="p">)</span><span class="o">.</span>
               <span class="kt">Integer</span> <span class="ow">-&gt;</span> <span class="kt">Integer</span> <span class="ow">-&gt;</span> <span class="kt">T</span> <span class="n">n</span> <span class="n">m</span>
        <span class="n">at</span> <span class="o">&lt;</span><span class="n">interactive</span><span class="o">&gt;:</span><span class="mi">2</span><span class="kt">:</span><span class="mi">1</span><span class="o">-</span><span class="mi">39</span>
      <span class="kt">Expected</span> <span class="kr">type</span><span class="kt">:</span> <span class="kt">T</span> <span class="n">n</span> <span class="n">m</span>
        <span class="kt">Actual</span> <span class="kr">type</span><span class="kt">:</span> <span class="kt">T</span> <span class="mi">1</span> <span class="mi">1</span>
</pre></div>


<p>I'm trying to write a recursive function that in the base case returns something of type <code>T 1 1</code></p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/20a04d823b7c3891d78ca5f6a188ccd0e4fc5e3d?x=x&amp;version=2"></a><div class="content"><a class="author">TheMatten</a><div class="metadata"><a href="#181807897" name="181807897"><div>2019-11-25 10:18:59</div></a></div><div class="text"><p><span class="user-mention" data-user-id="250742">@Bolt</span> Look at it this way - return type of <code>g</code> is <code>T n m</code>, where I as a caller should be able to choose <code>n</code> and <code>m</code>, but you're trying to return <code>T 1 1</code> specifically in that case</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/068f19d948936a41dcd13e340bacb9344e28944c?x=x&amp;version=2"></a><div class="content"><a class="author">Bolt</a><div class="metadata"><a href="#181807935" name="181807935"><div>2019-11-25 10:19:51</div></a></div><div class="text"><p>But why can't <code>T 1 1</code>  be inferred as <code>T n m</code>? <span aria-label="confused" class="emoji emoji-1f615" role="img" title="confused">:confused:</span> Is there any way to achieve this?</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/20a04d823b7c3891d78ca5f6a188ccd0e4fc5e3d?x=x&amp;version=2"></a><div class="content"><a class="author">TheMatten</a><div class="metadata"><a href="#181808005" name="181808005"><div>2019-11-25 10:20:43</div></a></div><div class="text"><p>You want some existential wrapper or CPS probably:</p>
<div class="codehilite"><pre><span></span><span class="kr">data</span> <span class="kt">SomeT</span> <span class="ow">=</span> <span class="n">forall</span> <span class="n">n</span> <span class="n">m</span><span class="o">.</span> <span class="kt">SomeT</span> <span class="p">(</span><span class="kt">T</span> <span class="n">n</span> <span class="n">m</span><span class="p">)</span>
</pre></div>


<div class="codehilite"><pre><span></span><span class="nf">g</span> <span class="ow">::</span> <span class="kt">Integer</span> <span class="ow">-&gt;</span> <span class="kt">Integer</span> <span class="ow">-&gt;</span> <span class="p">(</span><span class="n">forall</span> <span class="n">n</span> <span class="n">m</span><span class="o">.</span> <span class="kt">T</span> <span class="n">n</span> <span class="n">m</span> <span class="ow">-&gt;</span> <span class="n">r</span><span class="p">)</span> <span class="ow">-&gt;</span> <span class="n">r</span>
</pre></div></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/20a04d823b7c3891d78ca5f6a188ccd0e4fc5e3d?x=x&amp;version=2"></a><div class="content"><a class="author">TheMatten</a><div class="metadata"><a href="#181808103" name="181808103"><div>2019-11-25 10:22:05</div></a></div><div class="text"><p>I still wonder whether it would be sound to have some "unguarded" existential quantifier in Haskell - <code>forsome n m. T n m</code></p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/068f19d948936a41dcd13e340bacb9344e28944c?x=x&amp;version=2"></a><div class="content"><a class="author">Bolt</a><div class="metadata"><a href="#181808144" name="181808144"><div>2019-11-25 10:22:56</div></a></div><div class="text"><p>Can I do that with my existent GADT?</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/20a04d823b7c3891d78ca5f6a188ccd0e4fc5e3d?x=x&amp;version=2"></a><div class="content"><a class="author">TheMatten</a><div class="metadata"><a href="#181808157" name="181808157"><div>2019-11-25 10:23:11</div></a></div><div class="text"><p>What exactly?</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/068f19d948936a41dcd13e340bacb9344e28944c?x=x&amp;version=2"></a><div class="content"><a class="author">Bolt</a><div class="metadata"><a href="#181808263" name="181808263"><div>2019-11-25 10:24:47</div></a></div><div class="text"><p>Getting things to compile</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/068f19d948936a41dcd13e340bacb9344e28944c?x=x&amp;version=2"></a><div class="content"><a class="author">Bolt</a><div class="metadata"><a href="#181808280" name="181808280"><div>2019-11-25 10:25:03</div></a></div><div class="text"><p>I'm going with a type family approach mixed with GADTs now and test it</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/20a04d823b7c3891d78ca5f6a188ccd0e4fc5e3d?x=x&amp;version=2"></a><div class="content"><a class="author">TheMatten</a><div class="metadata"><a href="#181808338" name="181808338"><div>2019-11-25 10:25:51</div></a></div><div class="text"><p>Do that CPS style as above for example - take continuation and pass resulting <code>T</code> into it</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/068f19d948936a41dcd13e340bacb9344e28944c?x=x&amp;version=2"></a><div class="content"><a class="author">Bolt</a><div class="metadata"><a href="#181809024" name="181809024"><div>2019-11-25 10:35:51</div></a></div><div class="text"><p>How can I group a bunch of constraints into one?</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/20a04d823b7c3891d78ca5f6a188ccd0e4fc5e3d?x=x&amp;version=2"></a><div class="content"><a class="author">TheMatten</a><div class="metadata"><a href="#181809095" name="181809095"><div>2019-11-25 10:36:42</div></a></div><div class="text"><p><span class="user-mention" data-user-id="250742">@Bolt</span> <code>(,)</code></p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/068f19d948936a41dcd13e340bacb9344e28944c?x=x&amp;version=2"></a><div class="content"><a class="author">Bolt</a><div class="metadata"><a href="#181809132" name="181809132"><div>2019-11-25 10:37:32</div></a></div><div class="text"><p>I know but how to wrap them on a single name like <code>Myconstraint = (a,b,c)</code> and then I can use it <code>g :: Myconstraint =&gt; ...</code></p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/068f19d948936a41dcd13e340bacb9344e28944c?x=x&amp;version=2"></a><div class="content"><a class="author">Bolt</a><div class="metadata"><a href="#181809141" name="181809141"><div>2019-11-25 10:37:44</div></a></div><div class="text"><p>is that possible?</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/20a04d823b7c3891d78ca5f6a188ccd0e4fc5e3d?x=x&amp;version=2"></a><div class="content"><a class="author">TheMatten</a><div class="metadata"><a href="#181809225" name="181809225"><div>2019-11-25 10:38:51</div></a></div><div class="text"><p>Two ways:<br>
- type synonym <code>type Foo = (Bar, Baz)</code><br>
- class synonym <code>class (Bar, Baz) =&gt; Foo; instance (Bar, Baz) =&gt; Foo</code><br>
second option has advantage of being partially applicable if it has arguments</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/068f19d948936a41dcd13e340bacb9344e28944c?x=x&amp;version=2"></a><div class="content"><a class="author">Bolt</a><div class="metadata"><a href="#181809254" name="181809254"><div>2019-11-25 10:39:19</div></a></div><div class="text"><p>okay, cool! Thanks!</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/20a04d823b7c3891d78ca5f6a188ccd0e4fc5e3d?x=x&amp;version=2"></a><div class="content"><a class="author">TheMatten</a><div class="metadata"><a href="#181809255" name="181809255"><div>2019-11-25 10:39:20</div></a></div><div class="text"><p>(You need <code>ConstraintKinds</code> for first one BTW)</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/068f19d948936a41dcd13e340bacb9344e28944c?x=x&amp;version=2"></a><div class="content"><a class="author">Bolt</a><div class="metadata"><a href="#181811175" name="181811175"><div>2019-11-25 11:07:55</div></a></div><div class="text"><div class="codehilite"><pre><span></span><span class="kt">Couldn&#39;t</span> <span class="n">match</span> <span class="kr">type</span> <span class="err">‘</span><span class="kt">T</span> <span class="n">n1</span> <span class="n">m1</span><span class="err">’</span> <span class="n">with</span> <span class="err">‘</span><span class="kt">T</span> <span class="n">n</span> <span class="n">m</span><span class="err">’</span>
  <span class="kt">Expected</span> <span class="kr">type</span><span class="kt">:</span> <span class="kt">T</span> <span class="n">n1</span> <span class="n">m1</span> <span class="ow">-&gt;</span> <span class="kt">T</span> <span class="n">n</span> <span class="n">m</span>
    <span class="kt">Actual</span> <span class="kr">type</span><span class="kt">:</span> <span class="kt">T</span> <span class="n">n</span> <span class="n">m</span> <span class="ow">-&gt;</span> <span class="kt">T</span> <span class="n">n</span> <span class="n">m</span>
  <span class="kt">NB:</span> <span class="err">‘</span><span class="kt">T</span><span class="err">’</span> <span class="n">is</span> <span class="n">a</span> <span class="n">non</span><span class="o">-</span><span class="n">injective</span> <span class="kr">type</span> <span class="kr">family</span>
</pre></div></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/068f19d948936a41dcd13e340bacb9344e28944c?x=x&amp;version=2"></a><div class="content"><a class="author">Bolt</a><div class="metadata"><a href="#181811217" name="181811217"><div>2019-11-25 11:08:03</div></a></div><div class="text"><p>D:</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/20a04d823b7c3891d78ca5f6a188ccd0e4fc5e3d?x=x&amp;version=2"></a><div class="content"><a class="author">TheMatten</a><div class="metadata"><a href="#181811238" name="181811238"><div>2019-11-25 11:09:01</div></a></div><div class="text"><p><span class="user-mention" data-user-id="250742">@Bolt</span> What's the code?</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/068f19d948936a41dcd13e340bacb9344e28944c?x=x&amp;version=2"></a><div class="content"><a class="author">Bolt</a><div class="metadata"><a href="#181811358" name="181811358"><div>2019-11-25 11:10:47</div></a></div><div class="text"><div class="codehilite"><pre><span></span><span class="nf">el</span> <span class="ow">::</span> <span class="n">e</span> <span class="ow">-&gt;</span> <span class="kt">T</span> <span class="mi">1</span> <span class="mi">1</span>
<span class="nf">el</span> <span class="ow">=</span> <span class="kt">E</span>

<span class="nf">zeros</span> <span class="ow">::</span> <span class="n">forall</span> <span class="n">e</span> <span class="n">n</span> <span class="n">m</span> <span class="o">.</span> <span class="p">(</span><span class="kt">Zero</span> <span class="n">e</span><span class="p">,</span> <span class="kt">KnownDimensions</span> <span class="n">n</span> <span class="n">m</span><span class="p">)</span> <span class="ow">=&gt;</span> <span class="kt">T</span> <span class="n">n</span> <span class="n">m</span>
<span class="nf">zeros</span> <span class="ow">=</span> <span class="kr">let</span> <span class="n">c</span> <span class="ow">=</span> <span class="n">natVal</span> <span class="p">(</span><span class="kt">Proxy</span> <span class="ow">::</span> <span class="kt">Proxy</span> <span class="n">n</span><span class="p">)</span>
            <span class="n">r</span> <span class="ow">=</span> <span class="n">natVal</span> <span class="p">(</span><span class="kt">Proxy</span> <span class="ow">::</span> <span class="kt">Proxy</span> <span class="n">m</span><span class="p">)</span>
                 <span class="kr">in</span> <span class="n">go</span> <span class="n">c</span> <span class="n">r</span> <span class="n">id</span>
  <span class="kr">where</span>
      <span class="n">go</span> <span class="ow">::</span> <span class="kt">Integer</span> <span class="ow">-&gt;</span> <span class="kt">Integer</span> <span class="ow">-&gt;</span> <span class="p">(</span><span class="n">forall</span> <span class="n">e</span> <span class="n">n</span> <span class="n">m</span> <span class="o">.</span> <span class="p">(</span><span class="kt">Zero</span> <span class="n">e</span><span class="p">,</span> <span class="kt">KnownDimensions</span> <span class="n">n</span> <span class="n">m</span><span class="p">)</span> <span class="ow">=&gt;</span> <span class="kt">T</span> <span class="n">n</span> <span class="n">m</span> <span class="ow">-&gt;</span> <span class="n">r</span><span class="p">)</span> <span class="ow">-&gt;</span> <span class="n">r</span>
      <span class="n">go</span> <span class="mi">1</span> <span class="mi">1</span> <span class="n">c</span> <span class="ow">=</span> <span class="n">c</span> <span class="p">(</span><span class="n">el</span> <span class="n">zero</span><span class="p">)</span>
      <span class="n">go</span> <span class="n">n</span> <span class="n">m</span> <span class="n">c</span> <span class="ow">=</span> <span class="n">undefined</span>
</pre></div></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/20a04d823b7c3891d78ca5f6a188ccd0e4fc5e3d?x=x&amp;version=2"></a><div class="content"><a class="author">TheMatten</a><div class="metadata"><a href="#181812015" name="181812015"><div>2019-11-25 11:22:25</div></a></div><div class="text"><p>How does <code>T</code> look like?<br>
<code>go c r id</code> won't work - for the same reason you're using CPS</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/068f19d948936a41dcd13e340bacb9344e28944c?x=x&amp;version=2"></a><div class="content"><a class="author">Bolt</a><div class="metadata"><a href="#181812171" name="181812171"><div>2019-11-25 11:25:21</div></a></div><div class="text"><div class="codehilite"><pre><span></span><span class="kr">data</span> <span class="kt">T</span> <span class="p">(</span><span class="n">c</span> <span class="ow">::</span> <span class="kt">Nat</span><span class="p">)</span> <span class="p">(</span><span class="n">r</span> <span class="ow">::</span> <span class="kt">Nat</span><span class="p">)</span> <span class="kr">where</span>
  <span class="kt">J</span> <span class="ow">::</span> <span class="p">(</span><span class="kt">ValidDimensions</span> <span class="n">m</span> <span class="n">p</span><span class="p">,</span> <span class="kt">ValidDimensions</span> <span class="n">n</span> <span class="n">p</span><span class="p">)</span> <span class="ow">=&gt;</span> <span class="kt">T</span> <span class="n">m</span> <span class="n">p</span> <span class="ow">-&gt;</span> <span class="kt">T</span> <span class="n">n</span> <span class="n">p</span> <span class="ow">-&gt;</span> <span class="kt">T</span> <span class="p">(</span><span class="n">m</span> <span class="o">+</span> <span class="n">n</span><span class="p">)</span> <span class="n">p</span>
  <span class="kt">S</span> <span class="ow">::</span> <span class="p">(</span><span class="kt">ValidDimensions</span> <span class="n">p</span> <span class="n">m</span><span class="p">,</span> <span class="kt">ValidDimensions</span> <span class="n">p</span> <span class="n">n</span><span class="p">)</span> <span class="ow">=&gt;</span> <span class="kt">T</span> <span class="n">p</span> <span class="n">m</span> <span class="ow">-&gt;</span> <span class="kt">T</span> <span class="n">p</span> <span class="n">n</span> <span class="ow">-&gt;</span> <span class="kt">T</span> <span class="n">p</span> <span class="p">(</span><span class="n">m</span> <span class="o">+</span> <span class="n">n</span><span class="p">)</span>
  <span class="kt">One</span> <span class="ow">::</span> <span class="kt">T</span> <span class="mi">1</span> <span class="mi">1</span>
</pre></div></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/068f19d948936a41dcd13e340bacb9344e28944c?x=x&amp;version=2"></a><div class="content"><a class="author">Bolt</a><div class="metadata"><a href="#181812278" name="181812278"><div>2019-11-25 11:26:53</div></a></div><div class="text"><p>Why can't <code>T 1 1</code> be inferred as <code>forall n m . T n m</code> ?? That sounds stupid to me</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/068f19d948936a41dcd13e340bacb9344e28944c?x=x&amp;version=2"></a><div class="content"><a class="author">Bolt</a><div class="metadata"><a href="#181812410" name="181812410"><div>2019-11-25 11:28:03</div></a></div><div class="text"><p>How can I be polymorphic in <code>One</code> type constructor but still have it return <code>T 1 1</code> ?</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/20a04d823b7c3891d78ca5f6a188ccd0e4fc5e3d?x=x&amp;version=2"></a><div class="content"><a class="author">TheMatten</a><div class="metadata"><a href="#181812745" name="181812745"><div>2019-11-25 11:32:07</div></a></div><div class="text"><p>That would be like saying <code>(1, 1) = \a b -&gt; (a, b)</code> - <code>forall n m. T n m</code> is basically an implicit type function</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/068f19d948936a41dcd13e340bacb9344e28944c?x=x&amp;version=2"></a><div class="content"><a class="author">Bolt</a><div class="metadata"><a href="#181812821" name="181812821"><div>2019-11-25 11:33:07</div></a></div><div class="text"><p>Are you saying it is possible to solve my problem?</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/20a04d823b7c3891d78ca5f6a188ccd0e4fc5e3d?x=x&amp;version=2"></a><div class="content"><a class="author">TheMatten</a><div class="metadata"><a href="#181812820" name="181812820"><div>2019-11-25 11:33:07</div></a></div><div class="text"><p>In Core this would be more apparent</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/20a04d823b7c3891d78ca5f6a188ccd0e4fc5e3d?x=x&amp;version=2"></a><div class="content"><a class="author">TheMatten</a><div class="metadata"><a href="#181812919" name="181812919"><div>2019-11-25 11:34:17</div></a></div><div class="text"><p>Basically, if you want to pass concrete <code>T</code> around, you have to hide it's arguments in existential wrapper/context - then it will work</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/20a04d823b7c3891d78ca5f6a188ccd0e4fc5e3d?x=x&amp;version=2"></a><div class="content"><a class="author">TheMatten</a><div class="metadata"><a href="#181813011" name="181813011"><div>2019-11-25 11:35:41</div></a></div><div class="text"><p>Because basically the only possible direct quantification in Haskell is universal - and universal one assumes that you can actually put any arguments in there as a caller</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/068f19d948936a41dcd13e340bacb9344e28944c?x=x&amp;version=2"></a><div class="content"><a class="author">Bolt</a><div class="metadata"><a href="#181813028" name="181813028"><div>2019-11-25 11:35:55</div></a></div><div class="text"><div class="codehilite"><pre><span></span><span class="kr">data</span> <span class="kt">T</span> <span class="p">(</span><span class="n">c</span> <span class="ow">::</span> <span class="kt">Nat</span><span class="p">)</span> <span class="p">(</span><span class="n">r</span> <span class="ow">::</span> <span class="kt">Nat</span><span class="p">)</span> <span class="kr">where</span>
  <span class="kt">J</span> <span class="ow">::</span> <span class="p">(</span><span class="kt">ValidDimensions</span> <span class="n">m</span> <span class="n">p</span><span class="p">,</span> <span class="kt">ValidDimensions</span> <span class="n">n</span> <span class="n">p</span><span class="p">)</span> <span class="ow">=&gt;</span> <span class="kt">T</span> <span class="n">m</span> <span class="n">p</span> <span class="ow">-&gt;</span> <span class="kt">T</span> <span class="n">n</span> <span class="n">p</span> <span class="ow">-&gt;</span> <span class="kt">T</span> <span class="p">(</span><span class="n">m</span> <span class="o">+</span> <span class="n">n</span><span class="p">)</span> <span class="n">p</span>
  <span class="kt">S</span> <span class="ow">::</span> <span class="p">(</span><span class="kt">ValidDimensions</span> <span class="n">p</span> <span class="n">m</span><span class="p">,</span> <span class="kt">ValidDimensions</span> <span class="n">p</span> <span class="n">n</span><span class="p">)</span> <span class="ow">=&gt;</span> <span class="kt">T</span> <span class="n">p</span> <span class="n">m</span> <span class="ow">-&gt;</span> <span class="kt">T</span> <span class="n">p</span> <span class="n">n</span> <span class="ow">-&gt;</span> <span class="kt">T</span> <span class="n">p</span> <span class="p">(</span><span class="n">m</span> <span class="o">+</span> <span class="n">n</span><span class="p">)</span>
  <span class="kt">One</span> <span class="ow">::</span> <span class="kt">T</span> <span class="mi">1</span> <span class="mi">1</span>

<span class="kr">data</span> <span class="kt">TWrapper</span> <span class="ow">=</span> <span class="n">forall</span> <span class="n">n</span> <span class="n">m</span> <span class="o">.</span> <span class="kt">TW</span> <span class="p">(</span><span class="kt">T</span> <span class="n">n</span> <span class="n">m</span><span class="p">)</span>
</pre></div>


<p>like this?</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/068f19d948936a41dcd13e340bacb9344e28944c?x=x&amp;version=2"></a><div class="content"><a class="author">Bolt</a><div class="metadata"><a href="#181814118" name="181814118"><div>2019-11-25 11:49:25</div></a></div><div class="text"><p>But that way Im going to loose the type safety on the Natural numbers <span aria-label="confused" class="emoji emoji-1f615" role="img" title="confused">:confused:</span></p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/068f19d948936a41dcd13e340bacb9344e28944c?x=x&amp;version=2"></a><div class="content"><a class="author">Bolt</a><div class="metadata"><a href="#181814929" name="181814929"><div>2019-11-25 11:58:34</div></a></div><div class="text"><div class="codehilite"><pre><span></span><span class="nf">el</span> <span class="ow">::</span> <span class="kt">T</span> <span class="mi">1</span> <span class="mi">1</span>
<span class="nf">el</span> <span class="ow">=</span> <span class="kt">One</span>

<span class="nf">zeros</span> <span class="ow">::</span> <span class="n">forall</span> <span class="n">e</span> <span class="n">n</span> <span class="n">m</span> <span class="o">.</span> <span class="p">(</span><span class="kt">Zero</span> <span class="n">e</span><span class="p">,</span> <span class="kt">KnownDimensions</span> <span class="n">n</span> <span class="n">m</span><span class="p">)</span> <span class="ow">=&gt;</span> <span class="kt">T</span> <span class="n">n</span> <span class="n">m</span>
<span class="nf">zeros</span> <span class="ow">=</span> <span class="kr">let</span> <span class="n">c</span> <span class="ow">=</span> <span class="n">natVal</span> <span class="p">(</span><span class="kt">Proxy</span> <span class="ow">::</span> <span class="kt">Proxy</span> <span class="n">n</span><span class="p">)</span>
            <span class="n">r</span> <span class="ow">=</span> <span class="n">natVal</span> <span class="p">(</span><span class="kt">Proxy</span> <span class="ow">::</span> <span class="kt">Proxy</span> <span class="n">m</span><span class="p">)</span>
            <span class="p">(</span><span class="kt">TW</span> <span class="n">t</span><span class="p">)</span> <span class="ow">=</span> <span class="n">go</span> <span class="n">c</span> <span class="n">r</span>
            <span class="kr">in</span> <span class="n">t</span>
  <span class="kr">where</span>
      <span class="n">go</span> <span class="ow">::</span> <span class="kt">Integer</span> <span class="ow">-&gt;</span> <span class="kt">Integer</span> <span class="ow">-&gt;</span> <span class="kt">TWrapper</span>
      <span class="n">go</span> <span class="mi">1</span> <span class="mi">1</span> <span class="ow">=</span> <span class="kt">TW</span> <span class="n">el</span>
      <span class="n">go</span> <span class="n">n</span> <span class="n">m</span> <span class="ow">=</span> <span class="n">undefined</span>
</pre></div>


<p>I'm trying this and get</p>
<div class="codehilite"><pre><span></span><span class="kt">Couldn&#39;t</span> <span class="n">match</span> <span class="kr">type</span> <span class="err">‘</span><span class="n">n1</span><span class="err">’</span> <span class="n">with</span> <span class="err">‘</span><span class="n">n</span><span class="err">’</span>
  <span class="err">‘</span><span class="n">n1</span><span class="err">’</span> <span class="n">is</span> <span class="n">a</span> <span class="n">rigid</span> <span class="kr">type</span> <span class="n">variable</span> <span class="n">bound</span> <span class="n">by</span>
    <span class="n">a</span> <span class="n">pattern</span> <span class="n">with</span> <span class="n">constructor</span><span class="kt">:</span>
      <span class="kt">TW</span> <span class="ow">::</span> <span class="n">forall</span> <span class="n">e</span> <span class="p">(</span><span class="n">n</span> <span class="ow">::</span> <span class="kt">Nat</span><span class="p">)</span> <span class="p">(</span><span class="n">m</span> <span class="ow">::</span> <span class="kt">Nat</span><span class="p">)</span><span class="o">.</span> <span class="kt">T</span> <span class="n">n</span> <span class="n">m</span> <span class="ow">-&gt;</span> <span class="kt">TWrapper</span><span class="p">,</span>
    <span class="kr">in</span> <span class="n">a</span> <span class="n">pattern</span> <span class="n">binding</span>
</pre></div></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/068f19d948936a41dcd13e340bacb9344e28944c?x=x&amp;version=2"></a><div class="content"><a class="author">Bolt</a><div class="metadata"><a href="#181823015" name="181823015"><div>2019-11-25 13:44:58</div></a></div><div class="text"><p>So bottom line is there a way for GHC to don't be a bitch about specific types? </p>
<p>Doesn't it make sense for (1 :: Nat) to unify with (n :: Nat)?</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/20a04d823b7c3891d78ca5f6a188ccd0e4fc5e3d?x=x&amp;version=2"></a><div class="content"><a class="author">TheMatten</a><div class="metadata"><a href="#181824283" name="181824283"><div>2019-11-25 14:01:49</div></a></div><div class="text"><p><span class="user-mention" data-user-id="250742">@Bolt</span>  <code>KnownDimensions n m</code> is <code>(KnownNat n, KnownNat m)</code>?</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/068f19d948936a41dcd13e340bacb9344e28944c?x=x&amp;version=2"></a><div class="content"><a class="author">Bolt</a><div class="metadata"><a href="#181830560" name="181830560"><div>2019-11-25 15:07:11</div></a></div><div class="text"><p>Yes</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/20a04d823b7c3891d78ca5f6a188ccd0e4fc5e3d?x=x&amp;version=2"></a><div class="content"><a class="author">TheMatten</a><div class="metadata"><a href="#181831345" name="181831345"><div>2019-11-25 15:15:09</div></a></div><div class="text"><p>I would probably consider doing this using typeclass:</p>
<div class="codehilite"><pre><span></span><span class="kr">class</span> <span class="kt">Zeros</span> <span class="n">n</span> <span class="n">m</span> <span class="kr">where</span>
  <span class="n">zeros</span> <span class="ow">::</span> <span class="kt">T</span> <span class="n">n</span> <span class="n">m</span>
</pre></div>


<p>this way you easily avoid problems with known indexes and plus it should inline nicely when <code>n</code> and <code>m</code> are known at  call site</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/068f19d948936a41dcd13e340bacb9344e28944c?x=x&amp;version=2"></a><div class="content"><a class="author">Bolt</a><div class="metadata"><a href="#181851324" name="181851324"><div>2019-11-25 18:50:53</div></a></div><div class="text"><p>Im not sure I understand, will that solve my problem?</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/89529ef093c72e16a5ce3ac00d88f354ccc08cf9?x=x&amp;version=2"></a><div class="content"><a class="author">Lysxia</a><div class="metadata"><a href="#181880759" name="181880759"><div>2019-11-26 01:05:48</div></a></div><div class="text"><p>Not a direct answer to your problem but it looks like you will be well served by reading about singletons. <a href="https://blog.jle.im/entry/introduction-to-singletons-1.html" target="_blank" title="https://blog.jle.im/entry/introduction-to-singletons-1.html">https://blog.jle.im/entry/introduction-to-singletons-1.html</a></p>
<div class="message_embed"><a class="message_embed_image" href="https://blog.jle.im/entry/introduction-to-singletons-1.html" style="background-image: url(https://blog.jle.im/img/site_logo.jpg)" target="_blank"></a><div class="data-container"><div class="message_embed_title"><a href="https://blog.jle.im/entry/introduction-to-singletons-1.html" target="_blank" title="Introduction to Singletons (Part 1)">Introduction to Singletons (Part 1)</a></div><div class="message_embed_description">Real dependent types are coming to Haskell soon! Until then, we have the great singletons library :) If you’ve ever run into dependently typed programming in Haskell, you’ve probably encountered mentions of singletons (and the singletons library). This series of articles will be my attempt at giving you the story of the library, the problems it solves, the power that it gives to you, and how you can integrate it into your code today! (Also, after my previous April Fools post, people have been asking me for an actual non-joke singletons post) This post (Part 1) will go over first using the singleton pattern for reflection, then introducing how the singletons library helps us. Part 2 will discuss using the library for reification, to get types that depend on values at runtime. Part 3 will go into the basics of promoting functions values to become functions on types in a usable, and Part 4 will go deeper into the lifting of functions, using singleton’s defunctionalization scheme to utilize the higher-order functions we love at the type level. Part 3 will go into the basics singleton’s I definitely am writing this post with the hope that it will be obsolete in a year or two. When dependent types come to Haskell, singletons will be nothing more than a painful historical note. But for now, singletons might be the best way to get your foot into the door and experience the thrill and benefits of dependently typed programming today!</div></div></div></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/068f19d948936a41dcd13e340bacb9344e28944c?x=x&amp;version=2"></a><div class="content"><a class="author">Bolt</a><div class="metadata"><a href="#181882411" name="181882411"><div>2019-11-26 01:36:17</div></a></div><div class="text"><p>The problem with my data type is that I cannot write a function that can build it because of the stupid base case <code>T 1 1</code></p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/3d24a4100b3eab34d8ce3059d789c543?d=identicon&amp;version=1"></a><div class="content"><a class="author">Sandy Maguire</a><div class="metadata"><a href="#181903024" name="181903024"><div>2019-11-26 09:26:40</div></a></div><div class="text"><p><span class="user-mention" data-user-id="250742">@Bolt</span> can you share the whole code with me? i'm lost trying to piece it together from the conversation, but I'm pretty sure there is a silly mistake being made here somewhere</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/068f19d948936a41dcd13e340bacb9344e28944c?x=x&amp;version=2"></a><div class="content"><a class="author">Bolt</a><div class="metadata"><a href="#181911932" name="181911932"><div>2019-11-26 11:26:24</div></a></div><div class="text"><p>Yes!</p></div></div></div></div></div><div class="ui vertical footer segment"><a href="https://github.com/srid/zulip-archive">Powered by Haskell</a></div></div></body></html>