<html lang="en"><head><meta content="text/html; charset=utf-8" http-equiv="Content-Type"><meta content="width=device-width, initial-scale=1" name="viewport"><meta content="class A a b | a -&gt; b where

class B as bs | as -&gt; bs where

type family Pointwise (xs :: [*]) (ys :: [*]) :: Constraint where
  Pointwise &#39;[] &#39;[] = ()
  Pointwise (x : xs) (y : ys) = (A x y, Pointwise xs ys)

instance Pointwise as bs =&gt; B as bs where

Any idea if there&#39;s a way to make this work?
Bas" name="description"><link href="https://funprog.srid.ca/haskell/pointwise-fundeps.html" rel="canonical"><meta property="og:title" content="pointwise fundeps - Haskell"><meta property="og:site_name" content="Functional Programming Zulip Archive"><meta property="og:type" content="article"><meta property="og:article:section" content="Haskell"><meta property="og:article:modified_time" content="2021-05-05T04:45:26Z"><meta property="og:article:published_time" content="2021-05-04T15:49:43Z"><meta property="og:image" content="https://zulip-avatars.s3.amazonaws.com/13896/7334dc60b6aef6a75cd9284126231f13c76926a5?x=x&amp;version=4"><title>pointwise fundeps - Haskell</title><style type="text/css">
div#thesite
{
  font-family   : "Open Sans", sans-serif;
  font-size     : 1em !important;
  margin-top    : 1em;
  margin-bottom : 1em;
}

div#thesite h1
{
  font-family : "Roboto", sans-serif;
  line-height : 1.19999em;
}

div#thesite h2
{
  font-family : "Roboto", sans-serif;
  line-height : 1.19999em;
}

div#thesite h3
{
  font-family : "Roboto", sans-serif;
  line-height : 1.19999em;
}

div#thesite h4
{
  font-family : "Roboto", sans-serif;
  line-height : 1.19999em;
}

div#thesite h5
{
  font-family : "Roboto", sans-serif;
  line-height : 1.19999em;
}

div#thesite h6
{
  font-family : "Roboto", sans-serif;
  line-height : 1.19999em;
}

div#thesite .ui.breadcrumb.rib .section
{
  font-family : "Roboto", sans-serif;
  line-height : 1.19999em;
}

div#thesite .header
{
  font-family : "Roboto", sans-serif;
  line-height : 1.19999em;
}

div#thesite .as-header
{
  font-family : "Roboto", sans-serif;
  line-height : 1.19999em;
}

div#thesite code, pre, tt
{
  font-family : "SFMono-Regular","Menlo","Monaco","Consolas","Liberation Mono","Courier New", monospace;
}

div#thesite .ui.breadcrumb.rib
{
  margin-bottom : 1em;
}



div#thesite .ui.comments.messages .comment .metadata a
{
  color : #808080;
}

div#thesite .ui.comments.messages .comment a.avatar img
{
  height : auto;
}

div#thesite .subtle
{
  color : #808080;
}


div#thesite .messages pre
{
  font-size : 85%;
  overflow  : auto;
  max-width : 100%;
}

div#thesite .messages .message_embed
{
  border-left  : solid 3px #808080;
  padding-left : 0.69999em;
}

div#thesite .messages .message_inline_image img
{
  max-width     : 100%;
  margin-bottom : 1em;
}


/* Generated with Clay, http://fvisser.nl/clay */</style><link href="https://cdnjs.cloudflare.com/ajax/libs/semantic-ui/2.4.1/semantic.min.css" rel="stylesheet"><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css" rel="stylesheet"><link href="https://fonts.googleapis.com/css?family=Open+Sans|Oswald&amp;display=swap" rel="stylesheet"><link href="https://fonts.googleapis.com/css?family=Roboto|Open+Sans&amp;display=swap" rel="stylesheet"></head><body><div id="thesite" class="ui text container"><div class="ui violet inverted top attached center aligned segment"><h1 class="ui huge header">pointwise fundeps - Haskell</h1></div><div class="ui attached segment"><div class="ui message"><p>Welcome to the Functional Programming Zulip Chat Archive. You can join the chat <a href="https://funprog.zulipchat.com">here</a>.</p></div><div class="ui breadcrumb rib"><a href="/" class="section">Home</a><i class="right angle icon divider"></i><a href="/haskell/" class="section">#Haskell</a><i class="right angle icon divider"></i><div class="active section">pointwise fundeps</div></div><div class="ui comments messages"><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/7334dc60b6aef6a75cd9284126231f13c76926a5?x=x&amp;version=4"></a><div class="content"><a class="author">Torsten Schmits</a><div class="metadata"><a href="#237349837" name="237349837"><div>2021-05-04 15:49:43</div></a></div><div class="text"><div class="codehilite" data-code-language="Haskell"><pre><span></span><code><span class="kr">class</span> <span class="kt">A</span> <span class="n">a</span> <span class="n">b</span> <span class="o">|</span> <span class="n">a</span> <span class="ow">-&gt;</span> <span class="n">b</span> <span class="kr">where</span>

<span class="kr">class</span> <span class="kt">B</span> <span class="n">as</span> <span class="n">bs</span> <span class="o">|</span> <span class="n">as</span> <span class="ow">-&gt;</span> <span class="n">bs</span> <span class="kr">where</span>

<span class="kr">type</span> <span class="kr">family</span> <span class="kt">Pointwise</span> <span class="p">(</span><span class="n">xs</span> <span class="ow">::</span> <span class="p">[</span><span class="o">*</span><span class="p">])</span> <span class="p">(</span><span class="n">ys</span> <span class="ow">::</span> <span class="p">[</span><span class="o">*</span><span class="p">])</span> <span class="ow">::</span> <span class="kt">Constraint</span> <span class="kr">where</span>
  <span class="kt">Pointwise</span> <span class="kt">'[]</span> <span class="kt">'[]</span> <span class="ow">=</span> <span class="nb">()</span>
  <span class="kt">Pointwise</span> <span class="p">(</span><span class="n">x</span> <span class="kt">:</span> <span class="n">xs</span><span class="p">)</span> <span class="p">(</span><span class="n">y</span> <span class="kt">:</span> <span class="n">ys</span><span class="p">)</span> <span class="ow">=</span> <span class="p">(</span><span class="kt">A</span> <span class="n">x</span> <span class="n">y</span><span class="p">,</span> <span class="kt">Pointwise</span> <span class="n">xs</span> <span class="n">ys</span><span class="p">)</span>

<span class="kr">instance</span> <span class="kt">Pointwise</span> <span class="n">as</span> <span class="n">bs</span> <span class="ow">=&gt;</span> <span class="kt">B</span> <span class="n">as</span> <span class="n">bs</span> <span class="kr">where</span>
</code></pre></div>
<p>Any idea if there's a way to make this work?<br>
Basically, each pair in the zipped list of <code>as</code> and <code>bs</code> is functionally dependent in the instance of <code>B</code>, but the entire lists aren't.<br>
I tried using some <code>SameShapeAs</code> constraints, but no success.</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/20a04d823b7c3891d78ca5f6a188ccd0e4fc5e3d?x=x&amp;version=2"></a><div class="content"><a class="author">TheMatten</a><div class="metadata"><a href="#237351155" name="237351155"><div>2021-05-04 15:57:52</div></a></div><div class="text"><p>You mean that <code>as bs</code> determine every <code>A x y</code> in result of <code>Pointwise as bs</code>?</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/7334dc60b6aef6a75cd9284126231f13c76926a5?x=x&amp;version=4"></a><div class="content"><a class="author">Torsten Schmits</a><div class="metadata"><a href="#237351342" name="237351342"><div>2021-05-04 15:59:05</div></a></div><div class="text"><p>hmm yes</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/20a04d823b7c3891d78ca5f6a188ccd0e4fc5e3d?x=x&amp;version=2"></a><div class="content"><a class="author">TheMatten</a><div class="metadata"><a href="#237355841" name="237355841"><div>2021-05-04 16:23:43</div></a></div><div class="text"><p>But doesn't FD mean that such class is a "function" in that direction? In that case, you could determine <code>Pointwise as bs</code> as a whole, but determining separate parts of it sounds like trying to have function with multiple returns</p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/1114fd8de67671f83d3a3ef7594b1950?d=identicon&amp;version=1"></a><div class="content"><a class="author">Georgi Lyubenov // googleson78</a><div class="metadata"><a href="#237367703" name="237367703"><div>2021-05-04 17:39:13</div></a></div><div class="text"><p>yeah the 'Pointwise' tf seems to determine all of the elements of 'bs' in terms of elements of 'as', but that doesn't say anything about their order (or about duplicates in the list, so about the shape of 'bs' in general), so intuitively it feels like it shouldn't be possible</p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/1114fd8de67671f83d3a3ef7594b1950?d=identicon&amp;version=1"></a><div class="content"><a class="author">Georgi Lyubenov // googleson78</a><div class="metadata"><a href="#237367794" name="237367794"><div>2021-05-04 17:39:58</div></a></div><div class="text"><p>more concretely, I'm not sure how the fundep checks work, but if they're done at instance declaration instead of instantiation time, then this seems like it shouldn't work, because 'Pointwise' is just stuck in there, giving no info to the type checker (afaiu)</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/7334dc60b6aef6a75cd9284126231f13c76926a5?x=x&amp;version=4"></a><div class="content"><a class="author">Torsten Schmits</a><div class="metadata"><a href="#237413755" name="237413755"><div>2021-05-04 23:00:26</div></a></div><div class="text"><p>yeah well, I'd need to have a proof that the elements are in the correct order then</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/7334dc60b6aef6a75cd9284126231f13c76926a5?x=x&amp;version=4"></a><div class="content"><a class="author">Torsten Schmits</a><div class="metadata"><a href="#237413950" name="237413950"><div>2021-05-04 23:02:06</div></a></div><div class="text"><div class="codehilite" data-code-language="Haskell"><pre><span></span><code><span class="kr">instance</span> <span class="p">(</span><span class="kt">A</span> <span class="n">a1</span> <span class="n">b1</span><span class="p">,</span> <span class="kt">A</span> <span class="n">a2</span> <span class="n">b2</span><span class="p">)</span> <span class="ow">=&gt;</span> <span class="kt">B</span> <span class="p">[</span><span class="n">a1</span><span class="p">,</span> <span class="n">a2</span><span class="p">]</span> <span class="p">[</span><span class="n">b1</span><span class="p">,</span> <span class="n">b2</span><span class="p">]</span>
</code></pre></div>
<p>This is fine, however</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/7334dc60b6aef6a75cd9284126231f13c76926a5?x=x&amp;version=4"></a><div class="content"><a class="author">Torsten Schmits</a><div class="metadata"><a href="#237414551" name="237414551"><div>2021-05-04 23:07:49</div></a></div><div class="text"><div class="codehilite" data-code-language="Haskell"><pre><span></span><code><span class="kr">instance</span> <span class="p">(</span><span class="kt">SListI</span> <span class="n">as</span><span class="p">,</span> <span class="kt">SListI</span> <span class="n">bs</span><span class="p">,</span> <span class="kt">SameShapeAs</span> <span class="n">as</span> <span class="n">bs</span><span class="p">,</span> <span class="kt">SameShapeAs</span> <span class="n">bs</span> <span class="n">as</span><span class="p">,</span> <span class="kt">Pointwise</span> <span class="n">as</span> <span class="n">bs</span><span class="p">)</span> <span class="ow">=&gt;</span> <span class="kt">B</span> <span class="n">as</span> <span class="n">bs</span> <span class="kr">where</span>
</code></pre></div>
<p>forcing them to be lists of the same shape has no effect either (from <code>generics-sop</code>)</p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/1114fd8de67671f83d3a3ef7594b1950?d=identicon&amp;version=1"></a><div class="content"><a class="author">Georgi Lyubenov // googleson78</a><div class="metadata"><a href="#237440202" name="237440202"><div>2021-05-05 04:45:26</div></a></div><div class="text"><p>what about making the one B instance into two instances, a base one for [] [] and a recursive one, with the usual overlaps pragma?</p></div></div></div></div></div><div class="ui vertical footer segment"><a href="https://github.com/srid/zulip-archive">Powered by Haskell</a> | Questions? Contact <a href="https://www.srid.ca">srid</a></div></div></body></html>