<html lang="en"><head><meta content="text/html; charset=utf-8" http-equiv="Content-Type"><meta content="width=device-width, initial-scale=1" name="viewport"><meta content="So because of the interlinking stuff I am doing, I was about to start on the specific interface for querying it. What I was thinking was that the function should be e.g. lookupLinkTarget :: TargetSpec -&gt; MySite -&gt; Destination" name="description"><link href="https://funprog.srid.ca/rib/source-type.html" rel="canonical"><meta property="og:title" content="`Source` type - Rib"><meta property="og:site_name" content="Functional Programming Zulip Archive"><meta property="og:type" content="article"><meta property="og:article:section" content="Rib"><meta property="og:article:modified_time" content="2020-03-11T20:08:37Z"><meta property="og:article:published_time" content="2020-01-18T00:37:36Z"><meta property="og:image" content="https://secure.gravatar.com/avatar/45175015b9eb3dd3f6c740b3fe920fed?d=identicon&amp;version=1"><title>`Source` type - Rib</title><style type="text/css">
div#thesite
{
  font-family   : "Open Sans", sans-serif;
  font-size     : 1em !important;
  margin-top    : 1em;
  margin-bottom : 1em;
}

div#thesite h1
{
  font-family : "Roboto", sans-serif;
  line-height : 1.19999em;
}

div#thesite h2
{
  font-family : "Roboto", sans-serif;
  line-height : 1.19999em;
}

div#thesite h3
{
  font-family : "Roboto", sans-serif;
  line-height : 1.19999em;
}

div#thesite h4
{
  font-family : "Roboto", sans-serif;
  line-height : 1.19999em;
}

div#thesite h5
{
  font-family : "Roboto", sans-serif;
  line-height : 1.19999em;
}

div#thesite h6
{
  font-family : "Roboto", sans-serif;
  line-height : 1.19999em;
}

div#thesite .ui.breadcrumb.rib .section
{
  font-family : "Roboto", sans-serif;
  line-height : 1.19999em;
}

div#thesite .header
{
  font-family : "Roboto", sans-serif;
  line-height : 1.19999em;
}

div#thesite .as-header
{
  font-family : "Roboto", sans-serif;
  line-height : 1.19999em;
}

div#thesite code, pre, tt
{
  font-family : "SFMono-Regular","Menlo","Monaco","Consolas","Liberation Mono","Courier New", monospace;
}

div#thesite .ui.breadcrumb.rib
{
  margin-bottom : 1em;
}



div#thesite .ui.comments.messages .comment .metadata a
{
  color : #808080;
}

div#thesite .ui.comments.messages .comment a.avatar img
{
  height : auto;
}

div#thesite .subtle
{
  color : #808080;
}


div#thesite .messages pre
{
  font-size : 85%;
  overflow  : auto;
  max-width : 100%;
}

div#thesite .messages .message_embed
{
  border-left  : solid 3px #808080;
  padding-left : 0.69999em;
}

div#thesite .messages .message_inline_image img
{
  max-width     : 100%;
  margin-bottom : 1em;
}


/* Generated with Clay, http://fvisser.nl/clay */</style><link href="https://cdnjs.cloudflare.com/ajax/libs/semantic-ui/2.4.1/semantic.min.css" rel="stylesheet"><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css" rel="stylesheet"><link href="https://fonts.googleapis.com/css?family=Open+Sans|Oswald&amp;display=swap" rel="stylesheet"><link href="https://fonts.googleapis.com/css?family=Roboto|Open+Sans&amp;display=swap" rel="stylesheet"></head><body><div id="thesite" class="ui text container"><div class="ui violet inverted top attached center aligned segment"><h1 class="ui huge header">`Source` type - Rib</h1></div><div class="ui attached segment"><div class="ui message"><p>Welcome to the Functional Programming Zulip Chat Archive. You can join the chat <a href="https://funprog.zulipchat.com">here</a>.</p></div><div class="ui breadcrumb rib"><a href="/" class="section">Home</a><i class="right angle icon divider"></i><a href="/rib/" class="section">#Rib</a><i class="right angle icon divider"></i><div class="active section">`Source` type</div></div><div class="ui comments messages"><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/45175015b9eb3dd3f6c740b3fe920fed?d=identicon&amp;version=1"></a><div class="content"><a class="author">Joel McCracken</a><div class="metadata"><a href="#185971426" name="185971426"><div>2020-01-18 00:37:36</div></a></div><div class="text"><p>So because of the interlinking stuff I am doing, I was about to start on the specific interface for querying it. What I was thinking was that the function should be e.g. <code>lookupLinkTarget :: TargetSpec -&gt; MySite -&gt; Destination</code></p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/45175015b9eb3dd3f6c740b3fe920fed?d=identicon&amp;version=1"></a><div class="content"><a class="author">Joel McCracken</a><div class="metadata"><a href="#185971443" name="185971443"><div>2020-01-18 00:37:59</div></a></div><div class="text"><p>so, I was about to buid a type for <code>MySite</code></p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/45175015b9eb3dd3f6c740b3fe920fed?d=identicon&amp;version=1"></a><div class="content"><a class="author">Joel McCracken</a><div class="metadata"><a href="#185971487" name="185971487"><div>2020-01-18 00:38:05</div></a></div><div class="text"><p>what I was thinking of was something like:</p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/45175015b9eb3dd3f6c740b3fe920fed?d=identicon&amp;version=1"></a><div class="content"><a class="author">Joel McCracken</a><div class="metadata"><a href="#185971520" name="185971520"><div>2020-01-18 00:38:58</div></a></div><div class="text"><p><code>data MySite = MySite LinkTargetData [Source XmlM]</code></p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/45175015b9eb3dd3f6c740b3fe920fed?d=identicon&amp;version=1"></a><div class="content"><a class="author">Joel McCracken</a><div class="metadata"><a href="#185971600" name="185971600"><div>2020-01-18 00:40:06</div></a></div><div class="text"><p>HOWEVER, i notice that <code>Source</code> not only contains the "source" information but also target</p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/45175015b9eb3dd3f6c740b3fe920fed?d=identicon&amp;version=1"></a><div class="content"><a class="author">Joel McCracken</a><div class="metadata"><a href="#185971603" name="185971603"><div>2020-01-18 00:40:12</div></a></div><div class="text"><p>which is semantically a bit separate IMO</p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/45175015b9eb3dd3f6c740b3fe920fed?d=identicon&amp;version=1"></a><div class="content"><a class="author">Joel McCracken</a><div class="metadata"><a href="#185971605" name="185971605"><div>2020-01-18 00:40:23</div></a></div><div class="text"><p>(maybe I might want to have a source that has no direct desintation?)</p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/45175015b9eb3dd3f6c740b3fe920fed?d=identicon&amp;version=1"></a><div class="content"><a class="author">Joel McCracken</a><div class="metadata"><a href="#185971614" name="185971614"><div>2020-01-18 00:40:51</div></a></div><div class="text"><p>just something I noticed, I will pobably end up using something besides <code>Source</code> for now</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/4429aa8b689608f24a4ad712843ce29862e330d2?x=x&amp;version=2"></a><div class="content"><a class="author">Sridhar Ratnakumar</a><div class="metadata"><a href="#185971727" name="185971727"><div>2020-01-18 00:43:12</div></a></div><div class="text"><p>I have metadata files that I read with "readSource". Then fmap it over "sourceVal" to get just the value (discarding other fields). Would this not be better? So, "MySite LinkTargetData [XmlM]"</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/4429aa8b689608f24a4ad712843ce29862e330d2?x=x&amp;version=2"></a><div class="content"><a class="author">Sridhar Ratnakumar</a><div class="metadata"><a href="#185971829" name="185971829"><div>2020-01-18 00:45:08</div></a></div><div class="text"><p>Actually no need for fmap,as readSource returns the underlying type directly</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/4429aa8b689608f24a4ad712843ce29862e330d2?x=x&amp;version=2"></a><div class="content"><a class="author">Sridhar Ratnakumar</a><div class="metadata"><a href="#185971838" name="185971838"><div>2020-01-18 00:45:22</div></a></div><div class="text"><p><a href="https://github.com/srid/website/blob/master/src/Main.hs#L63" target="_blank" title="https://github.com/srid/website/blob/master/src/Main.hs#L63">https://github.com/srid/website/blob/master/src/Main.hs#L63</a></p>
<div class="message_embed"><a class="message_embed_image" href="https://github.com/srid/website/blob/master/src/Main.hs#L63" style="background-image: url(https://avatars2.githubusercontent.com/u/3998?s=400&amp;v=4)" target="_blank"></a><div class="data-container"><div class="message_embed_title"><a href="https://github.com/srid/website/blob/master/src/Main.hs#L63" target="_blank" title="srid/website">srid/website</a></div><div class="message_embed_description">Source for my website. Contribute to srid/website development by creating an account on GitHub.</div></div></div></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/45175015b9eb3dd3f6c740b3fe920fed?d=identicon&amp;version=1"></a><div class="content"><a class="author">Joel McCracken</a><div class="metadata"><a href="#185971921" name="185971921"><div>2020-01-18 00:47:00</div></a></div><div class="text"><p>oh sure</p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/45175015b9eb3dd3f6c740b3fe920fed?d=identicon&amp;version=1"></a><div class="content"><a class="author">Joel McCracken</a><div class="metadata"><a href="#185971935" name="185971935"><div>2020-01-18 00:47:15</div></a></div><div class="text"><p>well the only thing is i'd like to also have the actual source filename as well</p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/45175015b9eb3dd3f6c740b3fe920fed?d=identicon&amp;version=1"></a><div class="content"><a class="author">Joel McCracken</a><div class="metadata"><a href="#185971943" name="185971943"><div>2020-01-18 00:47:31</div></a></div><div class="text"><p>I suppose though that too could be optional</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/4429aa8b689608f24a4ad712843ce29862e330d2?x=x&amp;version=2"></a><div class="content"><a class="author">Sridhar Ratnakumar</a><div class="metadata"><a href="#185972021" name="185972021"><div>2020-01-18 00:48:49</div></a></div><div class="text"><p>If you can show me how your <code>Source2</code> type would look in code (in the context of your project), I can evaluate it better.</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/4429aa8b689608f24a4ad712843ce29862e330d2?x=x&amp;version=2"></a><div class="content"><a class="author">Sridhar Ratnakumar</a><div class="metadata"><a href="#185972039" name="185972039"><div>2020-01-18 00:49:20</div></a></div><div class="text"><p>(I gtg soon; but feel free to put it here or on Github issue)</p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/45175015b9eb3dd3f6c740b3fe920fed?d=identicon&amp;version=1"></a><div class="content"><a class="author">Joel McCracken</a><div class="metadata"><a href="#185972397" name="185972397"><div>2020-01-18 00:56:54</div></a></div><div class="text"><p>Na I think what you have is fine. I was mostly trying to say that it surprised me to see the dest filepath in the source data. But</p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/45175015b9eb3dd3f6c740b3fe920fed?d=identicon&amp;version=1"></a><div class="content"><a class="author">Joel McCracken</a><div class="metadata"><a href="#185972398" name="185972398"><div>2020-01-18 00:57:01</div></a></div><div class="text"><p>I can get around it fine</p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/45175015b9eb3dd3f6c740b3fe920fed?d=identicon&amp;version=1"></a><div class="content"><a class="author">Joel McCracken</a><div class="metadata"><a href="#185972410" name="185972410"><div>2020-01-18 00:57:23</div></a></div><div class="text"><p>and I can just ignore it too :)</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/4429aa8b689608f24a4ad712843ce29862e330d2?x=x&amp;version=2"></a><div class="content"><a class="author">Sridhar Ratnakumar</a><div class="metadata"><a href="#185972478" name="185972478"><div>2020-01-18 00:59:13</div></a></div><div class="text"><p>Still interested in looking at what your code looks like, so let me know when it is done, I'll take a look at your repo.</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/4429aa8b689608f24a4ad712843ce29862e330d2?x=x&amp;version=2"></a><div class="content"><a class="author">Sridhar Ratnakumar</a><div class="metadata"><a href="#185972491" name="185972491"><div>2020-01-18 00:59:58</div></a></div><div class="text"><p>In the early days I used a tuple <code>(FilePath, repr)</code>. Eg: <code>("/foo/bar.md", &lt;MMark doc&gt;)</code>.</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/4429aa8b689608f24a4ad712843ce29862e330d2?x=x&amp;version=2"></a><div class="content"><a class="author">Sridhar Ratnakumar</a><div class="metadata"><a href="#185972544" name="185972544"><div>2020-01-18 01:00:18</div></a></div><div class="text"><p>And then some function that converted /foo/bar.md to /foo/bar.html for using in the HTML rendering step.</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/4429aa8b689608f24a4ad712843ce29862e330d2?x=x&amp;version=2"></a><div class="content"><a class="author">Sridhar Ratnakumar</a><div class="metadata"><a href="#185972555" name="185972555"><div>2020-01-18 01:01:02</div></a></div><div class="text"><p>I figured why not put it in a ADT, and provide a simple <code>sourceUrl</code> function that gives the url to the rendered source. But it sounds like this URL in your case is something else ....</p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/45175015b9eb3dd3f6c740b3fe920fed?d=identicon&amp;version=1"></a><div class="content"><a class="author">Joel McCracken</a><div class="metadata"><a href="#185980686" name="185980686"><div>2020-01-18 05:23:56</div></a></div><div class="text"><p>Sure, will do</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/4429aa8b689608f24a4ad712843ce29862e330d2?x=x&amp;version=2"></a><div class="content"><a class="author">Sridhar Ratnakumar</a><div class="metadata"><a href="#186218484" name="186218484"><div>2020-01-21 19:35:50</div></a></div><div class="text"><p>I'm writing an IRC log viewer using rib. And hit the abstracation ceiling of <code>Source</code>. Specifically I want to determine the output file name from the parsed structure (which contains the channel name).</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/4429aa8b689608f24a4ad712843ce29862e330d2?x=x&amp;version=2"></a><div class="content"><a class="author">Sridhar Ratnakumar</a><div class="metadata"><a href="#186218685" name="186218685"><div>2020-01-21 19:37:42</div></a></div><div class="text"><p>It is basically impossible to customize <code>buildHtml</code> locally, because the <code>Source</code> constructor is not exported. Definitely a design smell that needs to be simplified, in the same manner as how I got rid of type classes.</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/4429aa8b689608f24a4ad712843ce29862e330d2?x=x&amp;version=2"></a><div class="content"><a class="author">Sridhar Ratnakumar</a><div class="metadata"><a href="#186220346" name="186220346"><div>2020-01-21 19:54:57</div></a></div><div class="text"><p><a href="https://github.com/srid/rib/pull/94" target="_blank" title="https://github.com/srid/rib/pull/94">https://github.com/srid/rib/pull/94</a></p>
<div class="message_embed"><a class="message_embed_image" href="https://github.com/srid/rib/pull/94" style="background-image: url(https://avatars2.githubusercontent.com/u/3998?s=400&amp;v=4)" target="_blank"></a><div class="data-container"><div class="message_embed_title"><a href="https://github.com/srid/rib/pull/94" target="_blank" title="Ability to customize the output filepath by srid · Pull Request #94 · srid/rib">Ability to customize the output filepath by srid · Pull Request #94 · srid/rib</a></div><div class="message_embed_description">Background:
I&#39;m writing an IRC log viewer using rib. And hit the abstracation ceiling of Source. Specifically I want to determine the output file name from the parsed structure (which contains ...</div></div></div></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/4429aa8b689608f24a4ad712843ce29862e330d2?x=x&amp;version=2"></a><div class="content"><a class="author">Sridhar Ratnakumar</a><div class="metadata"><a href="#186230665" name="186230665"><div>2020-01-21 21:37:01</div></a></div><div class="text"><p>I'm looking into the possibility of removing the <code>Source</code> type entirely</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/4429aa8b689608f24a4ad712843ce29862e330d2?x=x&amp;version=2"></a><div class="content"><a class="author">Sridhar Ratnakumar</a><div class="metadata"><a href="#186230689" name="186230689"><div>2020-01-21 21:37:15</div></a></div><div class="text"><p>Minimum info we need is the parsed type, and the URL to it.</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/4429aa8b689608f24a4ad712843ce29862e330d2?x=x&amp;version=2"></a><div class="content"><a class="author">Sridhar Ratnakumar</a><div class="metadata"><a href="#186232030" name="186232030"><div>2020-01-21 21:53:04</div></a></div><div class="text"><p>I think this URL is best constructed and defined manually by the user.</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/4429aa8b689608f24a4ad712843ce29862e330d2?x=x&amp;version=2"></a><div class="content"><a class="author">Sridhar Ratnakumar</a><div class="metadata"><a href="#186244985" name="186244985"><div>2020-01-22 00:52:29</div></a></div><div class="text"><p>Actually .. removing <code>Source</code> makes the user code rather verbose and ugly. For now, think I'll keep it.</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/4429aa8b689608f24a4ad712843ce29862e330d2?x=x&amp;version=2"></a><div class="content"><a class="author">Sridhar Ratnakumar</a><div class="metadata"><a href="#189369121" name="189369121"><div>2020-02-29 01:39:53</div></a></div><div class="text"><p><code>Source</code> type is now entirely gone, replaced by a Route-based mechanism which looks pretty cleaner to me. See  <a href="https://github.com/srid/rib-sample/commit/5a7f0c6d16efbd24065655b204c5ca11797439e6#diff-f8f3412da88cd4806f23d59fe59ebc3bR33" target="_blank" title="https://github.com/srid/rib-sample/commit/5a7f0c6d16efbd24065655b204c5ca11797439e6#diff-f8f3412da88cd4806f23d59fe59ebc3bR33">https://github.com/srid/rib-sample/commit/5a7f0c6d16efbd24065655b204c5ca11797439e6#diff-f8f3412da88cd4806f23d59fe59ebc3bR33</a></p>
<div class="message_embed"><a class="message_embed_image" href="https://github.com/srid/rib-sample/commit/5a7f0c6d16efbd24065655b204c5ca11797439e6#diff-f8f3412da88cd4806f23d59fe59ebc3bR33" style="background-image: url(https://avatars0.githubusercontent.com/u/3998?s=200&amp;v=4)" target="_blank"></a><div class="data-container"><div class="message_embed_title"><a href="https://github.com/srid/rib-sample/commit/5a7f0c6d16efbd24065655b204c5ca11797439e6#diff-f8f3412da88cd4806f23d59fe59ebc3bR33" target="_blank" title="Use the new Route type (#9) · srid/rib-sample@5a7f0c6">Use the new Route type (#9) · srid/rib-sample@5a7f0c6</a></div><div class="message_embed_description">Sample site for the Rib static site generator. Contribute to srid/rib-sample development by creating an account on GitHub.</div></div></div></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/4429aa8b689608f24a4ad712843ce29862e330d2?x=x&amp;version=2"></a><div class="content"><a class="author">Sridhar Ratnakumar</a><div class="metadata"><a href="#189369179" name="189369179"><div>2020-02-29 01:40:43</div></a></div><div class="text"><p>The function hook thingy (i.e. <code>readSource</code>) is gone as well. No more needless passing-function-to-function indirections. Just call your parser directly in Action monad. (example in that link)</p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/45175015b9eb3dd3f6c740b3fe920fed?d=identicon&amp;version=1"></a><div class="content"><a class="author">Joel McCracken</a><div class="metadata"><a href="#190323094" name="190323094"><div>2020-03-11 19:44:33</div></a></div><div class="text"><p>I ended up making my own sort-of source type</p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/45175015b9eb3dd3f6c740b3fe920fed?d=identicon&amp;version=1"></a><div class="content"><a class="author">Joel McCracken</a><div class="metadata"><a href="#190323109" name="190323109"><div>2020-03-11 19:44:41</div></a></div><div class="text"><p>that is just a tuple of like</p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/45175015b9eb3dd3f6c740b3fe920fed?d=identicon&amp;version=1"></a><div class="content"><a class="author">Joel McCracken</a><div class="metadata"><a href="#190323120" name="190323120"><div>2020-03-11 19:44:47</div></a></div><div class="text"><p>(Path, XmlDoc)</p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/45175015b9eb3dd3f6c740b3fe920fed?d=identicon&amp;version=1"></a><div class="content"><a class="author">Joel McCracken</a><div class="metadata"><a href="#190323157" name="190323157"><div>2020-03-11 19:45:17</div></a></div><div class="text"><p>Then there is a second type called ProcessedSource which includes the output destination</p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/45175015b9eb3dd3f6c740b3fe920fed?d=identicon&amp;version=1"></a><div class="content"><a class="author">Joel McCracken</a><div class="metadata"><a href="#190323168" name="190323168"><div>2020-03-11 19:45:25</div></a></div><div class="text"><p>this solved the weirness</p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/45175015b9eb3dd3f6c740b3fe920fed?d=identicon&amp;version=1"></a><div class="content"><a class="author">Joel McCracken</a><div class="metadata"><a href="#190323262" name="190323262"><div>2020-03-11 19:46:12</div></a></div><div class="text"><p>i like the new disign; basically it separates the process into:</p>
<ol>
<li>read the sources</li>
<li>process the sources/prepare for rendering</li>
<li>render the sources</li>
</ol></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/4429aa8b689608f24a4ad712843ce29862e330d2?x=x&amp;version=2"></a><div class="content"><a class="author">Sridhar Ratnakumar</a><div class="metadata"><a href="#190323269" name="190323269"><div>2020-03-11 19:46:19</div></a></div><div class="text"><p><span class="user-mention silent" data-user-id="252949">Joel McCracken</span> <a href="#narrow/stream/218047-Rib/topic/.60Source.60.20type/near/190323120" title="#narrow/stream/218047-Rib/topic/.60Source.60.20type/near/190323120">said</a>:</p>
<blockquote>
<p>(Path, XmlDoc)</p>
</blockquote>
<p>This is isomorphic to Rib.Route's <code>(r a, a)</code> basically, FWIW.</p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/45175015b9eb3dd3f6c740b3fe920fed?d=identicon&amp;version=1"></a><div class="content"><a class="author">Joel McCracken</a><div class="metadata"><a href="#190323280" name="190323280"><div>2020-03-11 19:46:30</div></a></div><div class="text"><p>yea</p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/45175015b9eb3dd3f6c740b3fe920fed?d=identicon&amp;version=1"></a><div class="content"><a class="author">Joel McCracken</a><div class="metadata"><a href="#190323284" name="190323284"><div>2020-03-11 19:46:32</div></a></div><div class="text"><p>totally is</p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/45175015b9eb3dd3f6c740b3fe920fed?d=identicon&amp;version=1"></a><div class="content"><a class="author">Joel McCracken</a><div class="metadata"><a href="#190323294" name="190323294"><div>2020-03-11 19:46:42</div></a></div><div class="text"><p>i'm still tyring to figure out if i want to use the route</p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/45175015b9eb3dd3f6c740b3fe920fed?d=identicon&amp;version=1"></a><div class="content"><a class="author">Joel McCracken</a><div class="metadata"><a href="#190323301" name="190323301"><div>2020-03-11 19:46:46</div></a></div><div class="text"><p>for now its easier to just not</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/4429aa8b689608f24a4ad712843ce29862e330d2?x=x&amp;version=2"></a><div class="content"><a class="author">Sridhar Ratnakumar</a><div class="metadata"><a href="#190323344" name="190323344"><div>2020-03-11 19:47:20</div></a></div><div class="text"><p>that's a sensible approach. you can use it when you need it. i designed Rib.Route after figuring out based on my various static sites.</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/4429aa8b689608f24a4ad712843ce29862e330d2?x=x&amp;version=2"></a><div class="content"><a class="author">Sridhar Ratnakumar</a><div class="metadata"><a href="#190323461" name="190323461"><div>2020-03-11 19:48:19</div></a></div><div class="text"><p><span class="user-mention silent" data-user-id="252949">Joel McCracken</span> <a href="#narrow/stream/218047-Rib/topic/.60Source.60.20type/near/190323157" title="#narrow/stream/218047-Rib/topic/.60Source.60.20type/near/190323157">said</a>:</p>
<blockquote>
<p>Then there is a second type called ProcessedSource which includes the output destination</p>
</blockquote>
<p>Also, this is why there is a <code>IsRoute</code> type class, to provide a <code>routeFile</code> (which <code>routeUrl</code> uses) that tells the output destination for a given route.</p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/45175015b9eb3dd3f6c740b3fe920fed?d=identicon&amp;version=1"></a><div class="content"><a class="author">Joel McCracken</a><div class="metadata"><a href="#190323472" name="190323472"><div>2020-03-11 19:48:25</div></a></div><div class="text"><p>I <em>think</em> it should work though</p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/45175015b9eb3dd3f6c740b3fe920fed?d=identicon&amp;version=1"></a><div class="content"><a class="author">Joel McCracken</a><div class="metadata"><a href="#190323488" name="190323488"><div>2020-03-11 19:48:34</div></a></div><div class="text"><p>yeah</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/4429aa8b689608f24a4ad712843ce29862e330d2?x=x&amp;version=2"></a><div class="content"><a class="author">Sridhar Ratnakumar</a><div class="metadata"><a href="#190323587" name="190323587"><div>2020-03-11 19:49:40</div></a></div><div class="text"><p><span class="user-mention silent" data-user-id="252949">Joel McCracken</span> <a href="#narrow/stream/218047-Rib/topic/.60Source.60.20type/near/190323262" title="#narrow/stream/218047-Rib/topic/.60Source.60.20type/near/190323262">said</a>:</p>
<blockquote>
<p>i like the new disign; basically it separates the process into:</p>
<ol>
<li>read the sources</li>
<li>process the sources/prepare for rendering</li>
<li>render the sources</li>
</ol>
</blockquote>
<p>Yes, you can get away with your own Shake action, and use only two functions from Rib: <code>forEvery</code> (for step 1), and <code>writeFileCached</code> (after step 3)</p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/45175015b9eb3dd3f6c740b3fe920fed?d=identicon&amp;version=1"></a><div class="content"><a class="author">Joel McCracken</a><div class="metadata"><a href="#190323613" name="190323613"><div>2020-03-11 19:49:55</div></a></div><div class="text"><p>yep!</p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/45175015b9eb3dd3f6c740b3fe920fed?d=identicon&amp;version=1"></a><div class="content"><a class="author">Joel McCracken</a><div class="metadata"><a href="#190323616" name="190323616"><div>2020-03-11 19:49:59</div></a></div><div class="text"><p>thats exactly what I am doing</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/4429aa8b689608f24a4ad712843ce29862e330d2?x=x&amp;version=2"></a><div class="content"><a class="author">Sridhar Ratnakumar</a><div class="metadata"><a href="#190323684" name="190323684"><div>2020-03-11 19:50:20</div></a></div><div class="text"><p>and <code>forEvery</code> is basically a 3-line function that wraps Shake's <code>forP</code></p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/45175015b9eb3dd3f6c740b3fe920fed?d=identicon&amp;version=1"></a><div class="content"><a class="author">Joel McCracken</a><div class="metadata"><a href="#190323759" name="190323759"><div>2020-03-11 19:51:28</div></a></div><div class="text"><p>I implemented it so my pjosts write to <code>entries/&lt;post-name&gt;/index.html</code> FYI</p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/45175015b9eb3dd3f6c740b3fe920fed?d=identicon&amp;version=1"></a><div class="content"><a class="author">Joel McCracken</a><div class="metadata"><a href="#190323793" name="190323793"><div>2020-03-11 19:51:48</div></a></div><div class="text"><p>oh thats what I was unsure about</p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/45175015b9eb3dd3f6c740b3fe920fed?d=identicon&amp;version=1"></a><div class="content"><a class="author">Joel McCracken</a><div class="metadata"><a href="#190323858" name="190323858"><div>2020-03-11 19:52:06</div></a></div><div class="text"><p>it seemed like I couldn't easaily separate where I am acrtually writing a file to with the URL I use for links</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/4429aa8b689608f24a4ad712843ce29862e330d2?x=x&amp;version=2"></a><div class="content"><a class="author">Sridhar Ratnakumar</a><div class="metadata"><a href="#190323897" name="190323897"><div>2020-03-11 19:52:32</div></a></div><div class="text"><p>?</p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/45175015b9eb3dd3f6c740b3fe920fed?d=identicon&amp;version=1"></a><div class="content"><a class="author">Joel McCracken</a><div class="metadata"><a href="#190323923" name="190323923"><div>2020-03-11 19:52:51</div></a></div><div class="text"><p>so what i mean is that i'd like to have my links look like <code>entries/fp-glossary</code> which would require the file to actally be written to <code>entries/fp-glossary/index.html</code></p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/45175015b9eb3dd3f6c740b3fe920fed?d=identicon&amp;version=1"></a><div class="content"><a class="author">Joel McCracken</a><div class="metadata"><a href="#190323978" name="190323978"><div>2020-03-11 19:53:27</div></a></div><div class="text"><p>oh wait! I am wrong</p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/45175015b9eb3dd3f6c740b3fe920fed?d=identicon&amp;version=1"></a><div class="content"><a class="author">Joel McCracken</a><div class="metadata"><a href="#190323989" name="190323989"><div>2020-03-11 19:53:35</div></a></div><div class="text"><p>looks like you explicitly programmed for that?</p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/45175015b9eb3dd3f6c740b3fe920fed?d=identicon&amp;version=1"></a><div class="content"><a class="author">Joel McCracken</a><div class="metadata"><a href="#190324042" name="190324042"><div>2020-03-11 19:54:00</div></a></div><div class="text"><p>in routeUrl'</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/4429aa8b689608f24a4ad712843ce29862e330d2?x=x&amp;version=2"></a><div class="content"><a class="author">Sridhar Ratnakumar</a><div class="metadata"><a href="#190324140" name="190324140"><div>2020-03-11 19:54:33</div></a></div><div class="text"><p>I do that "index.html" trick when implementing <code>IsRoute</code> instance for my Route, and <code>routeUrl</code> automatically strips the "index.html" because it is redundant for URLs.</p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/45175015b9eb3dd3f6c740b3fe920fed?d=identicon&amp;version=1"></a><div class="content"><a class="author">Joel McCracken</a><div class="metadata"><a href="#190324156" name="190324156"><div>2020-03-11 19:54:42</div></a></div><div class="text"><p>what i mean is that if I have my file written to <code>entries/fp-glossary/index.html</code>, then the generated link will be <code>entries/fp-glossary</code></p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/45175015b9eb3dd3f6c740b3fe920fed?d=identicon&amp;version=1"></a><div class="content"><a class="author">Joel McCracken</a><div class="metadata"><a href="#190324163" name="190324163"><div>2020-03-11 19:54:49</div></a></div><div class="text"><p>nice</p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/45175015b9eb3dd3f6c740b3fe920fed?d=identicon&amp;version=1"></a><div class="content"><a class="author">Joel McCracken</a><div class="metadata"><a href="#190324164" name="190324164"><div>2020-03-11 19:54:50</div></a></div><div class="text"><p>cool</p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/45175015b9eb3dd3f6c740b3fe920fed?d=identicon&amp;version=1"></a><div class="content"><a class="author">Joel McCracken</a><div class="metadata"><a href="#190324216" name="190324216"><div>2020-03-11 19:55:17</div></a></div><div class="text"><p>ill probably factor to it then when I'm done fixing a few things</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/4429aa8b689608f24a4ad712843ce29862e330d2?x=x&amp;version=2"></a><div class="content"><a class="author">Sridhar Ratnakumar</a><div class="metadata"><a href="#190324395" name="190324395"><div>2020-03-11 19:56:38</div></a></div><div class="text"><p>If you plan on using Route, you can start with a very basic implementation that has only one route:</p>
<div class="codehilite"><pre><span></span><span class="kr">class</span> <span class="kt">Route</span> <span class="n">a</span> <span class="kr">where</span>
  <span class="kt">Route_Whatever</span> <span class="ow">::</span> <span class="kt">Path</span> <span class="kt">Rel</span> <span class="kt">File</span> <span class="ow">-&gt;</span> <span class="kt">Route</span> <span class="kt">XmlDoc</span>

<span class="kr">instance</span> <span class="kt">IsRoute</span> <span class="kt">Route</span> <span class="kr">where</span>
  <span class="n">routeFile</span> <span class="ow">=</span> <span class="nf">\</span><span class="kr">case</span>
    <span class="kt">Route_Whatever</span> <span class="n">fp</span> <span class="ow">-&gt;</span> <span class="n">dropExtension</span> <span class="n">fp</span> <span class="o">&lt;/&gt;</span> <span class="p">[</span><span class="n">relfile</span><span class="o">|</span><span class="n">index</span><span class="o">.</span><span class="n">html</span><span class="o">|</span><span class="p">]</span> <span class="c1">-- something like this</span>
</pre></div></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/4429aa8b689608f24a4ad712843ce29862e330d2?x=x&amp;version=2"></a><div class="content"><a class="author">Sridhar Ratnakumar</a><div class="metadata"><a href="#190324556" name="190324556"><div>2020-03-11 19:58:04</div></a></div><div class="text"><p>And in future if you want to support non-xml docs, you can add another constructor, eg: <code>Route_NewStuff :: Path Rel File -&gt; Route Pandoc</code></p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/4429aa8b689608f24a4ad712843ce29862e330d2?x=x&amp;version=2"></a><div class="content"><a class="author">Sridhar Ratnakumar</a><div class="metadata"><a href="#190324940" name="190324940"><div>2020-03-11 20:01:53</div></a></div><div class="text"><p>Working code for that index.html trick with Routes here: <a href="https://github.com/open-editions/open-editions.org/blob/930888f/Main.hs#L54-L69" target="_blank" title="https://github.com/open-editions/open-editions.org/blob/930888f/Main.hs#L54-L69">https://github.com/open-editions/open-editions.org/blob/930888f/Main.hs#L54-L69</a></p>
<div class="message_embed"><a class="message_embed_image" href="https://github.com/open-editions/open-editions.org/blob/930888f/Main.hs#L54-L69" style="background-image: url(https://avatars3.githubusercontent.com/u/28928617?s=400&amp;v=4)" target="_blank"></a><div class="data-container"><div class="message_embed_title"><a href="https://github.com/open-editions/open-editions.org/blob/930888f/Main.hs#L54-L69" target="_blank" title="open-editions/open-editions.org">open-editions/open-editions.org</a></div><div class="message_embed_description">Open Editions website and infrastructure. Contribute to open-editions/open-editions.org development by creating an account on GitHub.</div></div></div></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/4429aa8b689608f24a4ad712843ce29862e330d2?x=x&amp;version=2"></a><div class="content"><a class="author">Sridhar Ratnakumar</a><div class="metadata"><a href="#190325601" name="190325601"><div>2020-03-11 20:08:09</div></a></div><div class="text"><p>Then, <code>(Route_Whatever fp, xmlDocForFp)</code> will be isomorphic to your <code>(Path, XmlDoc)</code> type, and the second type <code>ProcessedSource</code> becomes redundant! Because you can just use the former, and call <code>routeFile</code> on it to get the HTML file path.</p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/45175015b9eb3dd3f6c740b3fe920fed?d=identicon&amp;version=1"></a><div class="content"><a class="author">Joel McCracken</a><div class="metadata"><a href="#190325627" name="190325627"><div>2020-03-11 20:08:33</div></a></div><div class="text"><p>cool cool</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/4429aa8b689608f24a4ad712843ce29862e330d2?x=x&amp;version=2"></a><div class="content"><a class="author">Sridhar Ratnakumar</a><div class="metadata"><a href="#190325631" name="190325631"><div>2020-03-11 20:08:37</div></a></div><div class="text"><p>... with the added benefit of being able to use <code>routeUrl</code> on that value</p></div></div></div></div></div><div class="ui vertical footer segment"><a href="https://github.com/srid/zulip-archive">Powered by Haskell</a> | Questions? Contact <a href="https://www.srid.ca">srid</a></div></div></body></html>