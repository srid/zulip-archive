<html lang="en"><head><meta content="text/html; charset=utf-8" http-equiv="Content-Type"><meta content="width=device-width, initial-scale=1" name="viewport"><meta content="I seemed to have overlooked it? Why does neuron query include tags? And zettels via an indirection of &quot;zettels&quot;? image.png
" name="description"><link href="https://funprog.srid.ca/neuron/why-is-query-returning-tags.html" rel="canonical"><meta property="og:title" content="Why is query returning tags? - Neuron"><meta property="og:site_name" content="Functional Programming Zulip Archive"><meta property="og:type" content="article"><meta property="og:article:section" content="Neuron"><meta property="og:article:modified_time" content="2020-04-16T14:51:16Z"><meta property="og:article:published_time" content="2020-04-16T03:07:33Z"><meta property="og:image" content="https://zulip-avatars.s3.amazonaws.com/13896/4429aa8b689608f24a4ad712843ce29862e330d2?x=x&amp;version=2"><title>Why is query returning tags? - Neuron</title><style type="text/css">
div#thesite
{
  font-family   : "Open Sans", sans-serif;
  font-size     : 1em !important;
  margin-top    : 1em;
  margin-bottom : 1em;
}

div#thesite h1
{
  font-family : "Roboto", sans-serif;
  line-height : 1.19999em;
}

div#thesite h2
{
  font-family : "Roboto", sans-serif;
  line-height : 1.19999em;
}

div#thesite h3
{
  font-family : "Roboto", sans-serif;
  line-height : 1.19999em;
}

div#thesite h4
{
  font-family : "Roboto", sans-serif;
  line-height : 1.19999em;
}

div#thesite h5
{
  font-family : "Roboto", sans-serif;
  line-height : 1.19999em;
}

div#thesite h6
{
  font-family : "Roboto", sans-serif;
  line-height : 1.19999em;
}

div#thesite .ui.breadcrumb.rib .section
{
  font-family : "Roboto", sans-serif;
  line-height : 1.19999em;
}

div#thesite .header
{
  font-family : "Roboto", sans-serif;
  line-height : 1.19999em;
}

div#thesite .as-header
{
  font-family : "Roboto", sans-serif;
  line-height : 1.19999em;
}

div#thesite code, pre, tt
{
  font-family : "SFMono-Regular","Menlo","Monaco","Consolas","Liberation Mono","Courier New", monospace;
}

div#thesite .ui.breadcrumb.rib
{
  margin-bottom : 1em;
}



div#thesite .ui.comments.messages .comment .metadata a
{
  color : #808080;
}

div#thesite .ui.comments.messages .comment a.avatar img
{
  height : auto;
}

div#thesite .subtle
{
  color : #808080;
}


div#thesite .messages pre
{
  font-size : 85%;
  overflow  : auto;
  max-width : 100%;
}

div#thesite .messages .message_embed
{
  border-left  : solid 3px #808080;
  padding-left : 0.69999em;
}

div#thesite .messages .message_inline_image img
{
  max-width     : 100%;
  margin-bottom : 1em;
}


/* Generated with Clay, http://fvisser.nl/clay */</style><link href="https://cdnjs.cloudflare.com/ajax/libs/semantic-ui/2.4.1/semantic.min.css" rel="stylesheet"><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css" rel="stylesheet"><link href="https://fonts.googleapis.com/css?family=Open+Sans|Oswald&amp;display=swap" rel="stylesheet"><link href="https://fonts.googleapis.com/css?family=Roboto|Open+Sans&amp;display=swap" rel="stylesheet"></head><body><div id="thesite" class="ui text container"><div class="ui violet inverted top attached center aligned segment"><h1 class="ui huge header">Why is query returning tags? - Neuron</h1></div><div class="ui attached segment"><div class="ui message"><p>Welcome to the Functional Programming Zulip Chat Archive. You can join the chat <a href="https://funprog.zulipchat.com">here</a>.</p></div><div class="ui breadcrumb rib"><a href="/" class="section">Home</a><i class="right angle icon divider"></i><a href="/neuron/" class="section">#Neuron</a><i class="right angle icon divider"></i><div class="active section">Why is query returning tags?</div></div><div class="ui comments messages"><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/4429aa8b689608f24a4ad712843ce29862e330d2?x=x&amp;version=2"></a><div class="content"><a class="author">Sridhar Ratnakumar</a><div class="metadata"><a href="#194253845" name="194253845"><div>2020-04-16 03:07:33</div></a></div><div class="text"><p>I seemed to have overlooked it? Why does <code>neuron query</code> include tags? And zettels via an indirection of "zettels"? <a href="/user_uploads/13896/kIcso2MrUhVBesS3YeMISsXt/image.png" title="image.png">image.png</a></p>
<div class="message_inline_image"><a href="/user_uploads/13896/kIcso2MrUhVBesS3YeMISsXt/image.png" title="image.png"><img src="/user_uploads/13896/kIcso2MrUhVBesS3YeMISsXt/image.png"></a></div></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/4429aa8b689608f24a4ad712843ce29862e330d2?x=x&amp;version=2"></a><div class="content"><a class="author">Sridhar Ratnakumar</a><div class="metadata"><a href="#194253848" name="194253848"><div>2020-04-16 03:07:44</div></a></div><div class="text"><p><span class="user-mention" data-user-id="276419">@felko</span></p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/39430c3a1d5705ad377af9607e67d98c?d=identicon&amp;version=1"></a><div class="content"><a class="author">felko</a><div class="metadata"><a href="#194262540" name="194262540"><div>2020-04-16 06:43:47</div></a></div><div class="text"><p>That's because I wanted to generate the JSON index from an empty query, I needed the tags for the web search to implement tag filtering. The tags are accumulated from all the zettels that match the query, so effectively an empty query returns all the tags that are used in the zettelkasten, which was also supposed to prepare support for the <code>--list-tags</code> query. Another use is that once we switch to GHCJS (miso looks really cool btw), we could maybe run the query dynamically and only suggest tag filters that have results in the dropdown. Would you rather prefer to generate the index other than with a query? My concern was that it would require to iterate through all zettels twice, once for accumulating all zettels, and another for accumulating the tags.<br>
I should have adapted <code>neuron query</code> to return only the zettels though, and maybe provide a <code>--dump-tags</code> argument if the user wants them anyway.</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/4429aa8b689608f24a4ad712843ce29862e330d2?x=x&amp;version=2"></a><div class="content"><a class="author">Sridhar Ratnakumar</a><div class="metadata"><a href="#194314259" name="194314259"><div>2020-04-16 14:40:55</div></a></div><div class="text"><p>In general, it is a good idea to do any "customization" close to the place where it is needed, instead of modifying the behaviour of the core function. <code>runQuery</code> should continue to return a list of zettels, and <code>neuron query</code> should just produce a JSON of a list of zettels, as before. If one of the callers (search.html in this case) wants extra data, it should produce its own JSON.</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/4429aa8b689608f24a4ad712843ce29862e330d2?x=x&amp;version=2"></a><div class="content"><a class="author">Sridhar Ratnakumar</a><div class="metadata"><a href="#194314565" name="194314565"><div>2020-04-16 14:42:49</div></a></div><div class="text"><p>If we want to query tags, we could do something like this:</p>
<div class="codehilite"><pre><span></span><span class="kr">data</span> <span class="kt">QueryZettel</span> <span class="ow">=</span> <span class="kt">ByTag</span> <span class="kt">Tag</span>
<span class="kr">data</span> <span class="kt">QueryTag</span>
<span class="kr">type</span> <span class="kt">Query</span> <span class="ow">=</span> <span class="kt">Either</span> <span class="kt">QueryZettel</span> <span class="kt">QueryTag</span>
<span class="nf">runQueryZettel</span> <span class="ow">::</span> <span class="p">[</span><span class="kt">QueryZettel</span><span class="p">]</span> <span class="ow">-&gt;</span> <span class="p">[</span><span class="kt">Zettel</span><span class="p">]</span>
<span class="nf">runQueryTag</span> <span class="ow">::</span> <span class="kt">QueryTag</span> <span class="ow">-&gt;</span> <span class="p">[</span><span class="kt">Tag</span><span class="p">]</span>
</pre></div>


<p>Or something like this. It keeps the user requirement of "a way to query zettels" intact and simple, while also supporting other results.</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/4429aa8b689608f24a4ad712843ce29862e330d2?x=x&amp;version=2"></a><div class="content"><a class="author">Sridhar Ratnakumar</a><div class="metadata"><a href="#194314629" name="194314629"><div>2020-04-16 14:43:12</div></a></div><div class="text"><p>(That's just an example, btw. I'm not sure if that's the best way to define it)</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/4429aa8b689608f24a4ad712843ce29862e330d2?x=x&amp;version=2"></a><div class="content"><a class="author">Sridhar Ratnakumar</a><div class="metadata"><a href="#194315177" name="194315177"><div>2020-04-16 14:46:30</div></a></div><div class="text"><p>I'll open a PR to make the change so that only zettens are produced by the query command. I don't think tags is used in <a href="https://github.com/felko/zettel-mode/blob/master/zettel-mode.el" title="https://github.com/felko/zettel-mode/blob/master/zettel-mode.el">https://github.com/felko/zettel-mode/blob/master/zettel-mode.el</a> <span class="user-mention" data-user-id="276419">@felko</span>  - but I imagine it woud be useful in future. So something like <code>neuron query --list-tags</code> can be added (CLI spec being: <code>(--list-tags | --tag TAG | --uri)</code>).</p>
<div class="message_embed"><a class="message_embed_image" href="https://github.com/felko/zettel-mode/blob/master/zettel-mode.el" style="background-image: url(https://avatars1.githubusercontent.com/u/9366592?s=400&amp;v=4)"></a><div class="data-container"><div class="message_embed_title"><a href="https://github.com/felko/zettel-mode/blob/master/zettel-mode.el" title="felko/zettel-mode">felko/zettel-mode</a></div><div class="message_embed_description">An emacs mode for editing Zettelkasten notes with neuron - felko/zettel-mode</div></div></div></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/4429aa8b689608f24a4ad712843ce29862e330d2?x=x&amp;version=2"></a><div class="content"><a class="author">Sridhar Ratnakumar</a><div class="metadata"><a href="#194315282" name="194315282"><div>2020-04-16 14:47:13</div></a></div><div class="text"><p><code>--list-tags</code> would return a JSON of list of tags. The others would print a JSON of list of zettels. No mixing of types here; to keep things simple.</p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/39430c3a1d5705ad377af9607e67d98c?d=identicon&amp;version=1"></a><div class="content"><a class="author">felko</a><div class="metadata"><a href="#194315898" name="194315898"><div>2020-04-16 14:50:59</div></a></div><div class="text"><p>Yeah indeed, that's a better interface<br>
I was planning on using tags in zettel-mode.el to select tags from already existing ones, which would avoid creating duplicates (something you mentioned a few days ago I believe)</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/4429aa8b689608f24a4ad712843ce29862e330d2?x=x&amp;version=2"></a><div class="content"><a class="author">Sridhar Ratnakumar</a><div class="metadata"><a href="#194315939" name="194315939"><div>2020-04-16 14:51:16</div></a></div><div class="text"><p>Yea, I want that feature as well!</p></div></div></div></div></div><div class="ui vertical footer segment"><a href="https://github.com/srid/zulip-archive">Powered by Haskell</a> | Questions? Contact <a href="https://www.srid.ca">srid</a></div></div></body></html>