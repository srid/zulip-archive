<html lang="en"><head><meta content="text/html; charset=utf-8" http-equiv="Content-Type"><meta content="width=device-width, initial-scale=1" name="viewport"><meta content="Not sure what the right name for this notion is ... but I&#39;m looking for: 
constEffect :: Sem (eff &#39;: r) -&gt; Sem (eff &#39;: nil &#39;: r)



The idea is that if I have a &#39;eff&#39; program, and I want to create another program that includes instructions from &#39;eff&#39; and &#39;nil&#39; effects, return me that program even th" name="description"><link href="https://funprog.srid.ca/polysemy/const-effect.html" rel="canonical"><meta property="og:title" content="Const effect? - Polysemy"><meta property="og:site_name" content="Functional Programming Zulip Archive"><meta property="og:type" content="article"><meta property="og:article:section" content="Polysemy"><meta property="og:article:modified_time" content="2020-02-24T09:15:50Z"><meta property="og:article:published_time" content="2020-02-18T19:54:29Z"><meta property="og:image" content="https://zulip-avatars.s3.amazonaws.com/13896/4429aa8b689608f24a4ad712843ce29862e330d2?x=x&amp;version=2"><title>Const effect? - Polysemy</title><style type="text/css">
div#thesite
{
  font-family   : "Open Sans", sans-serif;
  font-size     : 1em !important;
  margin-top    : 1em;
  margin-bottom : 1em;
}

div#thesite h1
{
  font-family : "Roboto", sans-serif;
  line-height : 1.19999em;
}

div#thesite h2
{
  font-family : "Roboto", sans-serif;
  line-height : 1.19999em;
}

div#thesite h3
{
  font-family : "Roboto", sans-serif;
  line-height : 1.19999em;
}

div#thesite h4
{
  font-family : "Roboto", sans-serif;
  line-height : 1.19999em;
}

div#thesite h5
{
  font-family : "Roboto", sans-serif;
  line-height : 1.19999em;
}

div#thesite h6
{
  font-family : "Roboto", sans-serif;
  line-height : 1.19999em;
}

div#thesite .ui.breadcrumb.rib .section
{
  font-family : "Roboto", sans-serif;
  line-height : 1.19999em;
}

div#thesite .header
{
  font-family : "Roboto", sans-serif;
  line-height : 1.19999em;
}

div#thesite .as-header
{
  font-family : "Roboto", sans-serif;
  line-height : 1.19999em;
}

div#thesite code, pre, tt
{
  font-family : "SFMono-Regular","Menlo","Monaco","Consolas","Liberation Mono","Courier New", monospace;
}

div#thesite .ui.breadcrumb.rib
{
  margin-bottom : 1em;
}



div#thesite .ui.comments.messages .comment .metadata a
{
  color : #808080;
}

div#thesite .ui.comments.messages .comment a.avatar img
{
  height : auto;
}

div#thesite .subtle
{
  color : #808080;
}


div#thesite .messages pre
{
  font-size : 85%;
  overflow  : auto;
  max-width : 100%;
}

div#thesite .messages .message_embed
{
  border-left  : solid 3px #808080;
  padding-left : 0.69999em;
}

div#thesite .messages .message_inline_image img
{
  max-width     : 100%;
  margin-bottom : 1em;
}


/* Generated with Clay, http://fvisser.nl/clay */</style><link href="https://cdnjs.cloudflare.com/ajax/libs/semantic-ui/2.4.1/semantic.min.css" rel="stylesheet"><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css" rel="stylesheet"><link href="https://fonts.googleapis.com/css?family=Open+Sans|Oswald&amp;display=swap" rel="stylesheet"><link href="https://fonts.googleapis.com/css?family=Roboto|Open+Sans&amp;display=swap" rel="stylesheet"></head><body><div id="thesite" class="ui text container"><div class="ui violet inverted top attached center aligned segment"><h1 class="ui huge header">Const effect? - Polysemy</h1></div><div class="ui attached segment"><div class="ui message"><p>Welcome to the Functional Programming Zulip Chat Archive. You can join the chat <a href="https://funprog.zulipchat.com">here</a>.</p></div><div class="ui breadcrumb rib"><a href="/" class="section">Home</a><i class="right angle icon divider"></i><a href="/polysemy/" class="section">#Polysemy</a><i class="right angle icon divider"></i><div class="active section">Const effect?</div></div><div class="ui comments messages"><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/4429aa8b689608f24a4ad712843ce29862e330d2?x=x&amp;version=2"></a><div class="content"><a class="author">Sridhar Ratnakumar</a><div class="metadata"><a href="#188485207" name="188485207"><div>2020-02-18 19:54:29</div></a></div><div class="text"><p>Not sure what the right name for this notion is ... but I'm looking for: </p>
<div class="codehilite"><pre><span></span><span class="nf">constEffect</span> <span class="ow">::</span> <span class="kt">Sem</span> <span class="p">(</span><span class="n">eff</span> <span class="sc">&#39;</span><span class="err">: r) -&gt; Sem (eff</span><span class="sc"> &#39;</span><span class="kt">:</span> <span class="n">nil</span> <span class="sc">&#39;</span><span class="err">: r)</span>
</pre></div>


<p>The idea is that if I have a 'eff' program, and I want to create another program that includes instructions from 'eff' and 'nil' effects, return me that program even though the actual program contains instructions only from 'eff'.</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/4429aa8b689608f24a4ad712843ce29862e330d2?x=x&amp;version=2"></a><div class="content"><a class="author">Sridhar Ratnakumar</a><div class="metadata"><a href="#188485242" name="188485242"><div>2020-02-18 19:55:09</div></a></div><div class="text"><p>(I do some funky merging of multiple effects, but some functions only give programs with individual effects.)</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/4429aa8b689608f24a4ad712843ce29862e330d2?x=x&amp;version=2"></a><div class="content"><a class="author">Sridhar Ratnakumar</a><div class="metadata"><a href="#188485389" name="188485389"><div>2020-02-18 19:56:54</div></a></div><div class="text"><p>The mtl analog would be <code>lift</code>, right?</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/20a04d823b7c3891d78ca5f6a188ccd0e4fc5e3d?x=x&amp;version=2"></a><div class="content"><a class="author">TheMatten</a><div class="metadata"><a href="#188485401" name="188485401"><div>2020-02-18 19:57:04</div></a></div><div class="text"><p>There's internal <code>raiseUnder</code> (I don't think it's internal for any serious reason)</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/4429aa8b689608f24a4ad712843ce29862e330d2?x=x&amp;version=2"></a><div class="content"><a class="author">Sridhar Ratnakumar</a><div class="metadata"><a href="#188485460" name="188485460"><div>2020-02-18 19:57:47</div></a></div><div class="text"><p>Oh thanks! That actually compiled haha</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/20a04d823b7c3891d78ca5f6a188ccd0e4fc5e3d?x=x&amp;version=2"></a><div class="content"><a class="author">TheMatten</a><div class="metadata"><a href="#188485475" name="188485475"><div>2020-02-18 19:57:56</div></a></div><div class="text"><p>I think <code>lift</code> corresponds to <code>raise</code>, which adds layer on top</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/20a04d823b7c3891d78ca5f6a188ccd0e4fc5e3d?x=x&amp;version=2"></a><div class="content"><a class="author">TheMatten</a><div class="metadata"><a href="#188485593" name="188485593"><div>2020-02-18 19:58:58</div></a></div><div class="text"><p>Hmm, I wonder if there's anything inherently unsafe in <code>Polysemy.Internal</code> <span aria-label="thinking" class="emoji emoji-1f914" role="img" title="thinking">:thinking:</span></p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/4429aa8b689608f24a4ad712843ce29862e330d2?x=x&amp;version=2"></a><div class="content"><a class="author">Sridhar Ratnakumar</a><div class="metadata"><a href="#188486920" name="188486920"><div>2020-02-18 20:15:25</div></a></div><div class="text"><p>Can <code>raise</code> (or <code>raise . raise ....</code>) be avoided in the case of a program that supports multiple effects?</p>
<div class="codehilite"><pre><span></span><span class="nf">someProg</span> <span class="ow">::</span> <span class="kt">Sem</span> <span class="kt">&#39;[A, B, C]</span> <span class="ow">-&gt;</span> <span class="p">(</span><span class="kt">AVal</span><span class="p">,</span> <span class="kt">BVal</span><span class="p">,</span> <span class="kt">CVal</span><span class="p">)</span>
<span class="nf">someProg</span> <span class="n">prog</span> <span class="ow">=</span> <span class="n">runWithPlugins</span> <span class="n">prog</span>

<span class="nf">someProg</span> <span class="o">$</span> <span class="kr">do</span>
  <span class="n">commandFromA</span>
  <span class="n">raise</span> <span class="o">$</span> <span class="n">commandFromB</span>
  <span class="n">raise</span> <span class="o">$</span> <span class="n">raise</span> <span class="o">$</span> <span class="n">commandFromC</span>
</pre></div></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/4429aa8b689608f24a4ad712843ce29862e330d2?x=x&amp;version=2"></a><div class="content"><a class="author">Sridhar Ratnakumar</a><div class="metadata"><a href="#188487010" name="188487010"><div>2020-02-18 20:16:23</div></a></div><div class="text"><p>Think of A, B, C as "plugins" in my software. At the user level I want the plugins to provide the commands the user (me) is supposed to use to write their program in. Having to use 'raise' brings in the knowledge of plugin hierarchy, which is an abstraction leak.</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/20a04d823b7c3891d78ca5f6a188ccd0e4fc5e3d?x=x&amp;version=2"></a><div class="content"><a class="author">TheMatten</a><div class="metadata"><a href="#188487602" name="188487602"><div>2020-02-18 20:23:44</div></a></div><div class="text"><p>Oh, you don't want to be concrete in rows of effectful computations - that's something for interpreters/combinators - instead write <code>Members '[A, B, C] r =&gt; Sem r a</code></p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/4429aa8b689608f24a4ad712843ce29862e330d2?x=x&amp;version=2"></a><div class="content"><a class="author">Sridhar Ratnakumar</a><div class="metadata"><a href="#188487747" name="188487747"><div>2020-02-18 20:25:35</div></a></div><div class="text"><p>But with <code>Members</code> you can't specify that A, B, C are the exclusive list of effects (i.e., there are no other effects), can you?</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/20a04d823b7c3891d78ca5f6a188ccd0e4fc5e3d?x=x&amp;version=2"></a><div class="content"><a class="author">TheMatten</a><div class="metadata"><a href="#188488248" name="188488248"><div>2020-02-18 20:31:37</div></a></div><div class="text"><p><code>commandFrom{A,B,C}</code> should be polymorphic - <code>someProg</code> is final, concrete interpreter</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/4429aa8b689608f24a4ad712843ce29862e330d2?x=x&amp;version=2"></a><div class="content"><a class="author">Sridhar Ratnakumar</a><div class="metadata"><a href="#188489247" name="188489247"><div>2020-02-18 20:44:56</div></a></div><div class="text"><p>Gotcha. I had several functions defined monomorphically using <code>Sem '[...] a</code>. That was the culprit.</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/4429aa8b689608f24a4ad712843ce29862e330d2?x=x&amp;version=2"></a><div class="content"><a class="author">Sridhar Ratnakumar</a><div class="metadata"><a href="#188489274" name="188489274"><div>2020-02-18 20:45:20</div></a></div><div class="text"><p>This now getting to be fun.</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/f1ec33bcc6144366b30e479d6b3bed74cdb9f611?x=x&amp;version=4"></a><div class="content"><a class="author">Love Waern (King of the Homeless)</a><div class="metadata"><a href="#188909963" name="188909963"><div>2020-02-24 09:15:50</div></a></div><div class="text"><p><code>raiseUnder</code> ain't internal. Use it as muxh you want.</p></div></div></div></div></div><div class="ui vertical footer segment"><a href="https://github.com/srid/zulip-archive">Powered by Haskell</a></div></div></body></html>