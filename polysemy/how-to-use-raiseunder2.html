<html lang="en"><head><meta content="text/html; charset=utf-8" http-equiv="Content-Type"><meta content="width=device-width, initial-scale=1" name="viewport"><meta content="Hi, could someone explain how to use raiseUnder2/3. I&#39;m trying to turn this into a reinterpreting version.
  -- | Cut a `Methodology` into two pieces at a midpoint.
  cutMethodology :: forall b c d r a.
                    Members &#39;[ Methodology b c
                             , Methodology c d] r
" name="description"><link href="https://funprog.srid.ca/polysemy/how-to-use-raiseunder2.html" rel="canonical"><meta property="og:title" content="How to use raiseUnder2 - Polysemy"><meta property="og:site_name" content="Functional Programming Zulip Archive"><meta property="og:type" content="article"><meta property="og:article:section" content="Polysemy"><meta property="og:article:modified_time" content="2020-11-08T22:24:24Z"><meta property="og:article:published_time" content="2020-11-08T20:24:23Z"><title>How to use raiseUnder2 - Polysemy</title><style type="text/css">
div#thesite
{
  font-family   : "Open Sans", sans-serif;
  font-size     : 1em !important;
  margin-top    : 1em;
  margin-bottom : 1em;
}

div#thesite h1
{
  font-family : "Roboto", sans-serif;
  line-height : 1.19999em;
}

div#thesite h2
{
  font-family : "Roboto", sans-serif;
  line-height : 1.19999em;
}

div#thesite h3
{
  font-family : "Roboto", sans-serif;
  line-height : 1.19999em;
}

div#thesite h4
{
  font-family : "Roboto", sans-serif;
  line-height : 1.19999em;
}

div#thesite h5
{
  font-family : "Roboto", sans-serif;
  line-height : 1.19999em;
}

div#thesite h6
{
  font-family : "Roboto", sans-serif;
  line-height : 1.19999em;
}

div#thesite .ui.breadcrumb.rib .section
{
  font-family : "Roboto", sans-serif;
  line-height : 1.19999em;
}

div#thesite .header
{
  font-family : "Roboto", sans-serif;
  line-height : 1.19999em;
}

div#thesite .as-header
{
  font-family : "Roboto", sans-serif;
  line-height : 1.19999em;
}

div#thesite code, pre, tt
{
  font-family : "SFMono-Regular","Menlo","Monaco","Consolas","Liberation Mono","Courier New", monospace;
}

div#thesite .ui.breadcrumb.rib
{
  margin-bottom : 1em;
}



div#thesite .ui.comments.messages .comment .metadata a
{
  color : #808080;
}

div#thesite .ui.comments.messages .comment a.avatar img
{
  height : auto;
}

div#thesite .subtle
{
  color : #808080;
}


div#thesite .messages pre
{
  font-size : 85%;
  overflow  : auto;
  max-width : 100%;
}

div#thesite .messages .message_embed
{
  border-left  : solid 3px #808080;
  padding-left : 0.69999em;
}

div#thesite .messages .message_inline_image img
{
  max-width     : 100%;
  margin-bottom : 1em;
}


/* Generated with Clay, http://fvisser.nl/clay */</style><link href="https://cdnjs.cloudflare.com/ajax/libs/semantic-ui/2.4.1/semantic.min.css" rel="stylesheet"><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css" rel="stylesheet"><link href="https://fonts.googleapis.com/css?family=Open+Sans|Oswald&amp;display=swap" rel="stylesheet"><link href="https://fonts.googleapis.com/css?family=Roboto|Open+Sans&amp;display=swap" rel="stylesheet"></head><body><div id="thesite" class="ui text container"><div class="ui violet inverted top attached center aligned segment"><h1 class="ui huge header">How to use raiseUnder2 - Polysemy</h1></div><div class="ui attached segment"><div class="ui message"><p>Welcome to the Functional Programming Zulip Chat Archive. You can join the chat <a href="https://funprog.zulipchat.com">here</a>.</p></div><div class="ui breadcrumb rib"><a href="/" class="section">Home</a><i class="right angle icon divider"></i><a href="/polysemy/" class="section">#Polysemy</a><i class="right angle icon divider"></i><div class="active section">How to use raiseUnder2</div></div><div class="ui comments messages"><div class="comment"><a class="avatar"><img src="https://www.gravatar.com/avatar/3f02fadd6146855b37247afc22b39685"></a><div class="content"><a class="author">locallycompact</a><div class="metadata"><a href="#216023727" name="216023727"><div>2020-11-08 20:24:23</div></a></div><div class="text"><p>Hi, could someone explain how to use raiseUnder2/3. I'm trying to turn this into a reinterpreting version.</p>
<div class="codehilite"><pre><span></span><code>  -- | Cut a `Methodology` into two pieces at a midpoint.
  cutMethodology :: forall b c d r a.
                    Members &#39;[ Methodology b c
                             , Methodology c d] r
                 =&gt; Sem (Methodology b d &#39;: r) a
                 -&gt; Sem r a
  cutMethodology = interpret \case
    Process b -&gt; process @b @c b &gt;&gt;= process @c @d
</code></pre></div>
<p>So I do</p>
<div class="codehilite"><pre><span></span><code>cutMethodology&#39; :: forall b c d r a.
                         Sem (Methodology b d &#39;: r) a
                    -&gt; Sem (Methodology b c &#39;: Methodology c d &#39;: r) a
cutMethodology&#39; = raiseUnder2 &gt;&gt;&gt; cutMethodology @b @c @d
</code></pre></div>
<p>But then I get</p>
<div class="codehilite"><pre><span></span><code>error:
    • Couldn&#39;t match ‘c’ with ‘b’
        arising from a use of ‘cutMethodology’
      ‘c’ is a rigid type variable bound by
        cutMethodology&#39; :: forall b c d (r :: [(* -&gt; *) -&gt; * -&gt; *]) a.
                             Sem (Methodology b d : r) a
                             -&gt; Sem (Methodology b c : Methodology c d : r) a
        at /home/lc/Source/gitlab.com/homotopic-tech/flashblast/src/FlashBlast/Domain.hs:(51,1)-(53,72)
      ‘b’ is a rigid type variable bound by
        cutMethodology&#39; :: forall b c d (r :: [(* -&gt; *) -&gt; * -&gt; *]) a.
                             Sem (Methodology b d : r) a
                             -&gt; Sem (Methodology b c : Methodology c d : r) a
        at /home/lc/Source/gitlab.com/homotopic-tech/flashblast/src/FlashBlast/Domain.hs:(51,1)-(53,72)
    • Known types:
        cutMethodology&#39; :: Sem (Methodology b d : r) a
                           -&gt; Sem (Methodology b c : Methodology c d : r) a
           -- /home/lc/Source/gitlab.com/homotopic-tech/flashblast/src/FlashBlast/Domain.hs:54:1
   |
54 | cutMethodology&#39; = raiseUnder2 &gt;&gt;&gt; cutMethodology @b @c @d
</code></pre></div>
<p>Shouldn't this work?</p></div></div></div><div class="comment"><a class="avatar"><img src="https://www.gravatar.com/avatar/1114fd8de67671f83d3a3ef7594b1950"></a><div class="content"><a class="author">Georgi Lyubenov // googleson78</a><div class="metadata"><a href="#216024581" name="216024581"><div>2020-11-08 20:47:48</div></a></div><div class="text"><p>honestly kind of hard to debug for me without explicit code</p></div></div></div><div class="comment"><a class="avatar"><img src="https://www.gravatar.com/avatar/1114fd8de67671f83d3a3ef7594b1950"></a><div class="content"><a class="author">Georgi Lyubenov // googleson78</a><div class="metadata"><a href="#216024585" name="216024585"><div>2020-11-08 20:47:57</div></a></div><div class="text"><p>did you try adding explicit types to <strong>everything</strong>?</p></div></div></div><div class="comment"><a class="avatar"><img src="https://www.gravatar.com/avatar/1114fd8de67671f83d3a3ef7594b1950"></a><div class="content"><a class="author">Georgi Lyubenov // googleson78</a><div class="metadata"><a href="#216024636" name="216024636"><div>2020-11-08 20:48:18</div></a></div><div class="text"><p>also, try doing the eta expanded version, although it's probably not an issue here</p></div></div></div><div class="comment"><a class="avatar"><img src="https://www.gravatar.com/avatar/3f02fadd6146855b37247afc22b39685"></a><div class="content"><a class="author">locallycompact</a><div class="metadata"><a href="#216024709" name="216024709"><div>2020-11-08 20:50:06</div></a></div><div class="text"><p>It compiles successfully with concrete types.</p>
<div class="codehilite"><pre><span></span><code>cutMethodology&#39; :: forall r a.
                           Sem (Methodology Text Int &#39;: r) a
                        -&gt; Sem (Methodology Text String &#39;: Methodology String Int &#39;: r) a
 cutMethodology&#39; = raiseUnder2 &gt;&gt;&gt; cutMethodology
</code></pre></div></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/7334dc60b6aef6a75cd9284126231f13c76926a5?version=6"></a><div class="content"><a class="author">Torsten Schmits</a><div class="metadata"><a href="#216024731" name="216024731"><div>2020-11-08 20:51:09</div></a></div><div class="text"><p>I'd guess it's enough to add type applications to <code>raiseUnder2</code></p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/7334dc60b6aef6a75cd9284126231f13c76926a5?version=6"></a><div class="content"><a class="author">Torsten Schmits</a><div class="metadata"><a href="#216024737" name="216024737"><div>2020-11-08 20:51:34</div></a></div><div class="text"><p>or maybe just use <code>(.)</code> instead of <code>(&gt;&gt;&gt;)</code></p></div></div></div><div class="comment"><a class="avatar"><img src="https://www.gravatar.com/avatar/3f02fadd6146855b37247afc22b39685"></a><div class="content"><a class="author">locallycompact</a><div class="metadata"><a href="#216024911" name="216024911"><div>2020-11-08 20:55:20</div></a></div><div class="text"><p>Mmm no combination of those work. Same error like this:</p>
<div class="codehilite"><pre><span></span><code>cutMethodology&#39; :: forall b c d r a.
                           Sem (Methodology b d &#39;: r) a
                      -&gt; Sem (Methodology b c &#39;: Methodology c d &#39;: r) a
cutMethodology&#39; f = f &amp; raiseUnder2 @(Methodology b c) @(Methodology c d)
                        &amp; cutMethodology @b @c @d
</code></pre></div></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/7334dc60b6aef6a75cd9284126231f13c76926a5?version=6"></a><div class="content"><a class="author">Torsten Schmits</a><div class="metadata"><a href="#216024984" name="216024984"><div>2020-11-08 20:57:31</div></a></div><div class="text"><p>if you do</p>
<div class="codehilite" data-code-language="Haskell"><pre><span></span><code><span class="kr">let</span>
  <span class="n">sem'</span> <span class="ow">::</span> <span class="kt">Sem</span> <span class="p">(</span><span class="kt">Methodology</span> <span class="n">b</span> <span class="n">d</span> <span class="kt">:</span> <span class="kt">Methodology</span> <span class="n">b</span> <span class="n">c</span> <span class="kt">:</span> <span class="kt">Methodology</span> <span class="n">c</span> <span class="n">d</span> <span class="kt">:</span> <span class="n">r</span><span class="p">)</span> <span class="n">a</span>
  <span class="n">sem'</span> <span class="ow">=</span> <span class="n">raiseUnder2</span> <span class="n">sem</span>
</code></pre></div>
<p>?</p></div></div></div><div class="comment"><a class="avatar"><img src="https://www.gravatar.com/avatar/3f02fadd6146855b37247afc22b39685"></a><div class="content"><a class="author">locallycompact</a><div class="metadata"><a href="#216025048" name="216025048"><div>2020-11-08 20:59:49</div></a></div><div class="text"><p>Like</p>
<div class="codehilite"><pre><span></span><code>  cutMethodology&#39; :: forall b c d r a.
                           Sem (Methodology b d &#39;: r) a
                      -&gt; Sem (Methodology b c &#39;: Methodology c d &#39;: r) a
  cutMethodology&#39; f =
    let
      sem&#39; :: Sem (Methodology b d : Methodology b c : Methodology c d : r) a
      sem&#39; = raiseUnder2 f
   in sem&#39; &amp; cutMethodology @b @c @d
</code></pre></div>
<p>Also same</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/7334dc60b6aef6a75cd9284126231f13c76926a5?version=6"></a><div class="content"><a class="author">Torsten Schmits</a><div class="metadata"><a href="#216025129" name="216025129"><div>2020-11-08 21:01:03</div></a></div><div class="text"><p>if you type-apply the <code>r</code> to <code>cutMethodology</code>?</p></div></div></div><div class="comment"><a class="avatar"><img src="https://www.gravatar.com/avatar/3f02fadd6146855b37247afc22b39685"></a><div class="content"><a class="author">locallycompact</a><div class="metadata"><a href="#216025199" name="216025199"><div>2020-11-08 21:02:53</div></a></div><div class="text"><p>Same</p>
<div class="codehilite"><pre><span></span><code>  cutMethodology&#39; :: forall b c d r a.
                           Sem (Methodology b d &#39;: r) a
                      -&gt; Sem (Methodology b c &#39;: Methodology c d &#39;: r) a
  cutMethodology&#39; f =
    let
      sem&#39; :: Sem (Methodology b d : Methodology b c : Methodology c d : r) a
      sem&#39; = raiseUnder2 f
 in sem&#39; &amp; cutMethodology @b @c @d @(Methodology b c &#39;: Methodology c d &#39;: r)
</code></pre></div></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/7334dc60b6aef6a75cd9284126231f13c76926a5?version=6"></a><div class="content"><a class="author">Torsten Schmits</a><div class="metadata"><a href="#216025261" name="216025261"><div>2020-11-08 21:04:25</div></a></div><div class="text"><p>does it work with <code>reinterpret2</code>?</p></div></div></div><div class="comment"><a class="avatar"><img src="https://www.gravatar.com/avatar/3f02fadd6146855b37247afc22b39685"></a><div class="content"><a class="author">locallycompact</a><div class="metadata"><a href="#216025282" name="216025282"><div>2020-11-08 21:05:24</div></a></div><div class="text"><p>How do I call?</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/7334dc60b6aef6a75cd9284126231f13c76926a5?version=6"></a><div class="content"><a class="author">Torsten Schmits</a><div class="metadata"><a href="#216025352" name="216025352"><div>2020-11-08 21:07:13</div></a></div><div class="text"><p>same as <code>cutMethodology</code>, but with the signature of <code>cutMethodology'</code></p></div></div></div><div class="comment"><a class="avatar"><img src="https://www.gravatar.com/avatar/1114fd8de67671f83d3a3ef7594b1950"></a><div class="content"><a class="author">Georgi Lyubenov // googleson78</a><div class="metadata"><a href="#216025432" name="216025432"><div>2020-11-08 21:09:32</div></a></div><div class="text"><div class="codehilite" data-code-language="Haskell"><pre><span></span><code><span class="nf">bla</span> <span class="ow">::</span> <span class="n">forall</span> <span class="n">b</span> <span class="n">c</span> <span class="n">d</span> <span class="n">r</span> <span class="n">a</span><span class="o">.</span> <span class="kt">Sem</span> <span class="p">(</span><span class="kt">Methodology</span> <span class="n">b</span> <span class="n">d</span> <span class="kt">:</span> <span class="kt">Methodology</span> <span class="n">b</span> <span class="n">c</span> <span class="kt">:</span> <span class="kt">Methodology</span> <span class="n">c</span> <span class="n">d</span> <span class="kt">:</span> <span class="n">r</span><span class="p">)</span> <span class="n">a</span> <span class="ow">-&gt;</span> <span class="kt">Sem</span> <span class="p">(</span><span class="kt">Methodology</span> <span class="n">b</span> <span class="n">c</span> <span class="kt">:</span> <span class="kt">Methodology</span> <span class="n">c</span> <span class="n">d</span> <span class="kt">:</span> <span class="n">r</span><span class="p">)</span> <span class="n">a</span>
<span class="nf">bla</span> <span class="ow">=</span> <span class="n">cutMethodology</span> <span class="o">@</span><span class="n">b</span> <span class="o">@</span><span class="n">c</span> <span class="o">@</span><span class="n">d</span> <span class="o">@</span><span class="p">(</span><span class="kt">Methodology</span> <span class="n">b</span> <span class="n">c</span> <span class="kt">:</span> <span class="kt">Methodology</span> <span class="n">c</span> <span class="n">d</span> <span class="kt">:</span> <span class="n">r</span><span class="p">)</span>
</code></pre></div>
<p>this alone doesn't work either</p></div></div></div><div class="comment"><a class="avatar"><img src="https://www.gravatar.com/avatar/3f02fadd6146855b37247afc22b39685"></a><div class="content"><a class="author">locallycompact</a><div class="metadata"><a href="#216025491" name="216025491"><div>2020-11-08 21:10:19</div></a></div><div class="text"><p>ah, hmm</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/7334dc60b6aef6a75cd9284126231f13c76926a5?version=6"></a><div class="content"><a class="author">Torsten Schmits</a><div class="metadata"><a href="#216025537" name="216025537"><div>2020-11-08 21:11:54</div></a></div><div class="text"><p>maybe it's the type family. if <code>reinterpret2</code> doesn't work (or also if it does), try using two <code>Member</code> constraints.</p></div></div></div><div class="comment"><a class="avatar"><img src="https://www.gravatar.com/avatar/1114fd8de67671f83d3a3ef7594b1950"></a><div class="content"><a class="author">Georgi Lyubenov // googleson78</a><div class="metadata"><a href="#216025606" name="216025606"><div>2020-11-08 21:13:24</div></a></div><div class="text"><p>highly doubt, the type family has enough information to fully evaluate</p></div></div></div><div class="comment"><a class="avatar"><img src="https://www.gravatar.com/avatar/3f02fadd6146855b37247afc22b39685"></a><div class="content"><a class="author">locallycompact</a><div class="metadata"><a href="#216025611" name="216025611"><div>2020-11-08 21:13:59</div></a></div><div class="text"><p>Two member constraints doesn't change</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/7334dc60b6aef6a75cd9284126231f13c76926a5?version=6"></a><div class="content"><a class="author">Torsten Schmits</a><div class="metadata"><a href="#216025661" name="216025661"><div>2020-11-08 21:14:28</div></a></div><div class="text"><p>you win, Georgi!</p></div></div></div><div class="comment"><a class="avatar"><img src="https://www.gravatar.com/avatar/3f02fadd6146855b37247afc22b39685"></a><div class="content"><a class="author">locallycompact</a><div class="metadata"><a href="#216025679" name="216025679"><div>2020-11-08 21:15:08</div></a></div><div class="text"><p>reinterpret2 is this right?</p>
<div class="codehilite"><pre><span></span><code>  cutMethodology&#39;&#39; :: forall b c d r a.
                           Sem (Methodology b d &#39;: r) a
                      -&gt; Sem (Methodology b c &#39;: Methodology c d &#39;: r) a
  cutMethodology&#39;&#39; = reinterpret2 \case
   Process b -&gt; process @b @c b &gt;&gt;= process @c @d t
</code></pre></div>
<p>I get</p>
<div class="codehilite"><pre><span></span><code>    Ambiguous use of effect &#39;Methodology&#39;
    ---
    Maybe-fix:
      add (Member (Methodology c d) (Methodology b c
                                       : Methodology c d : r)) to the context of
        the type signature
    If you already have the constraint you want, instead
      add a type application to specify
        &#39;c&#39;, and &#39;d&#39; directly, or activate polysemy-plugin which
          can usually infer the type correctly.
   |
64 |   Process b -&gt; process @b @c b &gt;&gt;= process @c @d
</code></pre></div></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/7334dc60b6aef6a75cd9284126231f13c76926a5?version=6"></a><div class="content"><a class="author">Torsten Schmits</a><div class="metadata"><a href="#216025863" name="216025863"><div>2020-11-08 21:19:41</div></a></div><div class="text"><p>where's this "Maybe-fix" even coming from</p></div></div></div><div class="comment"><a class="avatar"><img src="https://www.gravatar.com/avatar/3f02fadd6146855b37247afc22b39685"></a><div class="content"><a class="author">locallycompact</a><div class="metadata"><a href="#216025912" name="216025912"><div>2020-11-08 21:20:24</div></a></div><div class="text"><p>Maybe clippy plugin</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/7334dc60b6aef6a75cd9284126231f13c76926a5?version=6"></a><div class="content"><a class="author">Torsten Schmits</a><div class="metadata"><a href="#216025917" name="216025917"><div>2020-11-08 21:20:55</div></a></div><div class="text"><p>ah</p></div></div></div><div class="comment"><a class="avatar"><img src="https://www.gravatar.com/avatar/1114fd8de67671f83d3a3ef7594b1950"></a><div class="content"><a class="author">Georgi Lyubenov // googleson78</a><div class="metadata"><a href="#216025921" name="216025921"><div>2020-11-08 21:21:00</div></a></div><div class="text"><p>what?</p></div></div></div><div class="comment"><a class="avatar"><img src="https://www.gravatar.com/avatar/1114fd8de67671f83d3a3ef7594b1950"></a><div class="content"><a class="author">Georgi Lyubenov // googleson78</a><div class="metadata"><a href="#216025936" name="216025936"><div>2020-11-08 21:21:38</div></a></div><div class="text"><p><a href="https://github.com/ArturGajowy/ghc-clippy-plugin">https://github.com/ArturGajowy/ghc-clippy-plugin</a>, ah this thing I guess, cool</p>
<div class="message_embed"><a class="message_embed_image" href="https://github.com/ArturGajowy/ghc-clippy-plugin" style="background-image: url(https://avatars3.githubusercontent.com/u/460141?s=400&amp;v=4)"></a><div class="data-container"><div class="message_embed_title"><a href="https://github.com/ArturGajowy/ghc-clippy-plugin" title="ArturGajowy/ghc-clippy-plugin">ArturGajowy/ghc-clippy-plugin</a></div><div class="message_embed_description">A helpful companion to GHC. Overrides GHC messages, to the user's liking. - ArturGajowy/ghc-clippy-plugin</div></div></div></div></div></div><div class="comment"><a class="avatar"><img src="https://www.gravatar.com/avatar/3f02fadd6146855b37247afc22b39685"></a><div class="content"><a class="author">locallycompact</a><div class="metadata"><a href="#216025986" name="216025986"><div>2020-11-08 21:22:17</div></a></div><div class="text"><p>Yeah that</p></div></div></div><div class="comment"><a class="avatar"><img src="https://www.gravatar.com/avatar/1114fd8de67671f83d3a3ef7594b1950"></a><div class="content"><a class="author">Georgi Lyubenov // googleson78</a><div class="metadata"><a href="#216026070" name="216026070"><div>2020-11-08 21:24:48</div></a></div><div class="text"><p>strangely, this works:</p>
<div class="codehilite" data-code-language="Haskell"><pre><span></span><code><span class="nf">f</span> <span class="ow">::</span> <span class="n">forall</span> <span class="n">a</span> <span class="n">b</span> <span class="n">c</span> <span class="n">r</span><span class="o">.</span> <span class="kt">Member</span> <span class="p">(</span><span class="kt">Methodology</span> <span class="n">b</span> <span class="n">c</span><span class="p">)</span> <span class="n">r</span> <span class="ow">=&gt;</span> <span class="kt">Sem</span> <span class="p">(</span><span class="kt">Methodology</span> <span class="n">a</span> <span class="n">b</span> <span class="kt">':</span> <span class="n">r</span><span class="p">)</span> <span class="n">a</span> <span class="ow">-&gt;</span> <span class="kt">Sem</span> <span class="n">r</span> <span class="n">a</span>
<span class="nf">f</span> <span class="ow">=</span> <span class="n">undefined</span>

<span class="nf">bla2</span> <span class="ow">::</span> <span class="kt">Sem</span> <span class="p">(</span><span class="kt">Methodology</span> <span class="n">a</span> <span class="n">b</span> <span class="kt">':</span> <span class="kt">Methodology</span> <span class="n">b</span> <span class="n">c</span> <span class="kt">':</span> <span class="n">r</span><span class="p">)</span> <span class="n">a</span> <span class="ow">-&gt;</span> <span class="kt">Sem</span> <span class="p">(</span><span class="kt">Methodology</span> <span class="n">b</span> <span class="n">c</span> <span class="kt">':</span> <span class="n">r</span><span class="p">)</span> <span class="n">a</span>
<span class="nf">bla2</span> <span class="ow">=</span> <span class="n">f</span>
</code></pre></div></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/7334dc60b6aef6a75cd9284126231f13c76926a5?version=6"></a><div class="content"><a class="author">Torsten Schmits</a><div class="metadata"><a href="#216026083" name="216026083"><div>2020-11-08 21:25:29</div></a></div><div class="text"><p>here there's no two <code>Methodology</code>s that have the same first type argument</p></div></div></div><div class="comment"><a class="avatar"><img src="https://www.gravatar.com/avatar/1114fd8de67671f83d3a3ef7594b1950"></a><div class="content"><a class="author">Georgi Lyubenov // googleson78</a><div class="metadata"><a href="#216027263" name="216027263"><div>2020-11-08 21:55:32</div></a></div><div class="text"><p>smaller repro:</p>
<div class="codehilite" data-code-language="Haskell"><pre><span></span><code><span class="nf">g</span> <span class="ow">::</span> <span class="p">(</span><span class="kt">Member</span> <span class="p">(</span><span class="kt">Methodology</span> <span class="n">a</span> <span class="n">b</span><span class="p">)</span> <span class="n">r</span><span class="p">,</span> <span class="kt">Member</span> <span class="p">(</span><span class="kt">Methodology</span> <span class="n">b</span> <span class="n">c</span><span class="p">)</span> <span class="n">r</span><span class="p">)</span> <span class="ow">=&gt;</span> <span class="kt">Proxy</span> <span class="p">(</span><span class="kt">Methodology</span> <span class="n">a</span> <span class="n">c</span> <span class="kt">':</span> <span class="n">r</span><span class="p">)</span> <span class="ow">-&gt;</span> <span class="kt">Proxy</span> <span class="n">r</span>
<span class="nf">g</span> <span class="ow">=</span> <span class="n">undefined</span>

<span class="nf">h</span> <span class="ow">::</span> <span class="n">forall</span> <span class="n">a</span> <span class="n">b</span> <span class="n">c</span> <span class="n">r</span><span class="o">.</span> <span class="kt">Proxy</span> <span class="p">(</span><span class="kt">Methodology</span> <span class="n">a</span> <span class="n">c</span> <span class="kt">:</span> <span class="kt">Methodology</span> <span class="n">a</span> <span class="n">b</span> <span class="kt">:</span> <span class="kt">Methodology</span> <span class="n">b</span> <span class="n">c</span> <span class="kt">:</span> <span class="n">r</span><span class="p">)</span> <span class="ow">-&gt;</span> <span class="kt">Proxy</span> <span class="p">(</span><span class="kt">Methodology</span> <span class="n">a</span> <span class="n">b</span> <span class="kt">:</span> <span class="kt">Methodology</span> <span class="n">b</span> <span class="n">c</span> <span class="kt">:</span> <span class="n">r</span><span class="p">)</span>
<span class="nf">h</span> <span class="ow">=</span> <span class="n">g</span>
</code></pre></div></div></div></div><div class="comment"><a class="avatar"><img src="https://www.gravatar.com/avatar/1114fd8de67671f83d3a3ef7594b1950"></a><div class="content"><a class="author">Georgi Lyubenov // googleson78</a><div class="metadata"><a href="#216027577" name="216027577"><div>2020-11-08 22:02:10</div></a></div><div class="text"><div class="codehilite" data-code-language="Haskell"><pre><span></span><code><span class="kr">data</span> <span class="kt">Methodology'</span> <span class="p">(</span><span class="n">sym</span> <span class="ow">::</span> <span class="kt">Nat</span><span class="p">)</span> <span class="n">a</span> <span class="n">b</span>

<span class="kr">data</span> <span class="kt">Wrap1</span> <span class="n">a</span>

<span class="kr">data</span> <span class="kt">Wrap2</span> <span class="n">a</span>

<span class="nf">g</span> <span class="ow">::</span> <span class="p">(</span><span class="kt">Member</span> <span class="p">(</span><span class="kt">Wrap1</span> <span class="p">(</span><span class="kt">Methodology'</span> <span class="n">n2</span> <span class="n">a</span> <span class="n">b</span><span class="p">))</span> <span class="n">r</span><span class="p">,</span> <span class="kt">Member</span> <span class="p">(</span><span class="kt">Wrap2</span> <span class="p">(</span><span class="kt">Methodology'</span> <span class="n">n3</span> <span class="n">b</span> <span class="n">c</span><span class="p">))</span> <span class="n">r</span><span class="p">)</span> <span class="ow">=&gt;</span> <span class="kt">Proxy</span> <span class="p">((</span><span class="kt">Methodology'</span> <span class="n">n1</span> <span class="n">a</span> <span class="n">c</span><span class="p">)</span> <span class="kt">':</span> <span class="n">r</span><span class="p">)</span> <span class="ow">-&gt;</span> <span class="kt">Proxy</span> <span class="n">r</span>
<span class="nf">g</span> <span class="ow">=</span> <span class="n">undefined</span>

<span class="nf">h</span> <span class="ow">::</span> <span class="kt">Proxy</span> <span class="p">((</span><span class="kt">Methodology'</span> <span class="mi">0</span> <span class="n">a</span> <span class="n">c</span><span class="p">)</span> <span class="kt">:</span> <span class="kt">Wrap1</span> <span class="p">(</span><span class="kt">Methodology'</span> <span class="mi">1</span> <span class="n">a</span> <span class="n">b</span><span class="p">)</span> <span class="kt">:</span> <span class="kt">Wrap2</span> <span class="p">(</span><span class="kt">Methodology'</span> <span class="mi">2</span> <span class="n">b</span> <span class="n">c</span><span class="p">)</span> <span class="kt">:</span> <span class="n">r</span><span class="p">)</span> <span class="ow">-&gt;</span> <span class="kt">Proxy</span> <span class="p">(</span><span class="kt">Wrap1</span> <span class="p">(</span><span class="kt">Methodology'</span> <span class="mi">1</span> <span class="n">a</span> <span class="n">b</span><span class="p">)</span> <span class="kt">:</span> <span class="kt">Wrap2</span> <span class="p">(</span><span class="kt">Methodology'</span> <span class="mi">2</span> <span class="n">b</span> <span class="n">c</span><span class="p">)</span> <span class="kt">:</span> <span class="n">r</span><span class="p">)</span>
<span class="nf">h</span> <span class="ow">=</span> <span class="n">g</span>
</code></pre></div>
<p>this compiles</p></div></div></div><div class="comment"><a class="avatar"><img src="https://www.gravatar.com/avatar/1114fd8de67671f83d3a3ef7594b1950"></a><div class="content"><a class="author">Georgi Lyubenov // googleson78</a><div class="metadata"><a href="#216027580" name="216027580"><div>2020-11-08 22:02:13</div></a></div><div class="text"><p>lol</p></div></div></div><div class="comment"><a class="avatar"><img src="https://www.gravatar.com/avatar/1114fd8de67671f83d3a3ef7594b1950"></a><div class="content"><a class="author">Georgi Lyubenov // googleson78</a><div class="metadata"><a href="#216027629" name="216027629"><div>2020-11-08 22:03:35</div></a></div><div class="text"><p>notably, it doesn't, if I remove the <code>Nat</code>s, with an ungodly kind error</p></div></div></div><div class="comment"><a class="avatar"><img src="https://www.gravatar.com/avatar/3f02fadd6146855b37247afc22b39685"></a><div class="content"><a class="author">locallycompact</a><div class="metadata"><a href="#216027677" name="216027677"><div>2020-11-08 22:04:56</div></a></div><div class="text"><p>I think it's compiling without the Nats for me</p></div></div></div><div class="comment"><a class="avatar"><img src="https://www.gravatar.com/avatar/3f02fadd6146855b37247afc22b39685"></a><div class="content"><a class="author">locallycompact</a><div class="metadata"><a href="#216027691" name="216027691"><div>2020-11-08 22:05:25</div></a></div><div class="text"><div class="codehilite" data-code-language="Haskell"><pre><span></span><code><span class="kr">data</span> <span class="kt">Methodology'</span> <span class="n">a</span> <span class="n">b</span>

<span class="kr">data</span> <span class="kt">Wrap0</span> <span class="n">a</span>

<span class="kr">data</span> <span class="kt">Wrap1</span> <span class="n">a</span>

<span class="kr">data</span> <span class="kt">Wrap2</span> <span class="n">a</span>

<span class="nf">g</span> <span class="ow">::</span> <span class="p">(</span><span class="kt">Member</span> <span class="p">(</span><span class="kt">Wrap1</span> <span class="p">(</span><span class="kt">Methodology'</span> <span class="n">a</span> <span class="n">b</span><span class="p">))</span> <span class="n">r</span><span class="p">,</span> <span class="kt">Member</span> <span class="p">(</span><span class="kt">Wrap2</span> <span class="p">(</span><span class="kt">Methodology'</span> <span class="n">b</span> <span class="n">c</span><span class="p">))</span> <span class="n">r</span><span class="p">)</span> <span class="ow">=&gt;</span> <span class="kt">Proxy</span> <span class="p">(</span><span class="kt">W</span>  <span class="n">rap0</span> <span class="p">(</span><span class="kt">Methodology'</span> <span class="n">a</span> <span class="n">c</span><span class="p">)</span> <span class="kt">':</span> <span class="n">r</span><span class="p">)</span> <span class="ow">-&gt;</span> <span class="kt">Proxy</span> <span class="n">r</span> <span class="n">typecheck</span><span class="kt">:</span> <span class="err">•</span> <span class="kt">Redundant</span> <span class="n">constraints</span><span class="kt">:</span> <span class="p">(</span><span class="kt">Member</span> <span class="p">(</span><span class="kt">Wrap1</span>
<span class="nf">g</span> <span class="ow">=</span> <span class="n">undefined</span>

<span class="nf">h</span> <span class="ow">::</span> <span class="kt">Proxy</span> <span class="p">(</span><span class="kt">Wrap0</span> <span class="p">(</span><span class="kt">Methodology'</span> <span class="n">a</span> <span class="n">c</span><span class="p">)</span> <span class="kt">:</span> <span class="kt">Wrap1</span> <span class="p">(</span><span class="kt">Methodology'</span> <span class="n">a</span> <span class="n">b</span><span class="p">)</span> <span class="kt">:</span> <span class="kt">Wrap2</span> <span class="p">(</span><span class="kt">Methodology'</span> <span class="n">b</span> <span class="n">c</span><span class="p">)</span>   <span class="kt">:</span> <span class="n">r</span><span class="p">)</span> <span class="ow">-&gt;</span> <span class="kt">Proxy</span> <span class="p">(</span><span class="kt">Wrap1</span> <span class="p">(</span><span class="kt">Methodology'</span> <span class="n">a</span> <span class="n">b</span><span class="p">)</span> <span class="kt">:</span> <span class="kt">Wrap2</span> <span class="p">(</span><span class="kt">Methodology'</span> <span class="n">b</span> <span class="n">c</span><span class="p">)</span> <span class="kt">:</span> <span class="n">r</span><span class="p">)</span>
<span class="nf">h</span> <span class="ow">=</span> <span class="n">g</span>
</code></pre></div></div></div></div><div class="comment"><a class="avatar"><img src="https://www.gravatar.com/avatar/1114fd8de67671f83d3a3ef7594b1950"></a><div class="content"><a class="author">Georgi Lyubenov // googleson78</a><div class="metadata"><a href="#216027750" name="216027750"><div>2020-11-08 22:06:06</div></a></div><div class="text"><div class="codehilite" data-code-language="Haskell"><pre><span></span><code><span class="kr">data</span> <span class="kt">Methodology'</span> <span class="n">a</span> <span class="n">b</span>

<span class="kr">data</span> <span class="kt">Wrap</span> <span class="n">a</span>

<span class="nf">g</span> <span class="ow">::</span> <span class="p">(</span><span class="kt">Member</span> <span class="p">((</span><span class="kt">Methodology'</span> <span class="n">a</span> <span class="n">b</span><span class="p">))</span> <span class="n">r</span><span class="p">,</span> <span class="kt">Member</span> <span class="p">(</span><span class="kt">Wrap</span> <span class="p">(</span><span class="kt">Methodology'</span> <span class="n">b</span> <span class="n">c</span><span class="p">))</span> <span class="n">r</span><span class="p">)</span> <span class="ow">=&gt;</span> <span class="kt">Proxy</span> <span class="p">((</span><span class="kt">Methodology'</span> <span class="n">a</span> <span class="n">c</span><span class="p">)</span> <span class="kt">':</span> <span class="n">r</span><span class="p">)</span> <span class="ow">-&gt;</span> <span class="kt">Proxy</span> <span class="n">r</span>
<span class="nf">g</span> <span class="ow">=</span> <span class="n">undefined</span>

<span class="nf">h</span> <span class="ow">::</span> <span class="kt">Proxy</span> <span class="p">((</span><span class="kt">Methodology'</span> <span class="n">a</span> <span class="n">c</span><span class="p">)</span> <span class="kt">:</span> <span class="p">(</span><span class="kt">Methodology'</span> <span class="n">a</span> <span class="n">b</span><span class="p">)</span> <span class="kt">:</span> <span class="kt">Wrap</span> <span class="p">(</span><span class="kt">Methodology'</span> <span class="n">b</span> <span class="n">c</span><span class="p">)</span> <span class="kt">:</span> <span class="n">r</span><span class="p">)</span> <span class="ow">-&gt;</span> <span class="kt">Proxy</span> <span class="p">((</span><span class="kt">Methodology'</span> <span class="n">a</span> <span class="n">b</span><span class="p">)</span> <span class="kt">:</span> <span class="kt">Wrap</span> <span class="p">(</span><span class="kt">Methodology'</span> <span class="n">b</span> <span class="n">c</span><span class="p">)</span> <span class="kt">:</span> <span class="n">r</span><span class="p">)</span>
<span class="nf">h</span> <span class="ow">=</span> <span class="n">g</span>
</code></pre></div>
<p>further reduced</p></div></div></div><div class="comment"><a class="avatar"><img src="https://www.gravatar.com/avatar/1114fd8de67671f83d3a3ef7594b1950"></a><div class="content"><a class="author">Georgi Lyubenov // googleson78</a><div class="metadata"><a href="#216027755" name="216027755"><div>2020-11-08 22:06:13</div></a></div><div class="text"><p>starting to look like a ghc bug/deficiency tbh</p></div></div></div><div class="comment"><a class="avatar"><img src="https://www.gravatar.com/avatar/1114fd8de67671f83d3a3ef7594b1950"></a><div class="content"><a class="author">Georgi Lyubenov // googleson78</a><div class="metadata"><a href="#216027798" name="216027798"><div>2020-11-08 22:08:03</div></a></div><div class="text"><p>looks like the type class resolution method somehow decides that "yes, this is it, <code>Methodology b _</code> <em>must</em> match <code>Methodology b _</code>", only later "realises" that the second class argument differ, resulting in an error</p></div></div></div><div class="comment"><a class="avatar"><img src="https://www.gravatar.com/avatar/1114fd8de67671f83d3a3ef7594b1950"></a><div class="content"><a class="author">Georgi Lyubenov // googleson78</a><div class="metadata"><a href="#216027917" name="216027917"><div>2020-11-08 22:10:13</div></a></div><div class="text"><p>I'll try to further slim it down later</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/7334dc60b6aef6a75cd9284126231f13c76926a5?version=6"></a><div class="content"><a class="author">Torsten Schmits</a><div class="metadata"><a href="#216028003" name="216028003"><div>2020-11-08 22:12:10</div></a></div><div class="text"><p>does it work if you remove one type param of <code>Methodology</code>?</p></div></div></div><div class="comment"><a class="avatar"><img src="https://www.gravatar.com/avatar/1114fd8de67671f83d3a3ef7594b1950"></a><div class="content"><a class="author">Georgi Lyubenov // googleson78</a><div class="metadata"><a href="#216028019" name="216028019"><div>2020-11-08 22:12:47</div></a></div><div class="text"><p>I don't know how to emulate the same situation with only one type param</p></div></div></div><div class="comment"><a class="avatar"><img src="https://www.gravatar.com/avatar/3f02fadd6146855b37247afc22b39685"></a><div class="content"><a class="author">locallycompact</a><div class="metadata"><a href="#216028401" name="216028401"><div>2020-11-08 22:23:30</div></a></div><div class="text"><p>Did you say that last one works for you or doesn't?</p></div></div></div><div class="comment"><a class="avatar"><img src="https://www.gravatar.com/avatar/1114fd8de67671f83d3a3ef7594b1950"></a><div class="content"><a class="author">Georgi Lyubenov // googleson78</a><div class="metadata"><a href="#216028424" name="216028424"><div>2020-11-08 22:24:04</div></a></div><div class="text"><p>last one I posted compiles</p></div></div></div><div class="comment"><a class="avatar"><img src="https://www.gravatar.com/avatar/1114fd8de67671f83d3a3ef7594b1950"></a><div class="content"><a class="author">Georgi Lyubenov // googleson78</a><div class="metadata"><a href="#216028454" name="216028454"><div>2020-11-08 22:24:13</div></a></div><div class="text"><p>unless I forgot to save or something</p></div></div></div><div class="comment"><a class="avatar"><img src="https://www.gravatar.com/avatar/3f02fadd6146855b37247afc22b39685"></a><div class="content"><a class="author">locallycompact</a><div class="metadata"><a href="#216028462" name="216028462"><div>2020-11-08 22:24:24</div></a></div><div class="text"><p>Yup me too</p></div></div></div></div></div><div class="ui vertical footer segment"><a href="https://github.com/srid/zulip-archive">Powered by Haskell</a> | Questions? Contact <a href="https://www.srid.ca">srid</a></div></div></body></html>