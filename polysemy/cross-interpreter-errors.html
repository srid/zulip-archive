<html lang="en"><head><meta content="text/html; charset=utf-8" http-equiv="Content-Type"><meta content="width=device-width, initial-scale=1" name="viewport"><meta content="Greetings, fellow humans!
As a follow-up to this topic https://funprog.zulipchat.com/#narrow/stream/216942-Polysemy/topic/Either.20vs.20Error where @Love Waern (King of the Homeless) produced a brilliant bit of code, I have riffed on that code some more to produce this experiment:
https://github.com" name="description"><link href="https://funprog.srid.ca/polysemy/cross-interpreter-errors.html" rel="canonical"><meta property="og:title" content="cross-interpreter errors - Polysemy"><meta property="og:site_name" content="Functional Programming Zulip Archive"><meta property="og:type" content="article"><meta property="og:article:section" content="Polysemy"><meta property="og:article:modified_time" content="2020-10-07T19:49:43Z"><meta property="og:article:published_time" content="2020-10-06T16:16:09Z"><meta property="og:image" content="https://zulip-avatars.s3.amazonaws.com/13896/7334dc60b6aef6a75cd9284126231f13c76926a5?x=x&amp;version=4"><title>cross-interpreter errors - Polysemy</title><style type="text/css">
div#thesite
{
  font-family   : "Open Sans", sans-serif;
  font-size     : 1em !important;
  margin-top    : 1em;
  margin-bottom : 1em;
}

div#thesite h1
{
  font-family : "Roboto", sans-serif;
  line-height : 1.19999em;
}

div#thesite h2
{
  font-family : "Roboto", sans-serif;
  line-height : 1.19999em;
}

div#thesite h3
{
  font-family : "Roboto", sans-serif;
  line-height : 1.19999em;
}

div#thesite h4
{
  font-family : "Roboto", sans-serif;
  line-height : 1.19999em;
}

div#thesite h5
{
  font-family : "Roboto", sans-serif;
  line-height : 1.19999em;
}

div#thesite h6
{
  font-family : "Roboto", sans-serif;
  line-height : 1.19999em;
}

div#thesite .ui.breadcrumb.rib .section
{
  font-family : "Roboto", sans-serif;
  line-height : 1.19999em;
}

div#thesite .header
{
  font-family : "Roboto", sans-serif;
  line-height : 1.19999em;
}

div#thesite .as-header
{
  font-family : "Roboto", sans-serif;
  line-height : 1.19999em;
}

div#thesite code, pre, tt
{
  font-family : "SFMono-Regular","Menlo","Monaco","Consolas","Liberation Mono","Courier New", monospace;
}

div#thesite .ui.breadcrumb.rib
{
  margin-bottom : 1em;
}



div#thesite .ui.comments.messages .comment .metadata a
{
  color : #808080;
}

div#thesite .ui.comments.messages .comment a.avatar img
{
  height : auto;
}

div#thesite .subtle
{
  color : #808080;
}


div#thesite .messages pre
{
  font-size : 85%;
  overflow  : auto;
  max-width : 100%;
}

div#thesite .messages .message_embed
{
  border-left  : solid 3px #808080;
  padding-left : 0.69999em;
}

div#thesite .messages .message_inline_image img
{
  max-width     : 100%;
  margin-bottom : 1em;
}


/* Generated with Clay, http://fvisser.nl/clay */</style><link href="https://cdnjs.cloudflare.com/ajax/libs/semantic-ui/2.4.1/semantic.min.css" rel="stylesheet"><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css" rel="stylesheet"><link href="https://fonts.googleapis.com/css?family=Open+Sans|Oswald&amp;display=swap" rel="stylesheet"><link href="https://fonts.googleapis.com/css?family=Roboto|Open+Sans&amp;display=swap" rel="stylesheet"></head><body><div id="thesite" class="ui text container"><div class="ui violet inverted top attached center aligned segment"><h1 class="ui huge header">cross-interpreter errors - Polysemy</h1></div><div class="ui attached segment"><div class="ui message"><p>Welcome to the Functional Programming Zulip Chat Archive. You can join the chat <a href="https://funprog.zulipchat.com">here</a>.</p></div><div class="ui breadcrumb rib"><a href="/" class="section">Home</a><i class="right angle icon divider"></i><a href="/polysemy/" class="section">#Polysemy</a><i class="right angle icon divider"></i><div class="active section">cross-interpreter errors</div></div><div class="ui comments messages"><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/7334dc60b6aef6a75cd9284126231f13c76926a5?x=x&amp;version=4"></a><div class="content"><a class="author">Torsten Schmits</a><div class="metadata"><a href="#212451020" name="212451020"><div>2020-10-06 16:16:09</div></a></div><div class="text"><p>Greetings, fellow humans!</p>
<p>As a follow-up to this topic <a href="#narrow/stream/216942-Polysemy/topic/Either.20vs.20Error">https://funprog.zulipchat.com/#narrow/stream/216942-Polysemy/topic/Either.20vs.20Error</a> where <span class="user-mention" data-user-id="254034">@Love Waern (King of the Homeless)</span> produced a brilliant bit of code, I have riffed on that code some more to produce this experiment:</p>
<p><a href="https://github.com/tek/polysemy-resume">https://github.com/tek/polysemy-resume</a></p>
<p>I introduced an effect <code>Stop</code> that is <code>Error</code> without the <code>catch</code>, for the purpose of marking errors that should be handled by the <code>Resumable</code> effect (called <code>Exceptional</code> in the original).<br>
What I added is the possibility to handle the error totally so that the requirement for an additional <code>Error</code> constraint on the consuming program/interpreter is removed.</p>
<p><span class="user-mention" data-user-id="254034">@Love Waern (King of the Homeless)</span> , I would be very grateful if you could look over the implementation, especially to see if I'm doing unnecessary decompositions and weavings and the like.</p>
<div class="message_embed"><a class="message_embed_image" href="https://github.com/tek/polysemy-resume" style="background-image: url(https://avatars0.githubusercontent.com/u/2632?s=400&amp;v=4)"></a><div class="data-container"><div class="message_embed_title"><a href="https://github.com/tek/polysemy-resume" title="tek/polysemy-resume">tek/polysemy-resume</a></div><div class="message_embed_description">cross-interpreter errors for polysemy. Contribute to tek/polysemy-resume development by creating an account on GitHub.</div></div></div></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/7334dc60b6aef6a75cd9284126231f13c76926a5?x=x&amp;version=4"></a><div class="content"><a class="author">Torsten Schmits</a><div class="metadata"><a href="#212451676" name="212451676"><div>2020-10-06 16:21:32</div></a></div><div class="text"><p>oh, a significant mechanism here is that I pass the backing interpreter into the wrapper and execute it in the unwrapped Sem, I think</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/7334dc60b6aef6a75cd9284126231f13c76926a5?x=x&amp;version=4"></a><div class="content"><a class="author">Torsten Schmits</a><div class="metadata"><a href="#212458774" name="212458774"><div>2020-10-06 17:24:01</div></a></div><div class="text"><p>first problem I'm seeing is that other dependencies of the consumer seem to be causing confusion</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/f1ec33bcc6144366b30e479d6b3bed74cdb9f611?x=x&amp;version=4"></a><div class="content"><a class="author">Love Waern (King of the Homeless)</a><div class="metadata"><a href="#212460912" name="212460912"><div>2020-10-06 17:42:35</div></a></div><div class="text"><p><span aria-label="thumbs up" class="emoji emoji-1f44d" role="img" title="thumbs up">:thumbs_up:</span> I figured <code>Exceptional</code> (or <code>Resumable</code>) had promise. Looking through this more closely now.</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/f1ec33bcc6144366b30e479d6b3bed74cdb9f611?x=x&amp;version=4"></a><div class="content"><a class="author">Love Waern (King of the Homeless)</a><div class="metadata"><a href="#212469650" name="212469650"><div>2020-10-06 18:54:33</div></a></div><div class="text"><p><code>resumable</code> and <code>resumableFor</code> can be relaxed significantly:</p>
<div class="codehilite" data-code-language="Haskell"><pre><span></span><code><span class="nf">resumable</span> <span class="ow">::</span>
  <span class="err">âˆ€</span> <span class="n">eff</span> <span class="n">err</span> <span class="n">r</span> <span class="o">.</span>
  <span class="kt">InterpreterFor</span> <span class="n">eff</span> <span class="p">(</span><span class="kt">Stop</span> <span class="n">err</span> <span class="kt">':</span> <span class="n">r</span><span class="p">)</span> <span class="ow">-&gt;</span>
  <span class="kt">InterpreterFor</span> <span class="p">(</span><span class="kt">Resumable</span> <span class="n">err</span> <span class="n">eff</span><span class="p">)</span> <span class="n">r</span>
<span class="nf">resumable</span> <span class="n">interpreter</span> <span class="n">sem</span> <span class="ow">=</span> <span class="kt">Sem</span> <span class="o">$</span> <span class="nf">\</span><span class="n">k</span> <span class="ow">-&gt;</span> <span class="n">runSem</span> <span class="n">sem</span> <span class="o">$</span> <span class="nf">\</span><span class="n">u</span> <span class="ow">-&gt;</span>
  <span class="kr">case</span> <span class="n">decomp</span> <span class="p">(</span><span class="n">hoist</span> <span class="p">(</span><span class="n">resumable</span> <span class="n">interpreter</span><span class="p">)</span> <span class="n">u</span><span class="p">)</span> <span class="kr">of</span>
    <span class="kt">Right</span> <span class="p">(</span><span class="kt">Weaving</span> <span class="p">(</span><span class="kt">Resumable</span> <span class="n">e</span><span class="p">)</span> <span class="n">s</span> <span class="n">wv</span> <span class="n">ex</span> <span class="n">ins</span><span class="p">)</span> <span class="ow">-&gt;</span>
      <span class="kr">let</span>
        <span class="n">sem'</span> <span class="ow">=</span>   <span class="n">interpreter</span>
               <span class="o">$</span> <span class="n">liftSem</span>
               <span class="o">$</span> <span class="n">weave</span> <span class="n">s</span> <span class="p">(</span><span class="n">raise</span> <span class="o">.</span> <span class="n">raise</span> <span class="o">.</span> <span class="n">wv</span><span class="p">)</span> <span class="n">ins</span> <span class="p">(</span><span class="n">injWeaving</span> <span class="n">e</span><span class="p">)</span>
      <span class="kr">in</span>
        <span class="n">distribEither</span> <span class="n">s</span> <span class="n">ex</span> <span class="o">&lt;$&gt;</span> <span class="n">runSem</span> <span class="p">(</span><span class="n">runStop</span> <span class="n">sem'</span><span class="p">)</span> <span class="n">k</span>
    <span class="kt">Left</span> <span class="n">g</span> <span class="ow">-&gt;</span> <span class="n">k</span> <span class="n">g</span>
</code></pre></div>

<p>I recommend getting rid of those helper functions with the extremely large signatures (like <code>injectStop</code>and <code>injectWithStop</code>). Here, I simply inlined what they're doing.</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/7334dc60b6aef6a75cd9284126231f13c76926a5?x=x&amp;version=4"></a><div class="content"><a class="author">Torsten Schmits</a><div class="metadata"><a href="#212469935" name="212469935"><div>2020-10-06 18:57:04</div></a></div><div class="text"><p>it was way worse before <span aria-label="big smile" class="emoji emoji-1f604" role="img" title="big smile">:big_smile:</span></p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/7334dc60b6aef6a75cd9284126231f13c76926a5?x=x&amp;version=4"></a><div class="content"><a class="author">Torsten Schmits</a><div class="metadata"><a href="#212469983" name="212469983"><div>2020-10-06 18:57:29</div></a></div><div class="text"><p>mostly in order to understand the types</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/f1ec33bcc6144366b30e479d6b3bed74cdb9f611?x=x&amp;version=4"></a><div class="content"><a class="author">Love Waern (King of the Homeless)</a><div class="metadata"><a href="#212470639" name="212470639"><div>2020-10-06 19:03:12</div></a></div><div class="text"><p>True, <code>Weaving</code> is weird. When I first learned the internals of the library I had stare at it for a while before I got it.</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/7334dc60b6aef6a75cd9284126231f13c76926a5?x=x&amp;version=4"></a><div class="content"><a class="author">Torsten Schmits</a><div class="metadata"><a href="#212470954" name="212470954"><div>2020-10-06 19:05:39</div></a></div><div class="text"><p>I will have to stare a bit longer, but this thing definitely gave me some helpful insights</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/f1ec33bcc6144366b30e479d6b3bed74cdb9f611?x=x&amp;version=4"></a><div class="content"><a class="author">Love Waern (King of the Homeless)</a><div class="metadata"><a href="#212471122" name="212471122"><div>2020-10-06 19:06:54</div></a></div><div class="text"><p>The deeper implementation of <code>runState</code> is probably a good place to look at. That was one of my learning resources.</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/f1ec33bcc6144366b30e479d6b3bed74cdb9f611?x=x&amp;version=4"></a><div class="content"><a class="author">Love Waern (King of the Homeless)</a><div class="metadata"><a href="#212472543" name="212472543"><div>2020-10-06 19:18:51</div></a></div><div class="text"><p>Here's <code>resumableFor</code>:</p>
<div class="codehilite" data-code-language="Haskell"><pre><span></span><code><span class="nf">resumableFor</span> <span class="ow">::</span>
  <span class="err">âˆ€</span> <span class="n">eff</span> <span class="n">smallErr</span> <span class="n">bigErr</span> <span class="n">r</span> <span class="o">.</span>
  <span class="kt">Member</span> <span class="p">(</span><span class="kt">Stop</span> <span class="n">bigErr</span><span class="p">)</span> <span class="n">r</span> <span class="ow">=&gt;</span>
  <span class="p">(</span><span class="n">bigErr</span> <span class="ow">-&gt;</span> <span class="kt">Maybe</span> <span class="n">smallErr</span><span class="p">)</span> <span class="ow">-&gt;</span>
  <span class="kt">InterpreterFor</span> <span class="n">eff</span> <span class="p">(</span><span class="kt">Stop</span> <span class="n">bigErr</span> <span class="kt">':</span> <span class="n">r</span><span class="p">)</span> <span class="ow">-&gt;</span>
  <span class="kt">InterpreterFor</span> <span class="p">(</span><span class="kt">Resumable</span> <span class="n">smallErr</span> <span class="n">eff</span><span class="p">)</span> <span class="n">r</span>
<span class="nf">resumableFor</span> <span class="n">from</span> <span class="n">interpreter</span> <span class="n">sem</span> <span class="ow">=</span> <span class="kt">Sem</span> <span class="o">$</span> <span class="nf">\</span><span class="n">k</span> <span class="ow">-&gt;</span> <span class="n">runSem</span> <span class="n">sem</span> <span class="o">$</span> <span class="nf">\</span><span class="n">u</span> <span class="ow">-&gt;</span>
  <span class="kr">case</span> <span class="n">decomp</span> <span class="p">(</span><span class="n">hoist</span> <span class="p">(</span><span class="n">resumableFor</span> <span class="n">from</span> <span class="n">interpreter</span><span class="p">)</span> <span class="n">u</span><span class="p">)</span> <span class="kr">of</span>
    <span class="kt">Right</span> <span class="p">(</span><span class="kt">Weaving</span> <span class="p">(</span><span class="kt">Resumable</span> <span class="n">e</span><span class="p">)</span> <span class="n">s</span> <span class="n">wv</span> <span class="n">ex</span> <span class="n">ins</span><span class="p">)</span> <span class="ow">-&gt;</span>
      <span class="kr">let</span>
        <span class="n">sem'</span> <span class="ow">=</span>   <span class="n">interpreter</span>
               <span class="o">$</span> <span class="n">liftSem</span>
               <span class="o">$</span> <span class="n">weave</span> <span class="n">s</span> <span class="p">(</span><span class="n">raise</span> <span class="o">.</span> <span class="n">raise</span> <span class="o">.</span> <span class="n">wv</span><span class="p">)</span> <span class="n">ins</span> <span class="p">(</span><span class="n">injWeaving</span> <span class="n">e</span><span class="p">)</span>
      <span class="kr">in</span>
        <span class="n">fmap</span> <span class="p">(</span><span class="n">distribEither</span> <span class="n">s</span> <span class="n">ex</span><span class="p">)</span> <span class="o">$</span> <span class="n">runSem</span> <span class="p">(</span><span class="n">runStop</span> <span class="n">sem'</span><span class="p">)</span> <span class="n">k</span> <span class="o">&gt;&gt;=</span> <span class="nf">\</span><span class="kr">case</span>
          <span class="kt">Left</span> <span class="n">exc</span> <span class="ow">-&gt;</span> <span class="n">maybe</span> <span class="p">(</span><span class="n">k</span> <span class="o">$</span> <span class="n">inj</span> <span class="o">$</span> <span class="kt">Stop</span> <span class="n">exc</span><span class="p">)</span> <span class="p">(</span><span class="n">return</span> <span class="o">.</span> <span class="kt">Left</span><span class="p">)</span> <span class="p">(</span><span class="n">from</span> <span class="n">exc</span><span class="p">)</span>
          <span class="kt">Right</span> <span class="n">a</span>  <span class="ow">-&gt;</span> <span class="n">return</span> <span class="p">(</span><span class="kt">Right</span> <span class="n">a</span><span class="p">)</span>
    <span class="kt">Left</span> <span class="n">g</span> <span class="ow">-&gt;</span> <span class="n">k</span> <span class="n">g</span>
</code></pre></div></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/f1ec33bcc6144366b30e479d6b3bed74cdb9f611?x=x&amp;version=4"></a><div class="content"><a class="author">Love Waern (King of the Homeless)</a><div class="metadata"><a href="#212473385" name="212473385"><div>2020-10-06 19:26:08</div></a></div><div class="text"><p>That should allow you to clean up most boilerplate. Everything else in the modules looks alright (although I won't touch <code>Polysemy.Resumable.Prelude</code>). Some observations:</p>
<ul>
<li>You may want to add more <code>Resumable</code> interpreters. I think a parallel of <code>runExceptional</code> is still warranted. You may also want to add</li>
</ul>
<div class="codehilite" data-code-language="Haskell"><pre><span></span><code><span class="nf">resumableSimple</span> <span class="ow">::</span> <span class="p">(</span><span class="n">forall</span> <span class="n">q</span> <span class="n">x</span><span class="o">.</span> <span class="n">eff</span> <span class="n">q</span> <span class="n">x</span> <span class="ow">-&gt;</span> <span class="kt">Sem</span> <span class="n">r</span> <span class="p">(</span><span class="kt">Either</span> <span class="n">err</span> <span class="n">x</span><span class="p">))</span> <span class="ow">-&gt;</span> <span class="kt">InterpreterFor</span> <span class="p">(</span><span class="kt">Resumable</span> <span class="n">err</span> <span class="n">eff</span><span class="p">)</span> <span class="n">r</span>
</code></pre></div>

<p>Or something of the like.</p>
<ul>
<li><code>Stop</code> is intended to be used only by an interpreter that signals when a <code>Resumable</code> should abort, right? In that case, <code>resumableFor</code>'s <code>Stop bigErr</code> constraint seems weird; you may want to change that to <code>Error</code>.</li>
</ul></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/7334dc60b6aef6a75cd9284126231f13c76926a5?x=x&amp;version=4"></a><div class="content"><a class="author">Torsten Schmits</a><div class="metadata"><a href="#212474103" name="212474103"><div>2020-10-06 19:32:12</div></a></div><div class="text"><p>yeah the Prelude is just copied from another project, don't mind it. and providing some more convenient combinators is definitely on my list</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/7334dc60b6aef6a75cd9284126231f13c76926a5?x=x&amp;version=4"></a><div class="content"><a class="author">Torsten Schmits</a><div class="metadata"><a href="#212474141" name="212474141"><div>2020-10-06 19:32:39</div></a></div><div class="text"><p>and the <code>Stop</code> constraint, I noticed as well</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/7334dc60b6aef6a75cd9284126231f13c76926a5?x=x&amp;version=4"></a><div class="content"><a class="author">Torsten Schmits</a><div class="metadata"><a href="#212475814" name="212475814"><div>2020-10-06 19:47:00</div></a></div><div class="text"><p>I think I just generally find it helpful to have these signatures explicit when I come back to it later to change something</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/7334dc60b6aef6a75cd9284126231f13c76926a5?x=x&amp;version=4"></a><div class="content"><a class="author">Torsten Schmits</a><div class="metadata"><a href="#212476156" name="212476156"><div>2020-10-06 19:50:08</div></a></div><div class="text"><p>btw, could you imagine a way that errors could be made a first-class component of the weavings?</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/f1ec33bcc6144366b30e479d6b3bed74cdb9f611?x=x&amp;version=4"></a><div class="content"><a class="author">Love Waern (King of the Homeless)</a><div class="metadata"><a href="#212481928" name="212481928"><div>2020-10-06 20:33:20</div></a></div><div class="text"><p>Not sure what you mean by that. As in, having error management be part of the definition of <code>Weaving</code>? I don't think that's a good idea.</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/7334dc60b6aef6a75cd9284126231f13c76926a5?x=x&amp;version=4"></a><div class="content"><a class="author">Torsten Schmits</a><div class="metadata"><a href="#212482116" name="212482116"><div>2020-10-06 20:34:52</div></a></div><div class="text"><p>yeah, something like that, like bifunctor IO approaches. I'm just thinking that it is such an integral part of (at least empirically from my perspective) effects that I feel it should be more prominent</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/f1ec33bcc6144366b30e479d6b3bed74cdb9f611?x=x&amp;version=4"></a><div class="content"><a class="author">Love Waern (King of the Homeless)</a><div class="metadata"><a href="#212482713" name="212482713"><div>2020-10-06 20:39:52</div></a></div><div class="text"><p>That would be a <em>big</em> change I wouldn't know how to approach properly. I feel that's something best left for future work, once effect systems are more properly understood.</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/f1ec33bcc6144366b30e479d6b3bed74cdb9f611?x=x&amp;version=4"></a><div class="content"><a class="author">Love Waern (King of the Homeless)</a><div class="metadata"><a href="#212482790" name="212482790"><div>2020-10-06 20:40:23</div></a></div><div class="text"><p>I wouldn't be a proponent of having it be part of <code>polysemy</code>.</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/f1ec33bcc6144366b30e479d6b3bed74cdb9f611?x=x&amp;version=4"></a><div class="content"><a class="author">Love Waern (King of the Homeless)</a><div class="metadata"><a href="#212483129" name="212483129"><div>2020-10-06 20:43:22</div></a></div><div class="text"><p>It's... maybe-ish possible? But the paths I see wouldn't gel with <code>polysemy</code>'s architecture.</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/7334dc60b6aef6a75cd9284126231f13c76926a5?x=x&amp;version=4"></a><div class="content"><a class="author">Torsten Schmits</a><div class="metadata"><a href="#212483249" name="212483249"><div>2020-10-06 20:44:28</div></a></div><div class="text"><p>I didn't want to propose this as a feature for Polysemy, just a general idea</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/7334dc60b6aef6a75cd9284126231f13c76926a5?x=x&amp;version=4"></a><div class="content"><a class="author">Torsten Schmits</a><div class="metadata"><a href="#212483278" name="212483278"><div>2020-10-06 20:44:48</div></a></div><div class="text"><p>would be interesting, in any case</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/f1ec33bcc6144366b30e479d6b3bed74cdb9f611?x=x&amp;version=4"></a><div class="content"><a class="author">Love Waern (King of the Homeless)</a><div class="metadata"><a href="#212483345" name="212483345"><div>2020-10-06 20:45:19</div></a></div><div class="text"><p>I'm sympathetic; exceptions are important enough to be given special treatment. It's something that warrants more research.</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/f1ec33bcc6144366b30e479d6b3bed74cdb9f611?x=x&amp;version=4"></a><div class="content"><a class="author">Love Waern (King of the Homeless)</a><div class="metadata"><a href="#212483521" name="212483521"><div>2020-10-06 20:46:34</div></a></div><div class="text"><p>Perhaps something I can look into once I finally release the effect library of my own.</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/7334dc60b6aef6a75cd9284126231f13c76926a5?x=x&amp;version=4"></a><div class="content"><a class="author">Torsten Schmits</a><div class="metadata"><a href="#212483755" name="212483755"><div>2020-10-06 20:48:39</div></a></div><div class="text"><p>oh, is that in the works??</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/f1ec33bcc6144366b30e479d6b3bed74cdb9f611?x=x&amp;version=4"></a><div class="content"><a class="author">Love Waern (King of the Homeless)</a><div class="metadata"><a href="#212484005" name="212484005"><div>2020-10-06 20:51:19</div></a></div><div class="text"><p>It's honestly already finished. I'm really only putting a few finishing touches on the documentation.</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/f1ec33bcc6144366b30e479d6b3bed74cdb9f611?x=x&amp;version=4"></a><div class="content"><a class="author">Love Waern (King of the Homeless)</a><div class="metadata"><a href="#212484030" name="212484030"><div>2020-10-06 20:51:37</div></a></div><div class="text"><p>Probably be releasing it in the weekend.</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/7334dc60b6aef6a75cd9284126231f13c76926a5?x=x&amp;version=4"></a><div class="content"><a class="author">Torsten Schmits</a><div class="metadata"><a href="#212484210" name="212484210"><div>2020-10-06 20:53:05</div></a></div><div class="text"><p>just casually breaking some huge news <span aria-label="sweat smile" class="emoji emoji-1f605" role="img" title="sweat smile">:sweat_smile:</span></p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/f1ec33bcc6144366b30e479d6b3bed74cdb9f611?x=x&amp;version=4"></a><div class="content"><a class="author">Love Waern (King of the Homeless)</a><div class="metadata"><a href="#212484462" name="212484462"><div>2020-10-06 20:55:26</div></a></div><div class="text"><p>I think I gave hints here and there. :P Eh; I don't think it'll rival <code>polysemy</code>.  It's too complicated for that. However, it does do stuff no other effect library does that makes it very powerful, which is why I'm releasing it.</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/7334dc60b6aef6a75cd9284126231f13c76926a5?x=x&amp;version=4"></a><div class="content"><a class="author">Torsten Schmits</a><div class="metadata"><a href="#212484571" name="212484571"><div>2020-10-06 20:56:17</div></a></div><div class="text"><p>sounds intriguing!</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/f1ec33bcc6144366b30e479d6b3bed74cdb9f611?x=x&amp;version=4"></a><div class="content"><a class="author">Love Waern (King of the Homeless)</a><div class="metadata"><a href="#212484578" name="212484578"><div>2020-10-06 20:56:22</div></a></div><div class="text"><p>It's also why I'm documenting the hell out of it.</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/7334dc60b6aef6a75cd9284126231f13c76926a5?x=x&amp;version=4"></a><div class="content"><a class="author">Torsten Schmits</a><div class="metadata"><a href="#212486411" name="212486411"><div>2020-10-06 21:11:39</div></a></div><div class="text"><p>could you explain what you did in the rewrite of <code>resumableFor</code> where you use the <code>k</code> twice?</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/7334dc60b6aef6a75cd9284126231f13c76926a5?x=x&amp;version=4"></a><div class="content"><a class="author">Torsten Schmits</a><div class="metadata"><a href="#212486519" name="212486519"><div>2020-10-06 21:12:22</div></a></div><div class="text"><div class="codehilite" data-code-language="Haskell"><pre><span></span><code>        <span class="n">fmap</span> <span class="p">(</span><span class="n">distribEither</span> <span class="n">s</span> <span class="n">ex</span><span class="p">)</span> <span class="o">$</span> <span class="n">runSem</span> <span class="p">(</span><span class="n">runStop</span> <span class="n">sem'</span><span class="p">)</span> <span class="n">k</span> <span class="o">&gt;&gt;=</span> <span class="nf">\</span><span class="kr">case</span>
          <span class="kt">Left</span> <span class="n">exc</span> <span class="ow">-&gt;</span> <span class="n">maybe</span> <span class="p">(</span><span class="n">k</span> <span class="o">$</span> <span class="n">inj</span> <span class="o">$</span> <span class="kt">Stop</span> <span class="n">exc</span><span class="p">)</span> <span class="p">(</span><span class="n">return</span> <span class="o">.</span> <span class="kt">Left</span><span class="p">)</span> <span class="p">(</span><span class="n">from</span> <span class="n">exc</span><span class="p">)</span>
          <span class="kt">Right</span> <span class="n">a</span>  <span class="ow">-&gt;</span> <span class="n">return</span> <span class="p">(</span><span class="kt">Right</span> <span class="n">a</span><span class="p">)</span>
</code></pre></div></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/f1ec33bcc6144366b30e479d6b3bed74cdb9f611?x=x&amp;version=4"></a><div class="content"><a class="author">Love Waern (King of the Homeless)</a><div class="metadata"><a href="#212487451" name="212487451"><div>2020-10-06 21:20:49</div></a></div><div class="text"><p>So <code>k :: forall x. Union r (Sem r) x -&gt; m x</code> for the universally quantified monad <code>m</code>. This can be thought of as a <code>m</code>-based handler for effects in <code>r</code>; i.e. an implementation of those effects for <code>m</code>. In <code>k $ inj $ Stop exc</code>, I'm using <code>k</code> explicitly to perform the <code>Stop exc</code> effect in <code>m</code> (which I can do since <code>Member (Stop exc) r</code>). This is equivalent to <code>runSem (stop exc) k</code>.</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/7334dc60b6aef6a75cd9284126231f13c76926a5?x=x&amp;version=4"></a><div class="content"><a class="author">Torsten Schmits</a><div class="metadata"><a href="#212487823" name="212487823"><div>2020-10-06 21:24:34</div></a></div><div class="text"><p>is there an advantage over <code>runSem (stop exc) k</code>?</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/f1ec33bcc6144366b30e479d6b3bed74cdb9f611?x=x&amp;version=4"></a><div class="content"><a class="author">Love Waern (King of the Homeless)</a><div class="metadata"><a href="#212487916" name="212487916"><div>2020-10-06 21:25:28</div></a></div><div class="text"><p>Faster. That's it, really. With enough inlining, GHC will reduce <code>runSem (stop exc) k</code> to <code>k $ inj $ Stop exc</code>.</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/7334dc60b6aef6a75cd9284126231f13c76926a5?x=x&amp;version=4"></a><div class="content"><a class="author">Torsten Schmits</a><div class="metadata"><a href="#212488004" name="212488004"><div>2020-10-06 21:26:14</div></a></div><div class="text"><p>ah, ok. and why did I not have to use <code>k</code> twice? what is the equivalent of that in my implementation?</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/f1ec33bcc6144366b30e479d6b3bed74cdb9f611?x=x&amp;version=4"></a><div class="content"><a class="author">Love Waern (King of the Homeless)</a><div class="metadata"><a href="#212488015" name="212488015"><div>2020-10-06 21:26:21</div></a></div><div class="text"><p>you can also just do:</p>
<div class="codehilite" data-code-language="Haskell"><pre><span></span><code>  <span class="n">fmap</span> <span class="p">(</span><span class="n">distribEither</span> <span class="n">s</span> <span class="n">ex</span><span class="p">)</span> <span class="o">$</span> <span class="p">(`</span><span class="n">runSem</span><span class="p">`</span> <span class="n">k</span><span class="p">)</span> <span class="o">$</span> <span class="n">sem'</span> <span class="o">&gt;&gt;=</span> <span class="nf">\</span><span class="kr">case</span>
    <span class="kt">Left</span> <span class="n">exc</span> <span class="ow">-&gt;</span> <span class="n">maybe</span> <span class="p">(</span><span class="n">stop</span> <span class="n">exc</span><span class="p">)</span> <span class="p">(</span><span class="n">return</span> <span class="o">.</span> <span class="kt">Left</span><span class="p">)</span> <span class="p">(</span><span class="n">from</span> <span class="n">exc</span><span class="p">)</span>
    <span class="kt">Right</span> <span class="n">a</span>  <span class="ow">-&gt;</span> <span class="n">return</span> <span class="p">(</span><span class="kt">Right</span> <span class="n">a</span><span class="p">)</span>
</code></pre></div>

<p>Which is perhaps easier to understand</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/f1ec33bcc6144366b30e479d6b3bed74cdb9f611?x=x&amp;version=4"></a><div class="content"><a class="author">Love Waern (King of the Homeless)</a><div class="metadata"><a href="#212488065" name="212488065"><div>2020-10-06 21:26:54</div></a></div><div class="text"><p>Maybe that's what you did.</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/7334dc60b6aef6a75cd9284126231f13c76926a5?x=x&amp;version=4"></a><div class="content"><a class="author">Torsten Schmits</a><div class="metadata"><a href="#212488070" name="212488070"><div>2020-10-06 21:26:57</div></a></div><div class="text"><p>ah, it's in <code>resumePartial</code></p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/7334dc60b6aef6a75cd9284126231f13c76926a5?x=x&amp;version=4"></a><div class="content"><a class="author">Torsten Schmits</a><div class="metadata"><a href="#212488084" name="212488084"><div>2020-10-06 21:27:04</div></a></div><div class="text"><p>great, got it!</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/7334dc60b6aef6a75cd9284126231f13c76926a5?x=x&amp;version=4"></a><div class="content"><a class="author">Torsten Schmits</a><div class="metadata"><a href="#212488153" name="212488153"><div>2020-10-06 21:27:48</div></a></div><div class="text"><p>just a few hours and half the knowledge about the data flow is already gone</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/7334dc60b6aef6a75cd9284126231f13c76926a5?x=x&amp;version=4"></a><div class="content"><a class="author">Torsten Schmits</a><div class="metadata"><a href="#212488226" name="212488226"><div>2020-10-06 21:28:08</div></a></div><div class="text"><p>gotta stare at it a little longer!</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/7334dc60b6aef6a75cd9284126231f13c76926a5?x=x&amp;version=4"></a><div class="content"><a class="author">Torsten Schmits</a><div class="metadata"><a href="#212494956" name="212494956"><div>2020-10-06 22:40:31</div></a></div><div class="text"><p>alright, implemented most of your suggestions. can't deny that the code duplication makes me itchy though <span aria-label="sweat smile" class="emoji emoji-1f605" role="img" title="sweat smile">:sweat_smile:</span> </p>
<p>also I added a variant of <code>resumeFor</code> that uses <code>Either</code> for the small exception, so the unhandled error can be transformed as well.</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/f1ec33bcc6144366b30e479d6b3bed74cdb9f611?x=x&amp;version=4"></a><div class="content"><a class="author">Love Waern (King of the Homeless)</a><div class="metadata"><a href="#212495795" name="212495795"><div>2020-10-06 22:51:50</div></a></div><div class="text"><p>You forgot the most important part: the updated type signatures!</p>
<div class="codehilite" data-code-language="Haskell"><pre><span></span><code><span class="nf">resumable</span> <span class="ow">::</span>
  <span class="err">âˆ€</span> <span class="n">eff</span> <span class="n">err</span> <span class="n">r</span> <span class="o">.</span>
  <span class="kt">InterpreterFor</span> <span class="n">eff</span> <span class="p">(</span><span class="kt">Stop</span> <span class="n">err</span> <span class="kt">':</span> <span class="n">r</span><span class="p">)</span> <span class="ow">-&gt;</span>
  <span class="kt">InterpreterFor</span> <span class="p">(</span><span class="kt">Resumable</span> <span class="n">err</span> <span class="n">eff</span><span class="p">)</span> <span class="n">r</span>
</code></pre></div>

<p>That's what I meant by "relaxed significantly".</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/f1ec33bcc6144366b30e479d6b3bed74cdb9f611?x=x&amp;version=4"></a><div class="content"><a class="author">Love Waern (King of the Homeless)</a><div class="metadata"><a href="#212495896" name="212495896"><div>2020-10-06 22:53:08</div></a></div><div class="text"><p>The way <code>resumable</code> looks now, you can't make use of any effects in <code>r</code> in the provided interpreter.</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/7334dc60b6aef6a75cd9284126231f13c76926a5?x=x&amp;version=4"></a><div class="content"><a class="author">Torsten Schmits</a><div class="metadata"><a href="#212496222" name="212496222"><div>2020-10-06 22:58:19</div></a></div><div class="text"><p>ahhhh</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/7334dc60b6aef6a75cd9284126231f13c76926a5?x=x&amp;version=4"></a><div class="content"><a class="author">Torsten Schmits</a><div class="metadata"><a href="#212496225" name="212496225"><div>2020-10-06 22:58:22</div></a></div><div class="text"><p>wonderful</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/7334dc60b6aef6a75cd9284126231f13c76926a5?x=x&amp;version=4"></a><div class="content"><a class="author">Torsten Schmits</a><div class="metadata"><a href="#212496483" name="212496483"><div>2020-10-06 23:01:39</div></a></div><div class="text"><p>I haven't put any thought into <code>runResumable</code> though, it just catches <code>Error</code></p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/7334dc60b6aef6a75cd9284126231f13c76926a5?x=x&amp;version=4"></a><div class="content"><a class="author">Torsten Schmits</a><div class="metadata"><a href="#212496505" name="212496505"><div>2020-10-06 23:01:57</div></a></div><div class="text"><p>do you think it is reasonable to have that separate <code>Stop</code> effect?</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/f1ec33bcc6144366b30e479d6b3bed74cdb9f611?x=x&amp;version=4"></a><div class="content"><a class="author">Love Waern (King of the Homeless)</a><div class="metadata"><a href="#212496736" name="212496736"><div>2020-10-06 23:04:58</div></a></div><div class="text"><p>I'd say so. The ability to <code>catch</code> is meaningless inside the interpreter provided to <code>resumable</code>. <code>Stop exc</code> also means it doesn't conflict with a potential <code>Error exc</code> effect the user may make use of.</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/f1ec33bcc6144366b30e479d6b3bed74cdb9f611?x=x&amp;version=4"></a><div class="content"><a class="author">Love Waern (King of the Homeless)</a><div class="metadata"><a href="#212496753" name="212496753"><div>2020-10-06 23:05:10</div></a></div><div class="text"><p><code>runResumable</code> looks fine, btw.</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/7334dc60b6aef6a75cd9284126231f13c76926a5?x=x&amp;version=4"></a><div class="content"><a class="author">Torsten Schmits</a><div class="metadata"><a href="#212496824" name="212496824"><div>2020-10-06 23:06:05</div></a></div><div class="text"><p>but it means that with <code>runResumable</code>, you can't use <code>Stop</code></p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/7334dc60b6aef6a75cd9284126231f13c76926a5?x=x&amp;version=4"></a><div class="content"><a class="author">Torsten Schmits</a><div class="metadata"><a href="#212496856" name="212496856"><div>2020-10-06 23:06:58</div></a></div><div class="text"><p>what would be a use case of <code>runResumable</code> that wouldn't be possible with <code>resumable</code>?</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/f1ec33bcc6144366b30e479d6b3bed74cdb9f611?x=x&amp;version=4"></a><div class="content"><a class="author">Love Waern (King of the Homeless)</a><div class="metadata"><a href="#212496987" name="212496987"><div>2020-10-06 23:09:11</div></a></div><div class="text"><p>Yeah. <code>Stop</code> is only intended to be used specifically by the interpreters provided to <code>resumable/For</code>, right? <code>runResumable</code> is a different beast. It uses <code>Error exc</code> because it needs to catch, and the <code>Error exc</code> effect is also used by other parts of the program -- including the eventual <code>eff</code> interpreter, which may throw an exception when interpreting <code>eff</code>.</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/f1ec33bcc6144366b30e479d6b3bed74cdb9f611?x=x&amp;version=4"></a><div class="content"><a class="author">Love Waern (King of the Homeless)</a><div class="metadata"><a href="#212497142" name="212497142"><div>2020-10-06 23:11:05</div></a></div><div class="text"><p>There is no use case of <code>runResumable</code> that wouldn't be possible with <code>resumable</code>. <code>resumable</code> can be used to implement everything else. <code>runResumable</code> and <code>resumableFor</code> are useful specializations.</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/7334dc60b6aef6a75cd9284126231f13c76926a5?x=x&amp;version=4"></a><div class="content"><a class="author">Torsten Schmits</a><div class="metadata"><a href="#212497253" name="212497253"><div>2020-10-06 23:12:21</div></a></div><div class="text"><p>right, right. maybe it should be renamed as <code>catchResumable</code> or so.</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/7334dc60b6aef6a75cd9284126231f13c76926a5?x=x&amp;version=4"></a><div class="content"><a class="author">Torsten Schmits</a><div class="metadata"><a href="#212497293" name="212497293"><div>2020-10-06 23:12:51</div></a></div><div class="text"><p>I'm still trying to wrap my head around what precisely we're abstracting here, I've basically started from the middle</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/f1ec33bcc6144366b30e479d6b3bed74cdb9f611?x=x&amp;version=4"></a><div class="content"><a class="author">Love Waern (King of the Homeless)</a><div class="metadata"><a href="#212497369" name="212497369"><div>2020-10-06 23:13:50</div></a></div><div class="text"><p>I still view this as <code>Exceptional</code>. It's for safely using effects that may throw exceptions by forcing application code to eventually handle them.</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/f1ec33bcc6144366b30e479d6b3bed74cdb9f611?x=x&amp;version=4"></a><div class="content"><a class="author">Love Waern (King of the Homeless)</a><div class="metadata"><a href="#212497481" name="212497481"><div>2020-10-06 23:15:06</div></a></div><div class="text"><p>The interpreter provided to <code>resumable</code> defines both how to interpret <code>eff</code> and when an exception is thrown (through <code>Stop</code>).</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/7334dc60b6aef6a75cd9284126231f13c76926a5?x=x&amp;version=4"></a><div class="content"><a class="author">Torsten Schmits</a><div class="metadata"><a href="#212497504" name="212497504"><div>2020-10-06 23:15:37</div></a></div><div class="text"><p>I guess I'm wondering about what intention is being signaled when using <code>stop</code>, and how it would be more indicated than <code>throw</code> in isolation (i.e. not relating it to other interpreters)</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/7334dc60b6aef6a75cd9284126231f13c76926a5?x=x&amp;version=4"></a><div class="content"><a class="author">Torsten Schmits</a><div class="metadata"><a href="#212497622" name="212497622"><div>2020-10-06 23:17:18</div></a></div><div class="text"><p><span class="user-mention silent" data-user-id="254034">Love Waern (King of the Homeless)</span> <a href="#narrow/stream/216942-Polysemy/topic/cross-interpreter.20errors/near/212497481">said</a>:</p>
<blockquote>
<p>The interpreter provided to <code>resumable</code> defines both how to interpret <code>eff</code> and when an exception is thrown (through <code>Stop</code>).</p>
</blockquote>
<p>right, we're explicitly providing the interpreter as a stopping one</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/f1ec33bcc6144366b30e479d6b3bed74cdb9f611?x=x&amp;version=4"></a><div class="content"><a class="author">Love Waern (King of the Homeless)</a><div class="metadata"><a href="#212497701" name="212497701"><div>2020-10-06 23:18:17</div></a></div><div class="text"><p>To me, <code>stop</code> signals throwing an exception. Perhaps the naming is unfortunate, but <code>throw</code> is already taken. We don't want to use <code>Error</code> in <code>resumable</code> because we have no use for <code>catch</code>.</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/7334dc60b6aef6a75cd9284126231f13c76926a5?x=x&amp;version=4"></a><div class="content"><a class="author">Torsten Schmits</a><div class="metadata"><a href="#212497703" name="212497703"><div>2020-10-06 23:18:24</div></a></div><div class="text"><p><span class="user-mention silent" data-user-id="254034">Love Waern (King of the Homeless)</span> <a href="#narrow/stream/216942-Polysemy/topic/cross-interpreter.20errors/near/212497369">said</a>:</p>
<blockquote>
<p>I still view this as <code>Exceptional</code>.</p>
</blockquote>
<p>is there any preexisting connotation to this term that I don't know of?</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/f1ec33bcc6144366b30e479d6b3bed74cdb9f611?x=x&amp;version=4"></a><div class="content"><a class="author">Love Waern (King of the Homeless)</a><div class="metadata"><a href="#212497761" name="212497761"><div>2020-10-06 23:19:34</div></a></div><div class="text"><p>Nah, I mean it as a simple play on words: <code>Exceptional err eff</code>: "the effect <code>eff</code> is <em>exceptional</em>! I.e. it may throw exceptions of <code>err</code>".</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/7334dc60b6aef6a75cd9284126231f13c76926a5?x=x&amp;version=4"></a><div class="content"><a class="author">Torsten Schmits</a><div class="metadata"><a href="#212497765" name="212497765"><div>2020-10-06 23:19:36</div></a></div><div class="text"><p><span class="user-mention silent" data-user-id="254034">Love Waern (King of the Homeless)</span> <a href="#narrow/stream/216942-Polysemy/topic/cross-interpreter.20errors/near/212497701">said</a>:</p>
<blockquote>
<p>To me, <code>stop</code> signals throwing an exception. Perhaps the naming is unfortunate, but <code>throw</code> is already taken. We don't want to use <code>Error</code> in <code>resumable</code> because we have no use for <code>catch</code>.</p>
</blockquote>
<p>right, I think about it as being less "fatal" than an error</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/7334dc60b6aef6a75cd9284126231f13c76926a5?x=x&amp;version=4"></a><div class="content"><a class="author">Torsten Schmits</a><div class="metadata"><a href="#212497891" name="212497891"><div>2020-10-06 23:20:55</div></a></div><div class="text"><p>it all makes sense but I have the feeling there's much more to it <span aria-label="sweat smile" class="emoji emoji-1f605" role="img" title="sweat smile">:sweat_smile:</span> errors are really complex</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/7334dc60b6aef6a75cd9284126231f13c76926a5?x=x&amp;version=4"></a><div class="content"><a class="author">Torsten Schmits</a><div class="metadata"><a href="#212497941" name="212497941"><div>2020-10-06 23:21:58</div></a></div><div class="text"><p>alright, I guess I'm satisfied. now to implement some combinators</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/7334dc60b6aef6a75cd9284126231f13c76926a5?x=x&amp;version=4"></a><div class="content"><a class="author">Torsten Schmits</a><div class="metadata"><a href="#212498005" name="212498005"><div>2020-10-06 23:22:29</div></a></div><div class="text"><p>one thing I do a lot is to just rethrow errors, maybe wrapped in a larger one</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/7334dc60b6aef6a75cd9284126231f13c76926a5?x=x&amp;version=4"></a><div class="content"><a class="author">Torsten Schmits</a><div class="metadata"><a href="#212498129" name="212498129"><div>2020-10-06 23:24:13</div></a></div><div class="text"><p>still wondering about a better name. I like <em>resume</em>, but <em>stop</em> is not optimal. something like short-circuitingâ€¦</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/f1ec33bcc6144366b30e479d6b3bed74cdb9f611?x=x&amp;version=4"></a><div class="content"><a class="author">Love Waern (King of the Homeless)</a><div class="metadata"><a href="#212498232" name="212498232"><div>2020-10-06 23:26:05</div></a></div><div class="text"><p><code>abort</code> is the one left from typical names for throwing exceptions, but even that feels too fatal. I dunno.</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/7334dc60b6aef6a75cd9284126231f13c76926a5?x=x&amp;version=4"></a><div class="content"><a class="author">Torsten Schmits</a><div class="metadata"><a href="#212498249" name="212498249"><div>2020-10-06 23:26:24</div></a></div><div class="text"><p>that's what I used at first <span aria-label="sweat smile" class="emoji emoji-1f605" role="img" title="sweat smile">:sweat_smile:</span></p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/7334dc60b6aef6a75cd9284126231f13c76926a5?x=x&amp;version=4"></a><div class="content"><a class="author">Torsten Schmits</a><div class="metadata"><a href="#212498255" name="212498255"><div>2020-10-06 23:26:33</div></a></div><div class="text"><p>but then I felt weird talking about abortions all the time</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/f1ec33bcc6144366b30e479d6b3bed74cdb9f611?x=x&amp;version=4"></a><div class="content"><a class="author">Love Waern (King of the Homeless)</a><div class="metadata"><a href="#212498300" name="212498300"><div>2020-10-06 23:27:24</div></a></div><div class="text"><p>Anyway, I need to sleep now. Talk to you later.</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/7334dc60b6aef6a75cd9284126231f13c76926a5?x=x&amp;version=4"></a><div class="content"><a class="author">Torsten Schmits</a><div class="metadata"><a href="#212498307" name="212498307"><div>2020-10-06 23:27:33</div></a></div><div class="text"><p>good night!</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/7334dc60b6aef6a75cd9284126231f13c76926a5?x=x&amp;version=4"></a><div class="content"><a class="author">Torsten Schmits</a><div class="metadata"><a href="#212581527" name="212581527"><div>2020-10-07 16:07:23</div></a></div><div class="text"><p>released!</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/7334dc60b6aef6a75cd9284126231f13c76926a5?x=x&amp;version=4"></a><div class="content"><a class="author">Torsten Schmits</a><div class="metadata"><a href="#212581555" name="212581555"><div>2020-10-07 16:07:42</div></a></div><div class="text"><p><a href="https://hackage.haskell.org/package/polysemy-resume">https://hackage.haskell.org/package/polysemy-resume</a></p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/7334dc60b6aef6a75cd9284126231f13c76926a5?x=x&amp;version=4"></a><div class="content"><a class="author">Torsten Schmits</a><div class="metadata"><a href="#212581715" name="212581715"><div>2020-10-07 16:08:53</div></a></div><div class="text"><p>todo now: multiple errors?</p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/7334dc60b6aef6a75cd9284126231f13c76926a5?x=x&amp;version=4"></a><div class="content"><a class="author">Torsten Schmits</a><div class="metadata"><a href="#212610307" name="212610307"><div>2020-10-07 19:49:43</div></a></div><div class="text"><p>added an operator for <code>Resumable</code>:</p>
<div class="codehilite" data-code-language="Haskell"><pre><span></span><code><span class="kt">Member</span> <span class="p">(</span><span class="kt">Http</span> <span class="o">!</span> <span class="kt">HttpError</span><span class="p">)</span> <span class="n">r</span> <span class="ow">=&gt;</span>
</code></pre></div></div></div></div></div></div><div class="ui vertical footer segment"><a href="https://github.com/srid/zulip-archive">Powered by Haskell</a> | Questions? Contact <a href="https://www.srid.ca">srid</a></div></div></body></html>