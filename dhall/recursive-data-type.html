<html lang="en"><head><meta content="text/html; charset=utf-8" http-equiv="Content-Type"><meta content="width=device-width, initial-scale=1" name="viewport"><meta content="I&#39;m a Dhall newbie and am already stuck with recursive data types. I&#39;ve tried reading https://docs.dhall-lang.org/howtos/How-to-translate-recursive-code-to-Dhall.html#recursive-record and https://docs.dhall-lang.org/howtos/How-to-translate-recursive-code-to-Dhall.html#recursive-sum-type and neither " name="description"><link href="https://funprog.srid.ca/dhall/recursive-data-type.html" rel="canonical"><meta property="og:title" content="recursive data type - Dhall"><meta property="og:site_name" content="Functional Programming Zulip Archive"><meta property="og:type" content="article"><meta property="og:article:section" content="Dhall"><meta property="og:article:modified_time" content="2020-08-24T19:07:24Z"><meta property="og:article:published_time" content="2020-08-22T08:23:44Z"><meta property="og:image" content="https://secure.gravatar.com/avatar/60df8c1a366ab1bf4378154e71a93367?d=identicon&amp;version=1"><title>recursive data type - Dhall</title><style type="text/css">
div#thesite
{
  font-family   : "Open Sans", sans-serif;
  font-size     : 1em !important;
  margin-top    : 1em;
  margin-bottom : 1em;
}

div#thesite h1
{
  font-family : "Roboto", sans-serif;
  line-height : 1.19999em;
}

div#thesite h2
{
  font-family : "Roboto", sans-serif;
  line-height : 1.19999em;
}

div#thesite h3
{
  font-family : "Roboto", sans-serif;
  line-height : 1.19999em;
}

div#thesite h4
{
  font-family : "Roboto", sans-serif;
  line-height : 1.19999em;
}

div#thesite h5
{
  font-family : "Roboto", sans-serif;
  line-height : 1.19999em;
}

div#thesite h6
{
  font-family : "Roboto", sans-serif;
  line-height : 1.19999em;
}

div#thesite .ui.breadcrumb.rib .section
{
  font-family : "Roboto", sans-serif;
  line-height : 1.19999em;
}

div#thesite .header
{
  font-family : "Roboto", sans-serif;
  line-height : 1.19999em;
}

div#thesite .as-header
{
  font-family : "Roboto", sans-serif;
  line-height : 1.19999em;
}

div#thesite code, pre, tt
{
  font-family : "SFMono-Regular","Menlo","Monaco","Consolas","Liberation Mono","Courier New", monospace;
}

div#thesite .ui.breadcrumb.rib
{
  margin-bottom : 1em;
}



div#thesite .ui.comments.messages .comment .metadata a
{
  color : #808080;
}

div#thesite .ui.comments.messages .comment a.avatar img
{
  height : auto;
}

div#thesite .subtle
{
  color : #808080;
}


div#thesite .messages pre
{
  font-size : 85%;
  overflow  : auto;
  max-width : 100%;
}

div#thesite .messages .message_embed
{
  border-left  : solid 3px #808080;
  padding-left : 0.69999em;
}

div#thesite .messages .message_inline_image img
{
  max-width     : 100%;
  margin-bottom : 1em;
}


/* Generated with Clay, http://fvisser.nl/clay */</style><link href="https://cdnjs.cloudflare.com/ajax/libs/semantic-ui/2.4.1/semantic.min.css" rel="stylesheet"><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css" rel="stylesheet"><link href="https://fonts.googleapis.com/css?family=Open+Sans|Oswald&amp;display=swap" rel="stylesheet"><link href="https://fonts.googleapis.com/css?family=Roboto|Open+Sans&amp;display=swap" rel="stylesheet"></head><body><div id="thesite" class="ui text container"><div class="ui violet inverted top attached center aligned segment"><h1 class="ui huge header">recursive data type - Dhall</h1></div><div class="ui attached segment"><div class="ui message"><p>Welcome to the Functional Programming Zulip Chat Archive. You can join the chat <a href="https://funprog.zulipchat.com">here</a>.</p></div><div class="ui breadcrumb rib"><a href="/" class="section">Home</a><i class="right angle icon divider"></i><a href="/dhall/" class="section">#Dhall</a><i class="right angle icon divider"></i><div class="active section">recursive data type</div></div><div class="ui comments messages"><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/60df8c1a366ab1bf4378154e71a93367?d=identicon&amp;version=1"></a><div class="content"><a class="author">Saurabh Nanda</a><div class="metadata"><a href="#207714114" name="207714114"><div>2020-08-22 08:23:44</div></a></div><div class="text"><p>I'm a Dhall newbie and am already stuck with recursive data types. I've tried reading <a href="https://docs.dhall-lang.org/howtos/How-to-translate-recursive-code-to-Dhall.html#recursive-record">https://docs.dhall-lang.org/howtos/How-to-translate-recursive-code-to-Dhall.html#recursive-record</a> and <a href="https://docs.dhall-lang.org/howtos/How-to-translate-recursive-code-to-Dhall.html#recursive-sum-type">https://docs.dhall-lang.org/howtos/How-to-translate-recursive-code-to-Dhall.html#recursive-sum-type</a> and neither of them make sense to me. The unicode characters in the code-snippets are making things even harder.</p>
<p>What's going on there? Is that using RankNTypes or something in Dhall?</p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/60df8c1a366ab1bf4378154e71a93367?d=identicon&amp;version=1"></a><div class="content"><a class="author">Saurabh Nanda</a><div class="metadata"><a href="#207714217" name="207714217"><div>2020-08-22 08:26:10</div></a></div><div class="text"><p>Are there any more examples available elsewhere? If I'm creating a config-file that I want end-users to use, do they have to deal with this complication? Can it be hidden away? And if it can, is there some library or function that already does this? And gives a straighforward way to use recursive data-types in Dhall?</p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/374affb4db58caa9507f265d7fdf03fe?d=identicon&amp;version=1"></a><div class="content"><a class="author">Fintan Halpenny</a><div class="metadata"><a href="#207715086" name="207715086"><div>2020-08-22 08:57:17</div></a></div><div class="text"><p>It's been a while since I looked at this stuff but maybe I can help</p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/374affb4db58caa9507f265d7fdf03fe?d=identicon&amp;version=1"></a><div class="content"><a class="author">Fintan Halpenny</a><div class="metadata"><a href="#207715088" name="207715088"><div>2020-08-22 08:57:25</div></a></div><div class="text"><p>What's tripping you up exactly?</p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/374affb4db58caa9507f265d7fdf03fe?d=identicon&amp;version=1"></a><div class="content"><a class="author">Fintan Halpenny</a><div class="metadata"><a href="#207715138" name="207715138"><div>2020-08-22 08:58:41</div></a></div><div class="text"><p>It's not any easier but might be fun to look at. My friend Greg did up a recursion-schemes approach to recursive data types in Dhall: <a href="https://github.com/sellout/dada">https://github.com/sellout/dada</a></p>
<div class="message_embed"><a class="message_embed_image" href="https://github.com/sellout/dada" style="background-image: url(https://avatars1.githubusercontent.com/u/33031?s=400&amp;v=4)"></a><div class="data-container"><div class="message_embed_title"><a href="https://github.com/sellout/dada" title="sellout/dada">sellout/dada</a></div><div class="message_embed_description">A recursion scheme library for Dhall. Contribute to sellout/dada development by creating an account on GitHub.</div></div></div></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/374affb4db58caa9507f265d7fdf03fe?d=identicon&amp;version=1"></a><div class="content"><a class="author">Fintan Halpenny</a><div class="metadata"><a href="#207715472" name="207715472"><div>2020-08-22 09:09:00</div></a></div><div class="text"><p>Also, something to think about is that you may not _want_ to write a recursive type because you'll have to jump through these hoops</p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/374affb4db58caa9507f265d7fdf03fe?d=identicon&amp;version=1"></a><div class="content"><a class="author">Fintan Halpenny</a><div class="metadata"><a href="#207715476" name="207715476"><div>2020-08-22 09:09:18</div></a></div><div class="text"><p>Maybe your config could be simplified</p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/60df8c1a366ab1bf4378154e71a93367?d=identicon&amp;version=1"></a><div class="content"><a class="author">Saurabh Nanda</a><div class="metadata"><a href="#207720442" name="207720442"><div>2020-08-22 11:37:45</div></a></div><div class="text"><p>I'm writing a config file that needs to represent the navigation structure of a website. Which means that a <code>Page</code> type needs to have <code>Page</code> children. Is there any way to avoid recursion in the first place?</p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/60df8c1a366ab1bf4378154e71a93367?d=identicon&amp;version=1"></a><div class="content"><a class="author">Saurabh Nanda</a><div class="metadata"><a href="#207720551" name="207720551"><div>2020-08-22 11:40:14</div></a></div><div class="text"><p><span class="user-mention" data-user-id="251612">@Fintan Halpenny</span> is this what you're referring to - <a href="https://github.com/sellout/dada/blob/master/Recursive/Type">https://github.com/sellout/dada/blob/master/Recursive/Type</a> ?  This is equally opaque to me :-(</p>
<div class="message_embed"><a class="message_embed_image" href="https://github.com/sellout/dada/blob/master/Recursive/Type" style="background-image: url(https://avatars1.githubusercontent.com/u/33031?s=400&amp;v=4)"></a><div class="data-container"><div class="message_embed_title"><a href="https://github.com/sellout/dada/blob/master/Recursive/Type" title="sellout/dada">sellout/dada</a></div><div class="message_embed_description">A recursion scheme library for Dhall. Contribute to sellout/dada development by creating an account on GitHub.</div></div></div></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/374affb4db58caa9507f265d7fdf03fe?d=identicon&amp;version=1"></a><div class="content"><a class="author">Fintan Halpenny</a><div class="metadata"><a href="#207720565" name="207720565"><div>2020-08-22 11:41:08</div></a></div><div class="text"><p>Ya, maybe don't use dada <span aria-label="sweat smile" class="emoji emoji-1f605" role="img" title="sweat smile">:sweat_smile:</span></p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/374affb4db58caa9507f265d7fdf03fe?d=identicon&amp;version=1"></a><div class="content"><a class="author">Fintan Halpenny</a><div class="metadata"><a href="#207720601" name="207720601"><div>2020-08-22 11:42:03</div></a></div><div class="text"><p>Maybe you could have <code>Link</code> which is a morally a pointer to a <code>Page</code> and a <code>Page</code> is just a <code>List Link</code>?</p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/374affb4db58caa9507f265d7fdf03fe?d=identicon&amp;version=1"></a><div class="content"><a class="author">Fintan Halpenny</a><div class="metadata"><a href="#207720627" name="207720627"><div>2020-08-22 11:42:53</div></a></div><div class="text"><p>But let's say you do have a <code>Page</code> that has children, then it sounds exactly like the <code>Person</code> example you linked above</p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/374affb4db58caa9507f265d7fdf03fe?d=identicon&amp;version=1"></a><div class="content"><a class="author">Fintan Halpenny</a><div class="metadata"><a href="#207720631" name="207720631"><div>2020-08-22 11:43:03</div></a></div><div class="text"><p>What part of that example is tripping you up?</p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/60df8c1a366ab1bf4378154e71a93367?d=identicon&amp;version=1"></a><div class="content"><a class="author">Saurabh Nanda</a><div class="metadata"><a href="#207720681" name="207720681"><div>2020-08-22 11:44:32</div></a></div><div class="text"><p>the entire syntax. What's going on with the type declaration _conceptually_ and then what's going on when <code>example</code> is being declared. Why is the entire type reproduced there?</p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/60df8c1a366ab1bf4378154e71a93367?d=identicon&amp;version=1"></a><div class="content"><a class="author">Saurabh Nanda</a><div class="metadata"><a href="#207720685" name="207720685"><div>2020-08-22 11:44:56</div></a></div><div class="text"><p>Is this using RankNTypes? </p>
<div class="codehilite"><pre><span></span><code>let Person
    : Type
    = ∀(Person : Type) →
      ∀(MakePerson : { children : List Person, name : Text } → Person) →
        Person
</code></pre></div></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/60df8c1a366ab1bf4378154e71a93367?d=identicon&amp;version=1"></a><div class="content"><a class="author">Saurabh Nanda</a><div class="metadata"><a href="#207720701" name="207720701"><div>2020-08-22 11:45:39</div></a></div><div class="text"><p>what is the exact Haskell transliteration of that snippet? Probably that will make it click for me.</p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/60df8c1a366ab1bf4378154e71a93367?d=identicon&amp;version=1"></a><div class="content"><a class="author">Saurabh Nanda</a><div class="metadata"><a href="#207720892" name="207720892"><div>2020-08-22 11:51:23</div></a></div><div class="text"><p>my brain seems to be switching off as soon as I see <code>∀</code></p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/374affb4db58caa9507f265d7fdf03fe?d=identicon&amp;version=1"></a><div class="content"><a class="author">Fintan Halpenny</a><div class="metadata"><a href="#207720955" name="207720955"><div>2020-08-22 11:53:52</div></a></div><div class="text"><p>Haha ok, so let's break it down into it's parts</p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/374affb4db58caa9507f265d7fdf03fe?d=identicon&amp;version=1"></a><div class="content"><a class="author">Fintan Halpenny</a><div class="metadata"><a href="#207721004" name="207721004"><div>2020-08-22 11:54:36</div></a></div><div class="text"><p><code>let Person : Type</code> a thing called <code>Person</code> that is a <code>Type</code></p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/374affb4db58caa9507f265d7fdf03fe?d=identicon&amp;version=1"></a><div class="content"><a class="author">Fintan Halpenny</a><div class="metadata"><a href="#207721024" name="207721024"><div>2020-08-22 11:55:35</div></a></div><div class="text"><p>If we look later in the post it says that the <code>∀(Person : Type)</code> is different from the <code>let Person</code></p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/374affb4db58caa9507f265d7fdf03fe?d=identicon&amp;version=1"></a><div class="content"><a class="author">Fintan Halpenny</a><div class="metadata"><a href="#207721078" name="207721078"><div>2020-08-22 11:56:18</div></a></div><div class="text"><p>So this actually says <code>∀(_Person : Type)</code>: for all <code>_Person</code> which is a <code>Type</code></p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/374affb4db58caa9507f265d7fdf03fe?d=identicon&amp;version=1"></a><div class="content"><a class="author">Fintan Halpenny</a><div class="metadata"><a href="#207721156" name="207721156"><div>2020-08-22 11:58:06</div></a></div><div class="text"><p>The next line says <code>∀(MakePerson : { children : List _Person, name : Text } → _Person)</code>: We have a constructor <code>MakePerson</code> which consists of two components</p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/374affb4db58caa9507f265d7fdf03fe?d=identicon&amp;version=1"></a><div class="content"><a class="author">Fintan Halpenny</a><div class="metadata"><a href="#207721178" name="207721178"><div>2020-08-22 11:59:16</div></a></div><div class="text"><p>The first is <code>children</code>, which is a <code>List _Person</code>. So, a list of the types we passed in originally with the <code>∀(_Person : Type)</code></p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/374affb4db58caa9507f265d7fdf03fe?d=identicon&amp;version=1"></a><div class="content"><a class="author">Fintan Halpenny</a><div class="metadata"><a href="#207721183" name="207721183"><div>2020-08-22 11:59:29</div></a></div><div class="text"><p>And a <code>name</code> of type <code>Text</code></p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/374affb4db58caa9507f265d7fdf03fe?d=identicon&amp;version=1"></a><div class="content"><a class="author">Fintan Halpenny</a><div class="metadata"><a href="#207721253" name="207721253"><div>2020-08-22 12:00:37</div></a></div><div class="text"><p>Finally, we return this type <code>_Person</code></p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/374affb4db58caa9507f265d7fdf03fe?d=identicon&amp;version=1"></a><div class="content"><a class="author">Fintan Halpenny</a><div class="metadata"><a href="#207721317" name="207721317"><div>2020-08-22 12:02:27</div></a></div><div class="text"><p>What this translates into in Haskell is something like:</p>
<div class="codehilite"><pre><span></span><code><span class="kr">data</span> <span class="kt">Person</span> <span class="n">person</span> <span class="ow">=</span> <span class="p">{</span> <span class="n">name</span><span class="kt">:</span> <span class="kt">Text</span><span class="p">,</span> <span class="n">children</span> <span class="ow">=</span> <span class="p">[</span><span class="n">person</span><span class="p">]</span> <span class="p">}</span>
</code></pre></div></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/374affb4db58caa9507f265d7fdf03fe?d=identicon&amp;version=1"></a><div class="content"><a class="author">Fintan Halpenny</a><div class="metadata"><a href="#207721330" name="207721330"><div>2020-08-22 12:02:58</div></a></div><div class="text"><p>But if we try to use <code>Person</code> within <code>Person</code> we'd get <code>Person (Person (Person ....)))</code></p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/374affb4db58caa9507f265d7fdf03fe?d=identicon&amp;version=1"></a><div class="content"><a class="author">Fintan Halpenny</a><div class="metadata"><a href="#207721411" name="207721411"><div>2020-08-22 12:04:43</div></a></div><div class="text"><p>So the trick is that we need some sort of fixpoint structure that hides this away from us:</p>
<div class="codehilite"><pre><span></span><code><span class="kr">data</span> <span class="kt">Fix</span> <span class="n">f</span> <span class="ow">=</span> <span class="kt">MakeFix</span> <span class="p">{</span> <span class="n">unFix</span> <span class="ow">::</span> <span class="n">f</span> <span class="p">(</span><span class="kt">Fix</span> <span class="n">f</span><span class="p">)</span> <span class="p">}</span>
</code></pre></div></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/374affb4db58caa9507f265d7fdf03fe?d=identicon&amp;version=1"></a><div class="content"><a class="author">Fintan Halpenny</a><div class="metadata"><a href="#207721432" name="207721432"><div>2020-08-22 12:05:21</div></a></div><div class="text"><p>So, now we can say <code>Person' = Fix Person</code></p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/374affb4db58caa9507f265d7fdf03fe?d=identicon&amp;version=1"></a><div class="content"><a class="author">Fintan Halpenny</a><div class="metadata"><a href="#207721508" name="207721508"><div>2020-08-22 12:07:21</div></a></div><div class="text"><p>The final piece of the puzzle is that we want to "interpret" this structure into some target. To do this we fold over the <code>Fix</code> structure, peeling each layer off and applying some function to that layer</p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/374affb4db58caa9507f265d7fdf03fe?d=identicon&amp;version=1"></a><div class="content"><a class="author">Fintan Halpenny</a><div class="metadata"><a href="#207721513" name="207721513"><div>2020-08-22 12:07:37</div></a></div><div class="text"><p>In the Dhall example, they're doing this by just collecting the names</p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/374affb4db58caa9507f265d7fdf03fe?d=identicon&amp;version=1"></a><div class="content"><a class="author">Fintan Halpenny</a><div class="metadata"><a href="#207721561" name="207721561"><div>2020-08-22 12:08:18</div></a></div><div class="text"><p>Is any of that unclear to you?</p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/374affb4db58caa9507f265d7fdf03fe?d=identicon&amp;version=1"></a><div class="content"><a class="author">Fintan Halpenny</a><div class="metadata"><a href="#207721567" name="207721567"><div>2020-08-22 12:08:37</div></a></div><div class="text"><p>To understand this more you may want to look up material on recursion schemes</p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/60df8c1a366ab1bf4378154e71a93367?d=identicon&amp;version=1"></a><div class="content"><a class="author">Saurabh Nanda</a><div class="metadata"><a href="#207722990" name="207722990"><div>2020-08-22 12:47:03</div></a></div><div class="text"><p>this looks like a free monad of sorts to me.</p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/60df8c1a366ab1bf4378154e71a93367?d=identicon&amp;version=1"></a><div class="content"><a class="author">Saurabh Nanda</a><div class="metadata"><a href="#207723006" name="207723006"><div>2020-08-22 12:47:33</div></a></div><div class="text"><p>at the end, will the end-user (writing the config file) need to deal with all this complexity?</p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/60df8c1a366ab1bf4378154e71a93367?d=identicon&amp;version=1"></a><div class="content"><a class="author">Saurabh Nanda</a><div class="metadata"><a href="#207723080" name="207723080"><div>2020-08-22 12:49:23</div></a></div><div class="text"><p>so, <code>Person</code> is a type-level function that takes a type <code>X</code> another type-level function that uses that type <code>X</code> and finally gives as the type <code>X</code></p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/60df8c1a366ab1bf4378154e71a93367?d=identicon&amp;version=1"></a><div class="content"><a class="author">Saurabh Nanda</a><div class="metadata"><a href="#207723088" name="207723088"><div>2020-08-22 12:49:59</div></a></div><div class="text"><div class="codehilite"><pre><span></span><code>let Person = X -&gt; (MakePerson { children :: List X, name : Text} -&gt; X) -&gt; X
</code></pre></div></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/60df8c1a366ab1bf4378154e71a93367?d=identicon&amp;version=1"></a><div class="content"><a class="author">Saurabh Nanda</a><div class="metadata"><a href="#207723130" name="207723130"><div>2020-08-22 12:50:07</div></a></div><div class="text"><p>is that valid Dhall ^^</p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/374affb4db58caa9507f265d7fdf03fe?d=identicon&amp;version=1"></a><div class="content"><a class="author">Fintan Halpenny</a><div class="metadata"><a href="#207723241" name="207723241"><div>2020-08-22 12:53:26</div></a></div><div class="text"><p>It's sort of related. You can imagine it's <code>Free</code> without the <code>Pure</code> constructor</p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/374affb4db58caa9507f265d7fdf03fe?d=identicon&amp;version=1"></a><div class="content"><a class="author">Fintan Halpenny</a><div class="metadata"><a href="#207723296" name="207723296"><div>2020-08-22 12:54:29</div></a></div><div class="text"><p>I think you'd need the for all symbols for it be valid</p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/60df8c1a366ab1bf4378154e71a93367?d=identicon&amp;version=1"></a><div class="content"><a class="author">Saurabh Nanda</a><div class="metadata"><a href="#207723300" name="207723300"><div>2020-08-22 12:54:54</div></a></div><div class="text"><p>I'm on the verge of giving up. Is there an example of a config file that uses recursive data-types? How much complexity is leaked to the end-users? Because if this makes things complex for the end-users as well, it's not worth the effort at all. I will be unable to use Dhall for my project.</p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/374affb4db58caa9507f265d7fdf03fe?d=identicon&amp;version=1"></a><div class="content"><a class="author">Fintan Halpenny</a><div class="metadata"><a href="#207723313" name="207723313"><div>2020-08-22 12:55:41</div></a></div><div class="text"><p>Well, what are you trying to do?</p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/374affb4db58caa9507f265d7fdf03fe?d=identicon&amp;version=1"></a><div class="content"><a class="author">Fintan Halpenny</a><div class="metadata"><a href="#207723358" name="207723358"><div>2020-08-22 12:56:05</div></a></div><div class="text"><p>Because if you're supplying dhall to the end user you're expecting them to also know how to work with Dhall</p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/60df8c1a366ab1bf4378154e71a93367?d=identicon&amp;version=1"></a><div class="content"><a class="author">Saurabh Nanda</a><div class="metadata"><a href="#207723433" name="207723433"><div>2020-08-22 12:58:30</div></a></div><div class="text"><p>But only for defining config files. Which for most parts is defining records &amp; lists, and probably using a few <code>let</code> bindings to reduce duplication.</p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/60df8c1a366ab1bf4378154e71a93367?d=identicon&amp;version=1"></a><div class="content"><a class="author">Saurabh Nanda</a><div class="metadata"><a href="#207723454" name="207723454"><div>2020-08-22 12:59:09</div></a></div><div class="text"><p>I mean, isn't that one of the implicit (or explicit?) goals of Dhall? It should be easy to define configuration for casual users.</p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/60df8c1a366ab1bf4378154e71a93367?d=identicon&amp;version=1"></a><div class="content"><a class="author">Saurabh Nanda</a><div class="metadata"><a href="#207723469" name="207723469"><div>2020-08-22 12:59:44</div></a></div><div class="text"><p>I don't foresee casual users defining their own types and suchlike.</p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/60df8c1a366ab1bf4378154e71a93367?d=identicon&amp;version=1"></a><div class="content"><a class="author">Saurabh Nanda</a><div class="metadata"><a href="#207723553" name="207723553"><div>2020-08-22 13:01:30</div></a></div><div class="text"><p>or am I viewing Dhall the wrong way?</p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/374affb4db58caa9507f265d7fdf03fe?d=identicon&amp;version=1"></a><div class="content"><a class="author">Fintan Halpenny</a><div class="metadata"><a href="#207723625" name="207723625"><div>2020-08-22 13:03:10</div></a></div><div class="text"><p>Nah, that makes sense :)</p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/374affb4db58caa9507f265d7fdf03fe?d=identicon&amp;version=1"></a><div class="content"><a class="author">Fintan Halpenny</a><div class="metadata"><a href="#207723666" name="207723666"><div>2020-08-22 13:04:02</div></a></div><div class="text"><p>But if you want recursion you're going to have to jump through these hoops because Dhall is total</p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/374affb4db58caa9507f265d7fdf03fe?d=identicon&amp;version=1"></a><div class="content"><a class="author">Fintan Halpenny</a><div class="metadata"><a href="#207723682" name="207723682"><div>2020-08-22 13:04:17</div></a></div><div class="text"><p>And so can't express recursion as we're used to</p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/60df8c1a366ab1bf4378154e71a93367?d=identicon&amp;version=1"></a><div class="content"><a class="author">Saurabh Nanda</a><div class="metadata"><a href="#207723719" name="207723719"><div>2020-08-22 13:05:25</div></a></div><div class="text"><p>I mean if recursion is possible in any other way, then it <em>is</em> technically possible to have infinite recursion, right?</p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/374affb4db58caa9507f265d7fdf03fe?d=identicon&amp;version=1"></a><div class="content"><a class="author">Fintan Halpenny</a><div class="metadata"><a href="#207723720" name="207723720"><div>2020-08-22 13:05:26</div></a></div><div class="text"><p>What you could do is make it easy to build up <code>Page</code>s and expose ways to interpret them into some final form</p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/60df8c1a366ab1bf4378154e71a93367?d=identicon&amp;version=1"></a><div class="content"><a class="author">Saurabh Nanda</a><div class="metadata"><a href="#207723734" name="207723734"><div>2020-08-22 13:05:58</div></a></div><div class="text"><p>so being <em>total</em>, or not, doesn't really help.</p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/374affb4db58caa9507f265d7fdf03fe?d=identicon&amp;version=1"></a><div class="content"><a class="author">Fintan Halpenny</a><div class="metadata"><a href="#207723736" name="207723736"><div>2020-08-22 13:05:59</div></a></div><div class="text"><p>Not _quite_. You can _represent_ structure that's infinite.</p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/374affb4db58caa9507f265d7fdf03fe?d=identicon&amp;version=1"></a><div class="content"><a class="author">Fintan Halpenny</a><div class="metadata"><a href="#207723784" name="207723784"><div>2020-08-22 13:06:31</div></a></div><div class="text"><p>But whatever program that ingests the Dhall needs a way to interpret that infinite structure</p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/374affb4db58caa9507f265d7fdf03fe?d=identicon&amp;version=1"></a><div class="content"><a class="author">Fintan Halpenny</a><div class="metadata"><a href="#207723792" name="207723792"><div>2020-08-22 13:07:14</div></a></div><div class="text"><p>But from Dhall's point of view, this  all total and non-Turing complete</p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/60df8c1a366ab1bf4378154e71a93367?d=identicon&amp;version=1"></a><div class="content"><a class="author">Saurabh Nanda</a><div class="metadata"><a href="#207723797" name="207723797"><div>2020-08-22 13:07:41</div></a></div><div class="text"><p>is it possible to have a polymorphc type such as <code>data Page x = Page { title :: Text, children :: [x]}</code> and later substitute <code>x</code> for <code>Page</code>?</p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/374affb4db58caa9507f265d7fdf03fe?d=identicon&amp;version=1"></a><div class="content"><a class="author">Fintan Halpenny</a><div class="metadata"><a href="#207723852" name="207723852"><div>2020-08-22 13:09:00</div></a></div><div class="text"><p>That's exactly what the Dhall example is doing</p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/60df8c1a366ab1bf4378154e71a93367?d=identicon&amp;version=1"></a><div class="content"><a class="author">Saurabh Nanda</a><div class="metadata"><a href="#207723929" name="207723929"><div>2020-08-22 13:11:21</div></a></div><div class="text"><p>but it seems way too complicated. I'm trying a simple version -- probably if I write it from scratch myself, it might make more sense.</p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/60df8c1a366ab1bf4378154e71a93367?d=identicon&amp;version=1"></a><div class="content"><a class="author">Saurabh Nanda</a><div class="metadata"><a href="#207723931" name="207723931"><div>2020-08-22 13:11:32</div></a></div><div class="text"><p>what's the void / <code>()</code> type in Dhall?</p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/374affb4db58caa9507f265d7fdf03fe?d=identicon&amp;version=1"></a><div class="content"><a class="author">Fintan Halpenny</a><div class="metadata"><a href="#207723981" name="207723981"><div>2020-08-22 13:12:10</div></a></div><div class="text"><div class="codehilite"><pre><span></span><code>let Page
    : Type
    = ∀(_Page : Type) →
      ∀(MakePage : { children : List _Page, name : Text } → _Page) →
        _Page

let example
    : Page
    = λ(_Page : Type) →
      λ(MakePage : { children : List _Page, name : Text } → _Page) →
        MakePage
          { children =
            [ MakePage { children = [] : List _Page, name = &quot;google&quot; }
            , MakePege { children = [] : List _Page, name = &quot;amazon&quot; }
            ]
          , name = &quot;microsoft&quot;
          }

let everypage
    : Page → List Text
    = let concat = http://prelude.dhall-lang.org/List/concat

      in  λ(x : Page) →
            x
              (List Text)
              ( λ(p : { children : List (List Text), name : Text }) →
                  [ p.name ] # concat Text p.children
              )

let result
    : List Text
    = everypage example

in  result
</code></pre></div></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/374affb4db58caa9507f265d7fdf03fe?d=identicon&amp;version=1"></a><div class="content"><a class="author">Fintan Halpenny</a><div class="metadata"><a href="#207723999" name="207723999"><div>2020-08-22 13:13:01</div></a></div><div class="text"><p>You could make it simpler by having some function <code>makePage</code> which takes a title and a continuation of children</p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/374affb4db58caa9507f265d7fdf03fe?d=identicon&amp;version=1"></a><div class="content"><a class="author">Fintan Halpenny</a><div class="metadata"><a href="#207724008" name="207724008"><div>2020-08-22 13:13:27</div></a></div><div class="text"><p>It's the empty record <code>{}</code></p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/60df8c1a366ab1bf4378154e71a93367?d=identicon&amp;version=1"></a><div class="content"><a class="author">Saurabh Nanda</a><div class="metadata"><a href="#207724081" name="207724081"><div>2020-08-22 13:15:15</div></a></div><div class="text"><p>what's the newbie error in this?</p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/60df8c1a366ab1bf4378154e71a93367?d=identicon&amp;version=1"></a><div class="content"><a class="author">Saurabh Nanda</a><div class="metadata"><a href="#207724082" name="207724082"><div>2020-08-22 13:15:18</div></a></div><div class="text"><div class="codehilite"><pre><span></span><code>   let Site = forall (x : Type) -&gt; { root : Text, pages : List x }
in let s1 : Site Text = { root = &quot;/abc&quot;, pages = ([] : List Text) }
in s1
</code></pre></div></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/374affb4db58caa9507f265d7fdf03fe?d=identicon&amp;version=1"></a><div class="content"><a class="author">Fintan Halpenny</a><div class="metadata"><a href="#207724938" name="207724938"><div>2020-08-22 13:37:56</div></a></div><div class="text"><p>I'm not actually sure. It's been too long since I worked with Dhall</p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/374affb4db58caa9507f265d7fdf03fe?d=identicon&amp;version=1"></a><div class="content"><a class="author">Fintan Halpenny</a><div class="metadata"><a href="#207725061" name="207725061"><div>2020-08-22 13:40:08</div></a></div><div class="text"><p>Started off with somthing like this</p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/374affb4db58caa9507f265d7fdf03fe?d=identicon&amp;version=1"></a><div class="content"><a class="author">Fintan Halpenny</a><div class="metadata"><a href="#207725064" name="207725064"><div>2020-08-22 13:40:11</div></a></div><div class="text"><div class="codehilite"><pre><span></span><code>let Site = ∀(x : Type) → { root : Text, pages : List x }

let Root = λ(x : Type) → λ(root : Text) → { root = root, pages = [] : List x }

in  Root {} &quot;abc&quot;
</code></pre></div></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/374affb4db58caa9507f265d7fdf03fe?d=identicon&amp;version=1"></a><div class="content"><a class="author">Fintan Halpenny</a><div class="metadata"><a href="#207725524" name="207725524"><div>2020-08-22 13:53:34</div></a></div><div class="text"><p>Ok, I think I cracked it</p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/374affb4db58caa9507f265d7fdf03fe?d=identicon&amp;version=1"></a><div class="content"><a class="author">Fintan Halpenny</a><div class="metadata"><a href="#207725527" name="207725527"><div>2020-08-22 13:53:39</div></a></div><div class="text"><div class="codehilite"><pre><span></span><code>let Site = ∀(x : Type) → { root : Text, pages : List x }

let Page = λ(root : Text) → λ(x : Type) → { root = root, pages = [] : List x }

let addPage =
        λ(parent : Site)
      → λ(x : Type)
      → λ(root : Text)
      → { root =
            (parent x).root
        , pages =
            [ Page root ] # (parent Site).pages
        }

in  addPage (Page &quot;abc&quot;) {} &quot;def&quot;
</code></pre></div></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/374affb4db58caa9507f265d7fdf03fe?d=identicon&amp;version=1"></a><div class="content"><a class="author">Fintan Halpenny</a><div class="metadata"><a href="#207725534" name="207725534"><div>2020-08-22 13:53:58</div></a></div><div class="text"><p>That'll be $100 for Dhall consultancy fees <span aria-label="stuck out tongue closed eyes" class="emoji emoji-1f61d" role="img" title="stuck out tongue closed eyes">:stuck_out_tongue_closed_eyes:</span></p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/374affb4db58caa9507f265d7fdf03fe?d=identicon&amp;version=1"></a><div class="content"><a class="author">Fintan Halpenny</a><div class="metadata"><a href="#207725649" name="207725649"><div>2020-08-22 13:56:35</div></a></div><div class="text"><p>Actually, you want to delay the <code>x: Type</code> even more</p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/374affb4db58caa9507f265d7fdf03fe?d=identicon&amp;version=1"></a><div class="content"><a class="author">Fintan Halpenny</a><div class="metadata"><a href="#207725652" name="207725652"><div>2020-08-22 13:56:39</div></a></div><div class="text"><div class="codehilite"><pre><span></span><code>let Site = ∀(x : Type) → { root : Text, pages : List x }

let Page = λ(root : Text) → λ(x : Type) → { root = root, pages = [] : List x }

let addPage =
        λ(parent : Site)
      → λ(root : Text)
      → λ(x : Type)
      → { root =
            (parent x).root
        , pages =
            [ Page root ] # (parent Site).pages
        }

in  addPage (Page &quot;abc&quot;) &quot;def&quot;
</code></pre></div></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/374affb4db58caa9507f265d7fdf03fe?d=identicon&amp;version=1"></a><div class="content"><a class="author">Fintan Halpenny</a><div class="metadata"><a href="#207725662" name="207725662"><div>2020-08-22 13:57:12</div></a></div><div class="text"><p>So that way you can keep chaining without adding specifying the <code>x : Type</code></p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/374affb4db58caa9507f265d7fdf03fe?d=identicon&amp;version=1"></a><div class="content"><a class="author">Fintan Halpenny</a><div class="metadata"><a href="#207726089" name="207726089"><div>2020-08-22 14:09:17</div></a></div><div class="text"><p>I can't seem to get this working:</p>
<div class="codehilite"><pre><span></span><code>let Site = ∀(x : Type) → { root : Text, pages : List x }

let Page = λ(root : Text) → λ(x : Type) → { root = root, pages = [] : List x }

let addPage =
        λ(parent : Site)
      → λ(root : Text)
      → λ(x : Type)
      → { root = (parent x).root, pages = [ Page root ] # (parent Site).pages }

let addPages =
        λ(parent : Site)
      → λ(pages : List Site)
      → λ(x : Type)
      → { root = (parent x).root, pages = pages # (parent Site).pages }

in  addPages (addPage (Page &quot;abc&quot;) &quot;def&quot;) [ Page &quot;boo&quot;, Page &quot;foo&quot; ]
</code></pre></div></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/374affb4db58caa9507f265d7fdf03fe?d=identicon&amp;version=1"></a><div class="content"><a class="author">Fintan Halpenny</a><div class="metadata"><a href="#207726092" name="207726092"><div>2020-08-22 14:09:29</div></a></div><div class="text"><p>But maybe you play around with and get it going</p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/374affb4db58caa9507f265d7fdf03fe?d=identicon&amp;version=1"></a><div class="content"><a class="author">Fintan Halpenny</a><div class="metadata"><a href="#207726138" name="207726138"><div>2020-08-22 14:10:08</div></a></div><div class="text"><p>There's also Dhall folks in the fpchat slack that are smart and know this stuff well. Including sellout :)</p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/374affb4db58caa9507f265d7fdf03fe?d=identicon&amp;version=1"></a><div class="content"><a class="author">Fintan Halpenny</a><div class="metadata"><a href="#207732572" name="207732572"><div>2020-08-22 16:55:52</div></a></div><div class="text"><p>I tried playing around with it more and couldn't really make it usable</p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/374affb4db58caa9507f265d7fdf03fe?d=identicon&amp;version=1"></a><div class="content"><a class="author">Fintan Halpenny</a><div class="metadata"><a href="#207732625" name="207732625"><div>2020-08-22 16:56:55</div></a></div><div class="text"><p>dada is where it's at but I can't remember how to use it <span aria-label="joy" class="emoji emoji-1f602" role="img" title="joy">:joy:</span></p></div></div></div><div class="comment"><a class="avatar"><img src="https://zulip-avatars.s3.amazonaws.com/13896/67dba8dccee74946586f0fa81945a7ce22dc273b?x=x&amp;version=2"></a><div class="content"><a class="author">Mats Rauhala</a><div class="metadata"><a href="#207812303" name="207812303"><div>2020-08-24 06:56:58</div></a></div><div class="text"><p>Did you notice this section in the documentation: <a href="https://docs.dhall-lang.org/howtos/How-to-translate-recursive-code-to-Dhall.html#smart-constructors">https://docs.dhall-lang.org/howtos/How-to-translate-recursive-code-to-Dhall.html#smart-constructors</a></p>
<p>The smart constructors at least to me seem a lot more ergonomic</p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/374affb4db58caa9507f265d7fdf03fe?d=identicon&amp;version=1"></a><div class="content"><a class="author">Fintan Halpenny</a><div class="metadata"><a href="#207879550" name="207879550"><div>2020-08-24 18:34:48</div></a></div><div class="text"><p>Ah I missed that section. But I think I ended up trying that. The issue was making a person with children</p></div></div></div><div class="comment"><a class="avatar"><img src="https://secure.gravatar.com/avatar/374affb4db58caa9507f265d7fdf03fe?d=identicon&amp;version=1"></a><div class="content"><a class="author">Fintan Halpenny</a><div class="metadata"><a href="#207883640" name="207883640"><div>2020-08-24 19:07:24</div></a></div><div class="text"><p>I'll take a closer look again when I'm back at a keyboard</p></div></div></div></div></div><div class="ui vertical footer segment"><a href="https://github.com/srid/zulip-archive">Powered by Haskell</a></div></div></body></html>